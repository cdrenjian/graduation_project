var STK=(function(){var a={};var b=[];a.inc=function(d,c){return true};a.register=function(e,c){var g=e.split(".");var f=a;var d=null;while(d=g.shift()){if(g.length){if(f[d]===undefined){f[d]={}}f=f[d]}else{if(f[d]===undefined){try{f[d]=c(a)}catch(h){}}}}};a.regShort=function(c,d){if(a[c]!==undefined){throw"["+c+"] : short : has been register"}a[c]=d};a.IE=/msie/i.test(navigator.userAgent);a.E=function(c){if(typeof c==="string"){return document.getElementById(c)}else{return c}};a.C=function(c){var d;c=c.toUpperCase();if(c=="TEXT"){d=document.createTextNode("")}else{if(c=="BUFFER"){d=document.createDocumentFragment()}else{d=document.createElement(c)}}return d};a.log=function(c){b.push("["+(new Date()).toString()+"]: "+c)};a.getErrorLogInformationList=function(c){return b.splice(0,c||b.length)};return a})();$Import=STK.inc;STK.register("core.ani.algorithm",function(b){var a={linear:function(f,e,j,h,g){return j*f/h+e},easeincubic:function(f,e,j,h,g){return j*(f/=h)*f*f+e},easeoutcubic:function(f,e,j,h,g){if((f/=h/2)<1){return j/2*f*f*f+e}return j/2*((f-=2)*f*f+2)+e},easeinoutcubic:function(f,e,j,h,g){if(g==undefined){g=1.70158}return j*(f/=h)*f*((g+1)*f-g)+e},easeinback:function(f,e,j,h,g){if(g==undefined){g=1.70158}return j*((f=f/h-1)*f*((g+1)*f+g)+1)+e},easeoutback:function(f,e,j,h,g){if(g==undefined){g=1.70158}return j*((f=f/h-1)*f*((g+1)*f+g)+1)+e},easeinoutback:function(f,e,j,h,g){if(g==undefined){g=1.70158}if((f/=h/2)<1){return j/2*(f*f*(((g*=(1.525))+1)*f-g))+e}return j/2*((f-=2)*f*(((g*=(1.525))+1)*f+g)+2)+e}};return{addAlgorithm:function(c,d){if(a[c]){throw"[core.ani.tweenValue] this algorithm :"+c+"already exist"}a[c]=d},compute:function(h,e,d,f,g,c,j){if(typeof a[h]!=="function"){throw"[core.ani.tweenValue] this algorithm :"+h+"do not exist"}return a[h](f,e,d,g,c,j)}}});STK.register("core.obj.parseParam",function(a){return function(d,c,b){var e,f={};c=c||{};for(e in d){f[e]=d[e];if(c[e]!=null){if(b){if(d.hasOwnProperty[e]){f[e]=c[e]}}else{f[e]=c[e]}}}return f}});STK.register("core.arr.isArray",function(a){return function(b){return Object.prototype.toString.call(b)==="[object Array]"}});STK.register("core.func.timedChunk",function(b){var a={process:function(c){if(typeof c==="function"){c()}},context:{},callback:null,delay:25,execTime:50};return function(e,g){if(!b.core.arr.isArray(e)){throw"core.func.timedChunk need an array as first parameter"}var c=e.concat();var f=b.core.obj.parseParam(a,g);var h=null;var d=function(){var j=+new Date();do{f.process.call(f.context,c.shift())}while(c.length>0&&(+new Date()-j<f.execTime));if(c.length<=0){if(f.callback){f.callback(e)}}else{setTimeout(arguments.callee,f.delay)}};h=setTimeout(d,f.delay)}});STK.register("core.func.empty",function(){return function(){}});STK.register("core.ani.tweenArche",function(a){return function(n,o){var h,g,f,c,d,b,j,e;g={};h=a.core.obj.parseParam({animationType:"linear",distance:1,duration:500,callback:a.core.func.empty,algorithmParams:{},extra:5,delay:25},o);var m=function(){f=(+new Date()-c);if(f<h.duration){d=a.core.ani.algorithm.compute(h.animationType,0,h.distance,f,h.duration,h.extra,h.algorithmParams);n(d);b=setTimeout(m,h.delay)}else{e="stop";h.callback()}};e="stop";g.getStatus=function(){return e};g.play=function(){c=+new Date();d=null;m();e="play";return g};g.stop=function(){clearTimeout(b);e="stop";return g};g.resume=function(){if(j){c+=(+new Date()-j);m()}return g};g.pause=function(){clearTimeout(b);j=+new Date();e="pause";return g};g.destroy=function(){clearTimeout(b);j=0;e="stop"};return g}});STK.register("core.dom.getStyle",function(a){return function(c,f){if(a.IE){switch(f){case"opacity":var h=100;try{h=c.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(g){try{h=c.filters("alpha").opacity}catch(g){}}return h/100;case"float":f="styleFloat";default:var d=c.currentStyle?c.currentStyle[f]:null;return(c.style[f]||d)}}else{if(f=="float"){f="cssFloat"}try{var b=document.defaultView.getComputedStyle(c,"")}catch(g){}return c.style[f]||b?b[f]:null}}});STK.register("core.dom.cssText",function(a){return function(e){e=(e||"").replace(/(^[^\:]*?;)|(;[^\:]*?$)/g,"").split(";");var g={},c;for(var b=0;b<e.length;b++){c=e[b].split(":");g[c[0].toLowerCase()]=c[1]}var f=[],d={push:function(j,h){g[j.toLowerCase()]=h;return d},remove:function(h){h=h.toLowerCase();g[h]&&delete g[h];return d},getCss:function(){var j=[];for(var h in g){j.push(h+":"+g[h])}return j.join(";")}};return d}});STK.register("core.func.getType",function(a){return function(b){var c;return((c=typeof(b))=="object"?b==null&&"null"||Object.prototype.toString.call(b).slice(8,-1):c).toLowerCase()}});STK.register("core.arr.foreach",function(c){var a=function(j,f){var h=[];for(var g=0,e=j.length;g<e;g+=1){var d=f(j[g],g);if(d===false){break}else{if(d!==null){h[g]=d}}}return h};var b=function(h,e){var g={};for(var f in h){var d=e(h[f],f);if(d===false){break}else{if(d!==null){g[f]=d}}}return g};return function(e,d){if(c.core.arr.isArray(e)||(e.length&&e[0]!==undefined)){return a(e,d)}else{if(typeof e==="object"){return b(e,d)}}return null}});STK.register("core.json.merge",function(b){var a=function(d){if(d===undefined){return true}if(d===null){return true}if(b.core.arr.inArray(["number","string","function"],(typeof d))){return true}if(b.core.arr.isArray(d)){return true}if(b.core.dom.isNode(d)){return true}return false};var c=function(g,j,f){var h={};for(var e in g){if(j[e]===undefined){h[e]=g[e]}else{if(!a(g[e])&&!a(j[e])&&f){h[e]=arguments.callee(g[e],j[e])}else{h[e]=j[e]}}}for(var d in j){if(h[d]===undefined){h[d]=j[d]}}return h};return function(d,g,f){var e=b.core.obj.parseParam({isDeep:false},f);return c(d,g,e.isDeep)}});STK.register("core.util.color",function(f){var c=/^#([a-fA-F0-9]{3,8})$/;var e=/^rgb[a]?\s*\((\s*([0-9]{1,3})\s*,){2,3}(\s*([0-9]{1,3})\s*)\)$/;var d=/([0-9]{1,3})/ig;var a=/([a-fA-F0-9]{2})/ig;var b=f.core.arr.foreach;var g=function(m){var h=[];var j=[];if(c.test(m)){j=m.match(c);if(j[1].length<=4){h=b(j[1].split(""),function(o,n){return parseInt(o+o,16)})}else{if(j[1].length<=8){h=b(j[1].match(a),function(o,n){return parseInt(o,16)})}}return h}if(e.test(m)){j=m.match(d);h=b(j,function(o,n){return parseInt(o,10)});return h}return false};return function(m,h){var j=g(m);if(!j){return false}var n={};n.getR=function(){return j[0]};n.getG=function(){return j[1]};n.getB=function(){return j[2]};n.getA=function(){return j[3]};return n}});STK.register("core.ani.tween",function(d){var a=d.core.ani.tweenArche;var b=d.core.arr.foreach;var g=d.core.dom.getStyle;var h=d.core.func.getType;var n=d.core.obj.parseParam;var m=d.core.json.merge;var c=d.core.util.color;var f=function(r){var q=/(-?\d\.?\d*)([a-z%]*)/i.exec(r);var p=[0,"px"];if(q){if(q[1]){p[0]=q[1]-0}if(q[2]){p[1]=q[2]}}return p};var o=function(t){for(var r=0,p=t.length;r<p;r+=1){var q=t.charCodeAt(r);if(q>64&&q<90){var u=t.substr(0,r);var w=t.substr(r,1);var v=t.slice(r+1);return u+"-"+w.toLowerCase()+v}}return t};var j=function(u,w,r){var v=g(u,r);if(h(v)==="undefined"||v==="auto"){if(r==="height"){v=u.offsetHeight}if(r==="width"){v=u.offsetWidth}}var q={start:v,end:w,unit:"",key:r,defaultColor:false};if(h(w)==="number"){var s=[0,"px"];if(h(v)==="number"){s[0]=v}else{s=f(v)}q.start=s[0];q.unit=s[1]}if(h(w)==="string"){var p,t;p=c(w);if(p){t=c(v);if(!t){t=c("#fff")}q.start=t;q.end=p;q.defaultColor=true}}u=null;return q};var e={opacity:function(q,t,p,r){var s=(q*(p-t)+t);return{filter:"alpha(opacity="+s*100+")",opacity:Math.max(Math.min(1,s),0)}},defaultColor:function(t,x,q,w){var v=Math.max(0,Math.min(255,Math.ceil((t*(q.getR()-x.getR())+x.getR()))));var u=Math.max(0,Math.min(255,Math.ceil((t*(q.getG()-x.getG())+x.getG()))));var p=Math.max(0,Math.min(255,Math.ceil((t*(q.getB()-x.getB())+x.getB()))));var s={};s[o(key)]="#"+(v<16?"0":"")+v.toString(16)+(u<16?"0":"")+u.toString(16)+(p<16?"0":"")+p.toString(16);return s},"default":function(s,v,p,t,r){var u=(s*(p-v)+v);var q={};q[o(r)]=u+t;return q}};return function(r,A){var u,v,p,B,C,z,D,s,t,x;A=A||{};v=n({animationType:"linear",duration:500,algorithmParams:{},extra:5,delay:25},A);v.distance=1;v.callback=(function(){var E=A.end||d.core.func.empty;return function(){B(1);D();E(r)}})();p=m(e,A.propertys||{});z=null;C={};t=[];B=function(E){var G=[];var F=b(C,function(L,J){var K;if(p[J]){K=p[J]}else{if(L.defaultColor){K=p.defaultColor}else{K=p["default"]}}var I=K(E,L.start,L.end,L.unit,L.key);for(var H in I){z.push(H,I[H])}});r.style.cssText=z.getCss()};D=function(){var E;while(E=t.shift()){try{E.fn();if(E.type==="play"){break}if(E.type==="destroy"){break}}catch(F){}}};x=a(B,v);var w=function(){if(x.getStatus()!=="play"){r=el}else{t.push({fn:w,type:"setNode"})}};var q=function(E){if(x.getStatus()!=="play"){C=b(E,function(G,F){return j(r,G,F)});z=d.core.dom.cssText(r.style.cssText+(A.staticStyle||""));x.play()}else{t.push({fn:function(){q(E)},type:"play"})}};var y=function(){if(x.getStatus()!=="play"){x.destroy();r=null;u=null;v=null;p=null;B=null;C=null;z=null;D=null;s=null;t=null}else{t.push({fn:y,type:"destroy"})}};u={};u.play=function(E){q(E);return u};u.stop=function(){x.stop();return u};u.pause=function(){x.pause();return u};u.resume=function(){x.resume();return u};u.finish=function(E){q(E);y();return u};u.setNode=function(E){w();return u};u.destroy=function(){y();return u};return u}});STK.register("core.arr.findout",function(a){return function(f,e){if(!a.core.arr.isArray(f)){throw"the findout function needs an array as first parameter"}var c=[];for(var d=0,b=f.length;d<b;d+=1){if(f[d]===e){c.push(d)}}return c}});STK.register("core.arr.clear",function(a){return function(e){if(!a.core.arr.isArray(e)){throw"the clear function needs an array as first parameter"}var c=[];for(var d=0,b=e.length;d<b;d+=1){if(!(a.core.arr.findout([undefined,null,""],e[d]).length)){c.push(e[d])}}return c}});STK.register("core.arr.copy",function(a){return function(b){if(!a.core.arr.isArray(b)){throw"the copy function needs an array as first parameter"}return b.slice(0)}});STK.register("core.arr.hasby",function(a){return function(f,c){if(!a.core.arr.isArray(f)){throw"the hasBy function needs an array as first parameter"}var d=[];for(var e=0,b=f.length;e<b;e+=1){if(c(f[e],e)){d.push(e)}}return d}});STK.register("core.arr.indexOf",function(a){return function(d,e){if(e.indexOf){return e.indexOf(d)}for(var c=0,b=e.length;c<b;c++){if(e[c]===d){return c}}return -1}});STK.register("core.arr.inArray",function(a){return function(b,c){return a.core.arr.indexOf(b,c)>-1}});STK.register("core.arr.unique",function(a){return function(e){if(!a.core.arr.isArray(e)){throw"the unique function needs an array as first parameter"}var c=[];for(var d=0,b=e.length;d<b;d+=1){if(a.core.arr.indexOf(e[d],c)===-1){c.push(e[d])}}return c}});STK.register("core.dom.hasClassName",function(a){return function(c,b){return(new RegExp("\\b"+b+"\\b").test(c.className))}});STK.register("core.dom.addClassName",function(a){return function(c,b){if(c.nodeType===1){if(!a.core.dom.hasClassName(c,b)){c.className+=(" "+b)}}}});STK.register("core.dom.addHTML",function(a){return function(d,c){if(a.IE){d.insertAdjacentHTML("BeforeEnd",c)}else{var e=d.ownerDocument.createRange();e.setStartBefore(d);var b=e.createContextualFragment(c);d.appendChild(b)}}});STK.register("core.dom.sizzle",function(n){var t=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,m=0,d=Object.prototype.toString,s=false,j=true;[0,0].sort(function(){j=false;return 0});var b=function(z,e,C,D){C=C||[];e=e||document;var F=e;if(e.nodeType!==1&&e.nodeType!==9){return[]}if(!z||typeof z!=="string"){return C}var A=[],w,H,K,v,y=true,x=b.isXML(e),E=z,G,J,I,B;do{t.exec("");w=t.exec(E);if(w){E=w[3];A.push(w[1]);if(w[2]){v=w[3];break}}}while(w);if(A.length>1&&o.exec(z)){if(A.length===2&&f.relative[A[0]]){H=h(A[0]+A[1],e)}else{H=f.relative[A[0]]?[e]:b(A.shift(),e);while(A.length){z=A.shift();if(f.relative[z]){z+=A.shift()}H=h(z,H)}}}else{if(!D&&A.length>1&&e.nodeType===9&&!x&&f.match.ID.test(A[0])&&!f.match.ID.test(A[A.length-1])){G=b.find(A.shift(),e,x);e=G.expr?b.filter(G.expr,G.set)[0]:G.set[0]}if(e){G=D?{expr:A.pop(),set:a(D)}:b.find(A.pop(),A.length===1&&(A[0]==="~"||A[0]==="+")&&e.parentNode?e.parentNode:e,x);H=G.expr?b.filter(G.expr,G.set):G.set;if(A.length>0){K=a(H)}else{y=false}while(A.length){J=A.pop();I=J;if(!f.relative[J]){J=""}else{I=A.pop()}if(I==null){I=e}f.relative[J](K,I,x)}}else{K=A=[]}}if(!K){K=H}if(!K){b.error(J||z)}if(d.call(K)==="[object Array]"){if(!y){C.push.apply(C,K)}else{if(e&&e.nodeType===1){for(B=0;K[B]!=null;B++){if(K[B]&&(K[B]===true||K[B].nodeType===1&&b.contains(e,K[B]))){C.push(H[B])}}}else{for(B=0;K[B]!=null;B++){if(K[B]&&K[B].nodeType===1){C.push(H[B])}}}}}else{a(K,C)}if(v){b(v,F,C,D);b.uniqueSort(C)}return C};b.uniqueSort=function(v){if(c){s=j;v.sort(c);if(s){for(var e=1;e<v.length;e++){if(v[e]===v[e-1]){v.splice(e--,1)}}}}return v};b.matches=function(e,v){return b(e,null,null,v)};b.find=function(B,e,C){var A;if(!B){return[]}for(var x=0,w=f.order.length;x<w;x++){var z=f.order[x],y;if((y=f.leftMatch[z].exec(B))){var v=y[1];y.splice(1,1);if(v.substr(v.length-1)!=="\\"){y[1]=(y[1]||"").replace(/\\/g,"");A=f.find[z](y,e,C);if(A!=null){B=B.replace(f.match[z],"");break}}}}if(!A){A=e.getElementsByTagName("*")}return{set:A,expr:B}};b.filter=function(F,E,I,y){var w=F,K=[],C=E,A,e,B=E&&E[0]&&b.isXML(E[0]);while(F&&E.length){for(var D in f.filter){if((A=f.leftMatch[D].exec(F))!=null&&A[2]){var v=f.filter[D],J,H,x=A[1];e=false;A.splice(1,1);if(x.substr(x.length-1)==="\\"){continue}if(C===K){K=[]}if(f.preFilter[D]){A=f.preFilter[D](A,C,I,K,y,B);if(!A){e=J=true}else{if(A===true){continue}}}if(A){for(var z=0;(H=C[z])!=null;z++){if(H){J=v(H,A,z,C);var G=y^!!J;if(I&&J!=null){if(G){e=true}else{C[z]=false}}else{if(G){K.push(H);e=true}}}}}if(J!==undefined){if(!I){C=K}F=F.replace(f.match[D],"");if(!e){return[]}break}}}if(F===w){if(e==null){b.error(F)}else{break}}w=F}return C};b.error=function(e){throw"Syntax error, unrecognized expression: "+e};var f={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")}},relative:{"+":function(A,v){var x=typeof v==="string",z=x&&!/\W/.test(v),B=x&&!z;if(z){v=v.toLowerCase()}for(var w=0,e=A.length,y;w<e;w++){if((y=A[w])){while((y=y.previousSibling)&&y.nodeType!==1){}A[w]=B||y&&y.nodeName.toLowerCase()===v?y||false:y===v}}if(B){b.filter(v,A,true)}},">":function(A,v){var y=typeof v==="string",z,w=0,e=A.length;if(y&&!/\W/.test(v)){v=v.toLowerCase();for(;w<e;w++){z=A[w];if(z){var x=z.parentNode;A[w]=x.nodeName.toLowerCase()===v?x:false}}}else{for(;w<e;w++){z=A[w];if(z){A[w]=y?z.parentNode:z.parentNode===v}}if(y){b.filter(v,A,true)}}},"":function(x,v,z){var w=m++,e=u,y;if(typeof v==="string"&&!/\W/.test(v)){v=v.toLowerCase();y=v;e=r}e("parentNode",v,w,x,y,z)},"~":function(x,v,z){var w=m++,e=u,y;if(typeof v==="string"&&!/\W/.test(v)){v=v.toLowerCase();y=v;e=r}e("previousSibling",v,w,x,y,z)}},find:{ID:function(v,w,x){if(typeof w.getElementById!=="undefined"&&!x){var e=w.getElementById(v[1]);return e?[e]:[]}},NAME:function(w,z){if(typeof z.getElementsByName!=="undefined"){var v=[],y=z.getElementsByName(w[1]);for(var x=0,e=y.length;x<e;x++){if(y[x].getAttribute("name")===w[1]){v.push(y[x])}}return v.length===0?null:v}},TAG:function(e,v){return v.getElementsByTagName(e[1])}},preFilter:{CLASS:function(x,v,w,e,A,B){x=" "+x[1].replace(/\\/g,"")+" ";if(B){return x}for(var y=0,z;(z=v[y])!=null;y++){if(z){if(A^(z.className&&(" "+z.className+" ").replace(/[\t\n]/g," ").indexOf(x)>=0)){if(!w){e.push(z)}}else{if(w){v[y]=false}}}}return false},ID:function(e){return e[1].replace(/\\/g,"")},TAG:function(v,e){return v[1].toLowerCase()},CHILD:function(e){if(e[1]==="nth"){var v=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(e[2]==="even"&&"2n"||e[2]==="odd"&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=(v[1]+(v[2]||1))-0;e[3]=v[3]-0}e[0]=m++;return e},ATTR:function(y,v,w,e,z,A){var x=y[1].replace(/\\/g,"");if(!A&&f.attrMap[x]){y[1]=f.attrMap[x]}if(y[2]==="~="){y[4]=" "+y[4]+" "}return y},PSEUDO:function(y,v,w,e,z){if(y[1]==="not"){if((t.exec(y[3])||"").length>1||/^\w/.test(y[3])){y[3]=b(y[3],null,null,v)}else{var x=b.filter(y[3],v,w,true^z);if(!w){e.push.apply(e,x)}return false}}else{if(f.match.POS.test(y[0])||f.match.CHILD.test(y[0])){return true}}return y},POS:function(e){e.unshift(true);return e}},filters:{enabled:function(e){return e.disabled===false&&e.type!=="hidden"},disabled:function(e){return e.disabled===true},checked:function(e){return e.checked===true},selected:function(e){e.parentNode.selectedIndex;return e.selected===true},parent:function(e){return !!e.firstChild},empty:function(e){return !e.firstChild},has:function(w,v,e){return !!b(e[3],w).length},header:function(e){return(/h\d/i).test(e.nodeName)},text:function(e){return"text"===e.type},radio:function(e){return"radio"===e.type},checkbox:function(e){return"checkbox"===e.type},file:function(e){return"file"===e.type},password:function(e){return"password"===e.type},submit:function(e){return"submit"===e.type},image:function(e){return"image"===e.type},reset:function(e){return"reset"===e.type},button:function(e){return"button"===e.type||e.nodeName.toLowerCase()==="button"},input:function(e){return(/input|select|textarea|button/i).test(e.nodeName)}},setFilters:{first:function(v,e){return e===0},last:function(w,v,e,x){return v===x.length-1},even:function(v,e){return e%2===0},odd:function(v,e){return e%2===1},lt:function(w,v,e){return v<e[3]-0},gt:function(w,v,e){return v>e[3]-0},nth:function(w,v,e){return e[3]-0===v},eq:function(w,v,e){return e[3]-0===v}},filter:{PSEUDO:function(w,B,A,C){var e=B[1],v=f.filters[e];if(v){return v(w,A,B,C)}else{if(e==="contains"){return(w.textContent||w.innerText||b.getText([w])||"").indexOf(B[3])>=0}else{if(e==="not"){var x=B[3];for(var z=0,y=x.length;z<y;z++){if(x[z]===w){return false}}return true}else{b.error("Syntax error, unrecognized expression: "+e)}}}},CHILD:function(e,x){var A=x[1],v=e;switch(A){case"only":case"first":while((v=v.previousSibling)){if(v.nodeType===1){return false}}if(A==="first"){return true}v=e;case"last":while((v=v.nextSibling)){if(v.nodeType===1){return false}}return true;case"nth":var w=x[2],D=x[3];if(w===1&&D===0){return true}var z=x[0],C=e.parentNode;if(C&&(C.sizcache!==z||!e.nodeIndex)){var y=0;for(v=C.firstChild;v;v=v.nextSibling){if(v.nodeType===1){v.nodeIndex=++y}}C.sizcache=z}var B=e.nodeIndex-D;if(w===0){return B===0}else{return(B%w===0&&B/w>=0)}}},ID:function(v,e){return v.nodeType===1&&v.getAttribute("id")===e},TAG:function(v,e){return(e==="*"&&v.nodeType===1)||v.nodeName.toLowerCase()===e},CLASS:function(v,e){return(" "+(v.className||v.getAttribute("class"))+" ").indexOf(e)>-1},ATTR:function(z,x){var w=x[1],e=f.attrHandle[w]?f.attrHandle[w](z):z[w]!=null?z[w]:z.getAttribute(w),A=e+"",y=x[2],v=x[4];return e==null?y==="!=":y==="="?A===v:y==="*="?A.indexOf(v)>=0:y==="~="?(" "+A+" ").indexOf(v)>=0:!v?A&&e!==false:y==="!="?A!==v:y==="^="?A.indexOf(v)===0:y==="$="?A.substr(A.length-v.length)===v:y==="|="?A===v||A.substr(0,v.length+1)===v+"-":false},POS:function(y,v,w,z){var e=v[2],x=f.setFilters[e];if(x){return x(y,w,v,z)}}}};b.selectors=f;var o=f.match.POS,g=function(v,e){return"\\"+(e-0+1)};for(var q in f.match){f.match[q]=new RegExp(f.match[q].source+(/(?![^\[]*\])(?![^\(]*\))/.source));f.leftMatch[q]=new RegExp(/(^(?:.|\r|\n)*?)/.source+f.match[q].source.replace(/\\(\d+)/g,g))}var a=function(v,e){v=Array.prototype.slice.call(v,0);if(e){e.push.apply(e,v);return e}return v};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(p){a=function(y,x){var v=x||[],w=0;if(d.call(y)==="[object Array]"){Array.prototype.push.apply(v,y)}else{if(typeof y.length==="number"){for(var e=y.length;w<e;w++){v.push(y[w])}}else{for(;y[w];w++){v.push(y[w])}}}return v}}var c;if(document.documentElement.compareDocumentPosition){c=function(v,e){if(!v.compareDocumentPosition||!e.compareDocumentPosition){if(v==e){s=true}return v.compareDocumentPosition?-1:1}var w=v.compareDocumentPosition(e)&4?-1:v===e?0:1;if(w===0){s=true}return w}}else{if("sourceIndex" in document.documentElement){c=function(v,e){if(!v.sourceIndex||!e.sourceIndex){if(v==e){s=true}return v.sourceIndex?-1:1}var w=v.sourceIndex-e.sourceIndex;if(w===0){s=true}return w}}else{if(document.createRange){c=function(x,v){if(!x.ownerDocument||!v.ownerDocument){if(x==v){s=true}return x.ownerDocument?-1:1}var w=x.ownerDocument.createRange(),e=v.ownerDocument.createRange();w.setStart(x,0);w.setEnd(x,0);e.setStart(v,0);e.setEnd(v,0);var y=w.compareBoundaryPoints(Range.START_TO_END,e);if(y===0){s=true}return y}}}}b.getText=function(e){var v="",x;for(var w=0;e[w];w++){x=e[w];if(x.nodeType===3||x.nodeType===4){v+=x.nodeValue}else{if(x.nodeType!==8){v+=b.getText(x.childNodes)}}}return v};(function(){var v=document.createElement("div"),w="script"+(new Date()).getTime();v.innerHTML="<a name='"+w+"'/>";var e=document.documentElement;e.insertBefore(v,e.firstChild);if(document.getElementById(w)){f.find.ID=function(y,z,A){if(typeof z.getElementById!=="undefined"&&!A){var x=z.getElementById(y[1]);return x?x.id===y[1]||typeof x.getAttributeNode!=="undefined"&&x.getAttributeNode("id").nodeValue===y[1]?[x]:undefined:[]}};f.filter.ID=function(z,x){var y=typeof z.getAttributeNode!=="undefined"&&z.getAttributeNode("id");return z.nodeType===1&&y&&y.nodeValue===x}}e.removeChild(v);e=v=null})();(function(){var e=document.createElement("div");e.appendChild(document.createComment(""));if(e.getElementsByTagName("*").length>0){f.find.TAG=function(v,z){var y=z.getElementsByTagName(v[1]);if(v[1]==="*"){var x=[];for(var w=0;y[w];w++){if(y[w].nodeType===1){x.push(y[w])}}y=x}return y}}e.innerHTML="<a href='#'></a>";if(e.firstChild&&typeof e.firstChild.getAttribute!=="undefined"&&e.firstChild.getAttribute("href")!=="#"){f.attrHandle.href=function(v){return v.getAttribute("href",2)}}e=null})();if(document.querySelectorAll){(function(){var e=b,w=document.createElement("div");w.innerHTML="<p class='TEST'></p>";if(w.querySelectorAll&&w.querySelectorAll(".TEST").length===0){return}b=function(A,z,x,y){z=z||document;if(!y&&z.nodeType===9&&!b.isXML(z)){try{return a(z.querySelectorAll(A),x)}catch(B){}}return e(A,z,x,y)};for(var v in e){b[v]=e[v]}w=null})()}(function(){var e=document.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>";if(!e.getElementsByClassName||e.getElementsByClassName("e").length===0){return}e.lastChild.className="e";if(e.getElementsByClassName("e").length===1){return}f.order.splice(1,0,"CLASS");f.find.CLASS=function(v,w,x){if(typeof w.getElementsByClassName!=="undefined"&&!x){return w.getElementsByClassName(v[1])}};e=null})();function r(v,A,z,D,B,C){for(var x=0,w=D.length;x<w;x++){var e=D[x];if(e){e=e[v];var y=false;while(e){if(e.sizcache===z){y=D[e.sizset];break}if(e.nodeType===1&&!C){e.sizcache=z;e.sizset=x}if(e.nodeName.toLowerCase()===A){y=e;break}e=e[v]}D[x]=y}}}function u(v,A,z,D,B,C){for(var x=0,w=D.length;x<w;x++){var e=D[x];if(e){e=e[v];var y=false;while(e){if(e.sizcache===z){y=D[e.sizset];break}if(e.nodeType===1){if(!C){e.sizcache=z;e.sizset=x}if(typeof A!=="string"){if(e===A){y=true;break}}else{if(b.filter(A,[e]).length>0){y=e;break}}}e=e[v]}D[x]=y}}}b.contains=document.compareDocumentPosition?function(v,e){return !!(v.compareDocumentPosition(e)&16)}:function(v,e){return v!==e&&(v.contains?v.contains(e):true)};b.isXML=function(e){var v=(e?e.ownerDocument||e:0).documentElement;return v?v.nodeName!=="HTML":false};var h=function(e,B){var x=[],y="",z,w=B.nodeType?[B]:B;while((z=f.match.PSEUDO.exec(e))){y+=z[0];e=e.replace(f.match.PSEUDO,"")}e=f.relative[e]?e+"*":e;for(var A=0,v=w.length;A<v;A++){b(e,w[A],x)}return b.filter(y,x)};return b});STK.register("core.dom.builder",function(a){function b(m,f){if(f){return f}var e,h=/\<(\w+)[^>]*\s+node-type\s*=\s*([\'\"])?(\w+)\2.*?>/g;var g={};var j,d,c;while((e=h.exec(m))){d=e[1];j=e[3];c=d+"[node-type="+j+"]";g[j]=g[j]==null?[]:g[j];if(!a.core.arr.inArray(c,g[j])){g[j].push(d+"[node-type="+j+"]")}}return g}return function(m,e){var j=a.core.func.getType(m)=="string";var g=b(j?m:m.innerHTML,e);var d=m;if(j){d=a.C("div");d.innerHTML=m}var f,h={};for(f in g){h[f]=a.core.dom.sizzle(g[f].toString(),d)}var c=m;if(j){c=a.C("buffer");while(d.children[0]){c.appendChild(d.children[0])}}return{box:c,list:h}}});STK.register("core.obj.beget",function(b){var a=function(){};return function(c){a.prototype=c;return new a()}});STK.register("core.dom.setStyle",function(a){return function(b,c,d){if(a.IE){switch(c){case"opacity":b.style.filter="alpha(opacity="+(d*100)+")";if(!b.currentStyle||!b.currentStyle.hasLayout){b.style.zoom=1}break;case"float":c="styleFloat";default:b.style[c]=d}}else{if(c=="float"){c="cssFloat"}b.style[c]=d}}});STK.register("core.dom.insertAfter",function(a){return function(c,d){var b=d.parentNode;if(b.lastChild==d){b.appendChild(c)}else{b.insertBefore(c,d.nextSibling)}}});STK.register("core.dom.insertBefore",function(a){return function(c,d){var b=d.parentNode;b.insertBefore(c,d)}});STK.register("core.dom.removeClassName",function(a){return function(c,b){if(c.nodeType===1){if(a.core.dom.hasClassName(c,b)){c.className=c.className.replace(new RegExp("\\b"+b+"\\b")," ")}}}});STK.register("core.dom.trimNode",function(a){return function(c){var d=c.childNodes;for(var b=0;b<d.length;b++){if(d[b].nodeType==3||d[b].nodeType==8){c.removeChild(d[b])}}}});STK.register("core.dom.removeNode",function(a){return function(b){b=a.E(b)||b;try{b.parentNode.removeChild(b)}catch(c){}}});STK.register("core.evt.addEvent",function(a){return function(b,e,d){var c=a.E(b);if(c==null){return false}e=e||"click";if((typeof d).toLowerCase()!="function"){return}if(c.attachEvent){c.attachEvent("on"+e,d)}else{if(c.addEventListener){c.addEventListener(e,d,false)}else{c["on"+e]=d}}return true}});STK.register("core.evt.removeEvent",function(a){return function(c,e,d,b){var f=a.E(c);if(f==null){return false}if(typeof d!="function"){return false}if(f.removeEventListener){f.removeEventListener(e,d,b)}else{if(f.detachEvent){f.detachEvent("on"+e,d)}else{f["on"+e]=null}}return true}});STK.register("core.evt.fireEvent",function(a){return function(c,d){_el=a.E(c);if(a.IE){_el.fireEvent("on"+d)}else{var b=document.createEvent("HTMLEvents");b.initEvent(d,true,true);_el.dispatchEvent(b)}}});STK.register("core.util.scrollPos",function(a){return function(d){d=d||document;var b=d.documentElement;var c=d.body;return{top:Math.max(window.pageYOffset||0,b.scrollTop,c.scrollTop),left:Math.max(window.pageXOffset||0,b.scrollLeft,c.scrollLeft)}}});STK.register("core.util.browser",function(h){var a=navigator.userAgent.toLowerCase();var o=window.external||"";var c,d,f,p,g;var b=function(e){var m=0;return parseFloat(e.replace(/\./g,function(){return(m++==1)?"":"."}))};try{if((/windows|win32/i).test(a)){g="windows"}else{if((/macintosh/i).test(a)){g="macintosh"}else{if((/rhino/i).test(a)){g="rhino"}}}if((d=a.match(/applewebkit\/([^\s]*)/))&&d[1]){c="webkit";p=b(d[1])}else{if((d=a.match(/presto\/([\d.]*)/))&&d[1]){c="presto";p=b(d[1])}else{if(d=a.match(/msie\s([^;]*)/)){c="trident";p=1;if((d=a.match(/trident\/([\d.]*)/))&&d[1]){p=b(d[1])}}else{if(/gecko/.test(a)){c="gecko";p=1;if((d=a.match(/rv:([\d.]*)/))&&d[1]){p=b(d[1])}}}}}if(/world/.test(a)){f="world"}else{if(/360se/.test(a)){f="360"}else{if((/maxthon/.test(a))||typeof o.max_version=="number"){f="maxthon"}else{if(/tencenttraveler\s([\d.]*)/.test(a)){f="tt"}else{if(/se\s([\d.]*)/.test(a)){f="sogou"}}}}}}catch(n){}var j={OS:g,CORE:c,Version:p,EXTRA:(f?f:false),IE:/msie/.test(a),OPERA:/opera/.test(a),MOZ:/gecko/.test(a)&&!/(compatible|webkit)/.test(a),IE5:/msie 5 /.test(a),IE55:/msie 5.5/.test(a),IE6:/msie 6/.test(a),IE7:/msie 7/.test(a),IE8:/msie 8/.test(a),IE9:/msie 9/.test(a),SAFARI:!/chrome\/([\d.]*)/.test(a)&&/\/([\d.]*) safari/.test(a),CHROME:/chrome\/([\d.]*)/.test(a),IPAD:/\(ipad/i.test(a),IPHONE:/\(iphone/i.test(a),ITOUCH:/\(itouch/i.test(a),MOBILE:/mobile/i.test(a)};return j});STK.register("core.dom.position",function(c){var a=function(g){var h,f,e,d,m,j;h=g.getBoundingClientRect();f=c.core.util.scrollPos();e=g.ownerDocument.body;d=g.ownerDocument.documentElement;m=d.clientTop||e.clientTop||0;j=d.clientLeft||e.clientLeft||0;return{l:parseInt(h.left+f.left-j,10)||0,t:parseInt(h.top+f.top-m,10)||0}};var b=function(e,d){var f;f=[e.offsetLeft,e.offsetTop];parent=e.offsetParent;if(parent!==e&&parent!==d){while(parent){f[0]+=parent.offsetLeft;f[1]+=parent.offsetTop;parent=parent.offsetParent}}if(c.core.util.browser.OPERA!=-1||(c.core.util.browser.SAFARI!=-1&&e.style.position=="absolute")){f[0]-=document.body.offsetLeft;f[1]-=document.body.offsetTop}if(e.parentNode){parent=e.parentNode}else{parent=null}while(parent&&!/^body|html$/i.test(parent.tagName)&&parent!==d){if(parent.style.display.search(/^inline|table-row.*$/i)){f[0]-=parent.scrollLeft;f[1]-=parent.scrollTop}parent=parent.parentNode}return{l:parseInt(f[0],10),t:parseInt(f[1],10)}};return function(f,d){if(f==document.body){return false}if(f.parentNode==null){return false}if(f.style.display=="none"){return false}var e=c.core.obj.parseParam({parent:null},d);if(f.getBoundingClientRect){if(e.parent){var h=a(f);var g=a(e.parent);return{l:h.l-g.l,t:h.t-g.t}}else{return a(f)}}else{return b(f,e.parent||document.body)}}});STK.register("core.dom.setXY",function(a){return function(b,f){var c=a.core.dom.getStyle(b,"position");if(c=="static"){a.core.dom.setStyle(b,"position","relative");c="relative"}var e=a.core.dom.position(b);if(e==false){return}var d={l:parseInt(a.core.dom.getStyle(b,"left"),10),t:parseInt(a.core.dom.getStyle(b,"top"),10)};if(isNaN(d.l)){d.l=(c=="relative")?0:b.offsetLeft}if(isNaN(d.t)){d.t=(c=="relative")?0:b.offsetTop}if(f.l!=null){b.style.left=f.l-e.l+d.l+"px"}if(f.t!=null){b.style.top=f.t-e.t+d.t+"px"}}});STK.register("core.str.encodeHTML",function(a){return function(b){if(typeof b!=="string"){throw"encodeHTML need a string as parameter"}return b.replace(/\&/g,"&amp;").replace(/"/g,"&quot;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\'/g,"&#39").replace(/\u00A0/g,"&nbsp;").replace(/(\u0020|\u000B|\u2028|\u2029|\f)/g,"&#32")}});STK.register("core.str.decodeHTML",function(a){return function(b){if(typeof b!=="string"){throw"decodeHTML need a string as parameter"}return b.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39/g,"'").replace(/&nbsp;/g,"\u00A0").replace(/&#32/g,"\u0020").replace(/&amp;/g,"&")}});STK.register("core.dom.cascadeNode",function(a){return function(d){var c={};var e=d.style.display||"";e=(e==="none"?"":e);var b=[];c.setStyle=function(g,f){a.core.dom.setStyle(d,g,f);if(g==="display"){e=(f==="none"?"":f)}return c};c.insertAfter=function(f){a.core.dom.insertAfter(f,d);return c};c.insertBefore=function(f){a.core.dom.insertBefore(f,d);return c};c.addClassName=function(f){a.core.dom.addClassName(d,f);return c};c.removeClassName=function(f){a.core.dom.removeClassName(d,f);return c};c.trimNode=function(){a.core.dom.trimNode(d);return c};c.removeNode=function(){a.core.dom.removeNode(d);return c};c.on=function(h,j){for(var g=0,f=b.length;g<f;g+=1){if(b[g]["fn"]===j&&b[g]["type"]===h){return c}}b.push({fn:j,type:h});a.core.evt.addEvent(d,h,j);return c};c.unon=function(h,j){for(var g=0,f=b.length;g<f;g+=1){if(b[g]["fn"]===j&&b[g]["type"]===h){a.core.evt.removeEvent(d,j,h);b.splice(g,1);break}}return c};c.fire=function(f){a.core.evt.fireEvent(f,d);return c};c.appendChild=function(f){d.appendChild(f);return c};c.removeChild=function(f){d.removeChild(f);return c};c.toggle=function(){if(d.style.display==="none"){d.style.display=e}else{d.style.display="none"}return c};c.show=function(){if(d.style.display==="none"){if(e==="none"){d.style.display=""}else{d.style.display=e}}return c};c.hidd=function(){if(d.style.display!=="none"){d.style.display="none"}return c};c.hide=c.hidd;c.scrollTo=function(f,g){if(f==="left"){d.scrollLeft=g}if(f==="top"){d.scrollTop=g}return c};c.replaceChild=function(f,g){d.replaceChild(f,g);return c};c.position=function(f){if(f!==undefined){a.core.dom.setXY(d,f)}return a.core.dom.position(d)};c.setPosition=function(f){if(f!==undefined){a.core.dom.setXY(d,f)}return c};c.getPosition=function(f){return a.core.dom.position(d)};c.html=function(f){if(f!==undefined){d.innerHTML=f}return d.innerHTML};c.setHTML=function(f){if(f!==undefined){d.innerHTML=f}return c};c.getHTML=function(){return d.innerHTML};c.text=function(f){if(f!==undefined){d.innerHTML=a.core.str.encodeHTML(f)}return a.core.str.decodeHTML(d.innerHTML)};c.ttext=c.text;c.setText=function(f){if(f!==undefined){d.innerHTML=a.core.str.encodeHTML(f)}return c};c.getText=function(){return a.core.str.decodeHTML(d.innerHTML)};c.get=function(f){if(f==="node"){return d}return a.core.dom.getStyle(d,f)};c.getStyle=function(f){return a.core.dom.getStyle(d,f)};c.getOriginNode=function(){return d};c.destroy=function(){for(var g=0,f=b;g<f;g+=1){a.core.evt.removeEvent(d,b[g]["fn"],b[g]["type"])}e=null;b=null;d=null};return c}});STK.register("core.dom.contains",function(a){return function(b,c){if(b===c){return false}else{if(b.compareDocumentPosition){return((b.compareDocumentPosition(c)&16)===16)}else{if(b.contains&&c.nodeType===1){return b.contains(c)}else{while(c=c.parentNode){if(b===c){return true}}}}}return false}});STK.register("core.util.hideContainer",function(c){var d;var a=function(){if(d){return}d=c.C("div");d.style.cssText="position:absolute;top:-9999px;left:-9999px;";document.getElementsByTagName("head")[0].appendChild(d)};var b={appendChild:function(e){if(c.isNode(e)){a();d.appendChild(e)}},removeChild:function(e){if(c.isNode(e)){d&&d.removeChild(e)}}};return b});STK.register("core.dom.isNode",function(a){return function(b){return(b!=undefined)&&Boolean(b.nodeName)&&Boolean(b.nodeType)}});STK.register("core.dom.getSize",function(b){var a=function(d){if(!b.core.dom.isNode(d)){throw"core.dom.getSize need Element as first parameter"}return{width:d.offsetWidth,height:d.offsetHeight}};var c=function(e){var d=null;if(e.style.display==="none"){e.style.visibility="hidden";e.style.display="";d=a(e);e.style.display="none";e.style.visibility="visible"}else{d=a(e)}return d};return function(e){var d={};if(!e.parentNode){b.core.util.hideContainer.appendChild(e);d=c(e);b.core.util.hideContainer.removeChild(e)}else{d=c(e)}return d}});STK.register("core.dom.textSelectArea",function(a){return function(b){var e={start:0,len:0};if(typeof b.selectionStart==="number"){e.start=b.selectionStart;e.len=b.selectionEnd-b.selectionStart}else{if(typeof document.selection!==undefined){var d=document.selection.createRange();if(b.tagName==="INPUT"){var c=b.createTextRange()}else{if(b.tagName==="TEXTAREA"){var c=d.duplicate();c.moveToElementText(b)}}c.setEndPoint("EndToStart",d);e.start=c.text.length;e.len=d.text.length;d=null;c=null}}return e}});STK.register("core.dom.insertHTML",function(a){return function(e,d,c){e=a.E(e)||document.body;c=c?c.toLowerCase():"beforeend";if(e.insertAdjacentHTML){switch(c){case"beforebegin":e.insertAdjacentHTML("BeforeBegin",d);return e.previousSibling;case"afterbegin":e.insertAdjacentHTML("AfterBegin",d);return e.firstChild;case"beforeend":e.insertAdjacentHTML("BeforeEnd",d);return e.lastChild;case"afterend":e.insertAdjacentHTML("AfterEnd",d);return e.nextSibling}throw'Illegal insertion point -> "'+c+'"'}else{var b=e.ownerDocument.createRange();var f;switch(c){case"beforebegin":b.setStartBefore(e);f=b.createContextualFragment(d);e.parentNode.insertBefore(f,e);return e.previousSibling;case"afterbegin":if(e.firstChild){b.setStartBefore(e.firstChild);f=b.createContextualFragment(d);e.insertBefore(f,e.firstChild);return e.firstChild}else{e.innerHTML=d;return e.firstChild}break;case"beforeend":if(e.lastChild){b.setStartAfter(e.lastChild);f=b.createContextualFragment(d);e.appendChild(f);return e.lastChild}else{e.innerHTML=d;return e.lastChild}break;case"afterend":b.setStartAfter(e);f=b.createContextualFragment(d);e.parentNode.insertBefore(f,e.nextSibling);return e.nextSibling}throw'Illegal insertion point -> "'+c+'"'}}});STK.register("core.dom.insertElement",function(a){return function(d,c,b){d=a.E(d)||document.body;b=b?b.toLowerCase():"beforeend";switch(b){case"beforebegin":d.parentNode.insertBefore(c,d);break;case"afterbegin":d.insertBefore(c,d.firstChild);break;case"beforeend":d.appendChild(c);break;case"afterend":if(d.nextSibling){d.parentNode.insertBefore(c,d.nextSibling)}else{d.parentNode.appendChild(c)}break}}});STK.register("core.dom.next",function(a){return function(c){var b=c.nextSibling;if(!b){return null}else{if(b.nodeType!==1){b=arguments.callee(b)}}return b}});STK.register("core.dom.prev",function(a){return function(c){var b=c.previousSibling;if(!b){return null}else{if(b.nodeType!==1){b=arguments.callee(b)}}return b}});STK.register("core.dom.replaceNode",function(a){return function(c,b){if(c==null||b==null){throw"replaceNode need node as paramster"}b.parentNode.replaceChild(c,b)}});STK.register("core.dom.ready",function(g){var c=[];var o=false;var n=g.core.func.getType;var h=g.core.util.browser;var f=g.core.evt.addEvent;var j=function(){if(!o){if(document.readyState==="complete"){return true}}return o};var d=function(){if(o==true){return}o=true;for(var q=0,p=c.length;q<p;q++){if(n(c[q])==="function"){try{c[q].call()}catch(r){}}}c=[]};var a=function(){if(j()){d();return}try{document.documentElement.doScroll("left")}catch(p){setTimeout(arguments.callee,25);return}d()};var b=function(){if(j()){d();return}setTimeout(arguments.callee,25)};var e=function(){f(document,"DOMContentLoaded",d)};var m=function(){f(window,"load",d)};if(!j()){if(g.IE&&window===window.top){a()}e();b();m()}return function(p){if(j()){if(n(p)==="function"){p.call()}}else{c.push(p)}}});STK.register("core.dom.selector",function(a){var b=function(d,j,h,e){var g=[];if(typeof d==="string"){lis=a.core.dom.sizzle(d,j,h,e);for(var f=0,c=lis.length;f<c;f+=1){g[f]=lis[f]}}else{if(a.core.dom.isNode(d)){if(j){if(a.core.dom.contains(j,d)){g=[d]}}else{g=[d]}}else{if(a.core.arr.isArray(d)){if(j){for(var f=0,c=d.length;f<c;f+=1){if(a.core.dom.contains(j,d[f])){g.push(d[f])}}}else{g=d}}}}return g};return function(c,f,e,d){var g=b.apply(window,arguments);g.on=function(n,m){for(var j=0,h=g.length;j<h;j+=1){a.core.evt.addEvent(g[j],n,m)}return g};g.css=function(n,j){for(var m=0,h=g.length;m<h;m+=1){a.core.dom.setStyle(g[m],n,j)}return g};g.show=function(){for(var j=0,h=g.length;j<h;j+=1){g[j].style.display=""}return g};g.hidd=function(){for(var j=0,h=g.length;j<h;j+=1){g[j].style.display="none"}return g};g.hide=g.hidd;return g}});STK.register("core.dom.selectText",function(){return function(c,d){var e=d.start;var a=d.len||0;c.focus();if(c.setSelectionRange){c.setSelectionRange(e,e+a)}else{if(c.createTextRange){var b=c.createTextRange();b.collapse(1);b.moveStart("character",e);b.moveEnd("character",a);b.select()}}}});STK.register("core.dom.setStyles",function(a){return function(b,c,d){if(!a.core.arr.isArray(b)){var b=[b]}for(i=0,l=b.length;i<l;i++){a.core.dom.setStyle(b[i],c,d)}return b}});STK.register("core.util.getUniqueKey",function(c){var a=(new Date()).getTime().toString(),b=1;return function(){return a+(b++)}});STK.register("core.dom.uniqueID",function(a){return function(b){return b&&(b.uniqueID||(b.uniqueID=a.core.util.getUniqueKey()))}});STK.register("core.evt.custEvent",function(c){var a="__custEventKey__",d=1,e={},b=function(h,g){var f=(typeof h=="number")?h:h[a];return(f&&e[f])&&{obj:(typeof g=="string"?e[f][g]:e[f]),key:f}};return{define:function(m,h){if(m&&h){var g=(typeof m=="number")?m:m[a]||(m[a]=d++),j=e[g]||(e[g]={});h=[].concat(h);for(var f=0;f<h.length;f++){j[h[f]]||(j[h[f]]=[])}return g}},undefine:function(j,h){if(j){var g=(typeof j=="number")?j:j[a];if(g&&e[g]){if(h){h=[].concat(h);for(var f=0;f<h.length;f++){if(h[f] in e[g]){delete e[g][h[f]]}}}else{delete e[g]}}}},add:function(m,g,f,h){if(m&&typeof g=="string"&&f){var j=b(m,g);if(!j||!j.obj){throw"custEvent ("+g+") is undefined !"}j.obj.push({fn:f,data:h});return j.key}},once:function(m,g,f,h){if(m&&typeof g=="string"&&f){var j=b(m,g);if(!j||!j.obj){throw"custEvent ("+g+") is undefined !"}j.obj.push({fn:f,data:h,once:true});return j.key}},remove:function(n,j,h){if(n){var m=b(n,j),o,f;if(m&&(o=m.obj)){if(c.isArray(o)){if(h){var g=0;while(o[g]){if(o[g].fn===h){break}g++}o.splice(g,1)}else{o.splice(0,o.length)}}else{for(var g in o){o[g]=[]}}return m.key}}},fire:function(g,p,n){if(g&&typeof p=="string"){var f=b(g,p),m;if(f&&(m=f.obj)){if(!c.isArray(n)){n=n!=undefined?[n]:[]}for(var h=m.length-1;h>-1&&m[h];h--){var q=m[h].fn;var o=m[h].once;if(q&&q.apply){try{q.apply(g,[{type:p,data:m[h].data}].concat(n));if(o){m.splice(h,1)}}catch(j){c.log("custEvent fire",j)}}}return f.key}}},destroy:function(){e={};d=1}}});STK.register("core.evt.fixEvent",function(a){return function(b){b=b||a.core.evt.getEvent();if(!b.target){b.target=b.srcElement;b.pageX=b.x;b.pageY=b.y}if(typeof b.layerX=="undefined"){b.layerX=b.offsetX}if(typeof b.layerY=="undefined"){b.layerY=b.offsetY}return b}});STK.register("core.obj.isEmpty",function(a){return function(e,d){var c=true;for(var b in e){if(d){c=false;break}else{if(e.hasOwnProperty(b)){c=false;break}}}return c}});STK.register("core.evt.delegatedEvent",function(b){var a=function(f,e){for(var d=0,c=f.length;d<c;d+=1){if(b.core.dom.contains(f[d],e)){return true}}return false};return function(d,g){if(!b.core.dom.isNode(d)){throw"core.evt.delegatedEvent need an Element as first Parameter"}if(!g){g=[]}if(b.core.arr.isArray(g)){g=[g]}var c={};var f=function(p){var j=b.core.evt.fixEvent(p);var o=j.target;var n=p.type;var q=function(){var t,r,s;t=o.getAttribute("action-target");if(t){r=b.core.dom.sizzle(t,d);if(r.length){s=j.target=r[0]}}q=b.core.func.empty;return s};var h=function(){var r=q()||o;if(c[n]&&c[n][m]){return c[n][m]({evt:j,el:r,box:d,data:b.core.json.queryToJson(r.getAttribute("action-data")||"")})}else{return true}};if(a(g,o)){return false}else{if(!b.core.dom.contains(d,o)){return false}else{var m=null;while(o&&o!==d){m=o.getAttribute("action-type");if(m&&h()===false){break}o=o.parentNode}}}};var e={};e.add=function(m,n,j){if(!c[n]){c[n]={};b.core.evt.addEvent(d,n,f)}var h=c[n];h[m]=j};e.remove=function(h,j){if(c[j]){delete c[j][h];if(b.core.obj.isEmpty(c[j])){delete c[j];b.core.evt.removeEvent(d,j,f)}}};e.pushExcept=function(h){g.push(h)};e.removeExcept=function(m){if(!m){g=[]}else{for(var j=0,h=g.length;j<h;j+=1){if(g[j]===m){g.splice(j,1)}}}};e.clearExcept=function(h){g=[]};e.destroy=function(){for(k in c){for(l in c[k]){delete c[k][l]}delete c[k];b.core.evt.removeEvent(d,k,f)}};return e}});STK.register("core.evt.getEvent",function(a){return function(){if(a.IE){return window.event}else{if(window.event){return window.event}var c=arguments.callee.caller;var b;var d=0;while(c!=null&&d<40){b=c.arguments[0];if(b&&(b.constructor==Event||b.constructor==MouseEvent)){return b}d++;c=c.caller}return b}}});STK.register("core.evt.getActiveElement",function(a){return function(){try{var b=a.core.evt.getEvent();return document.activeElement?document.activeElement:b.explicitOriginalTarget}catch(c){return document.body}}});STK.register("core.evt.hitTest",function(a){function b(e){var d=STK.E(e);var f=a.core.dom.position(d);var c={left:f.l,top:f.t,right:f.l+d.offsetWidth,bottom:f.t+d.offsetHeight};return c}return function(h,d){var c=b(h);if(d==null){d=a.core.evt.getEvent()}else{if(d.nodeType==1){var g=b(d);if(c.right>g.left&&c.left<g.right&&c.bottom>g.top&&c.top<g.bottom){return true}return false}else{if(d.clientX==null){throw"core.evt.hitTest: ["+d+":oEvent] is not a valid value"}}}var j=a.core.util.scrollPos();var f=d.clientX+j.left;var e=d.clientY+j.top;return(f>=c.left&&f<=c.right)&&(e>=c.top&&e<=c.bottom)?true:false}});STK.register("core.evt.stopEvent",function(a){return function(c){var b=c?c:a.core.evt.getEvent();if(a.IE){b.cancelBubble=true;b.returnValue=false}else{b.preventDefault();b.stopPropagation()}return false}});STK.register("core.evt.preventDefault",function(a){return function(c){var b=c?c:a.core.evt.getEvent();if(a.IE){b.returnValue=false}else{b.preventDefault()}}});STK.register("core.str.trim",function(a){return function(e){if(typeof e!=="string"){throw"trim need a string as parameter"}var b=e.length;var d=0;var c=/(\u3000|\s|\t|\u00A0)/;while(d<b){if(!c.test(e.charAt(d))){break}d+=1}while(b>d){if(!c.test(e.charAt(b-1))){break}b-=1}return e.slice(d,b)}});STK.register("core.evt.hotKey",function(d){var c=d.core.dom.uniqueID;var b={reg1:/^keypress|keydown|keyup$/,keyMap:{27:"esc",9:"tab",32:"space",13:"enter",8:"backspace",145:"scrollclock",20:"capslock",144:"numlock",19:"pause",45:"insert",36:"home",46:"delete",35:"end",33:"pageup",34:"pagedown",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",191:"/",17:"ctrl",16:"shift",109:"-",107:"=",219:"[",221:"]",220:"\\",222:"'",187:"=",188:",",189:"-",190:".",191:"/",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",110:".",111:"/"},keyEvents:{}};b.preventDefault=function(){this.returnValue=false};b.handler=function(g){g=g||window.event;if(!g.target){g.target=g.srcElement||document}if(!g.which&&((g.charCode||g.charCode===0)?g.charCode:g.keyCode)){g.which=g.charCode||g.keyCode}if(!g.preventDefault){g.preventDefault=b.preventDefault}var p=c(this),f,j;if(p&&(f=b.keyEvents[p])&&(j=f[g.type])){var h;switch(g.type){case"keypress":if(g.ctrlKey||g.altKey){return}if(g.which==13){h=b.keyMap[13]}if(g.which==32){h=b.keyMap[32]}if(g.which>=33&&g.which<=126){h=String.fromCharCode(g.which)}break;case"keyup":case"keydown":if(b.keyMap[g.which]){h=b.keyMap[g.which]}if(!h){if((g.which>=48&&g.which<=57)){h=String.fromCharCode(g.which)}else{if((g.which>=65&&g.which<=90)){h=String.fromCharCode(g.which+32)}}}if(h&&g.type=="keydown"){f.linkedKey+=f.linkedKey?(">"+h):h;if(g.altKey){h="alt+"+h}if(g.shiftKey){h="shift+"+h}if(g.ctrlKey){h="ctrl+"+h}}break}var q=/^select|textarea|input$/.test(g.target.nodeName.toLowerCase());if(h){var m=[],n=false;if(f.linkedKey&&f.linkKeyStr){if(f.linkKeyStr.indexOf(" "+f.linkedKey)!=-1){if(f.linkKeyStr.indexOf(" "+f.linkedKey+" ")!=-1){m=m.concat(j[f.linkedKey]);f.linkedKey=""}n=true}else{f.linkedKey=""}}if(!n){m=m.concat(j[h])}for(var o=0;o<m.length;o++){if(m[o]&&(!m[o].disableInInput||!q)){m[o].fn.apply(this,[g,m[o].key])}}}}};var e=function(n,m,j,h){var f={};if(!d.core.dom.isNode(n)||d.core.func.getType(j)!=="function"){return f}if(typeof m!=="string"||!(m=m.replace(/\s*/g,""))){return f}if(!h){h={}}if(!h.disableInInput){h.disableInInput=false}if(!h.type){h.type="keypress"}h.type=h.type.replace(/\s*/g,"");if(!b.reg1.test(h.type)||(h.disableInInput&&/^select|textarea|input$/.test(n.nodeName.toLowerCase()))){return f}if(m.length>1||h.type!="keypress"){m=m.toLowerCase()}if(!/(^(\+|>)$)|(^([^\+>]+)$)/.test(m)){var g="";if(/((ctrl)|(shift)|(alt))\+(\+|([^\+]+))$/.test(m)){if(m.indexOf("ctrl+")!=-1){g+="ctr+"}if(m.indexOf("shift+")!=-1){g+="shift+"}if(m.indexOf("alt+")!=-1){g+="alt+"}g+=m.match(/\+(([^\+]+)|(\+))$/)[1]}else{if(!/(^>)|(>$)|>>/.test(m)&&m.length>2){f.linkFlag=true}else{return f}}h.type="keydown"}f.keys=m;f.fn=j;f.opt=h;return f};var a={add:function(g,p,n,f){if(d.core.arr.isArray(p)){for(var j=0;j<p.length;j++){a.add(g,p[j],n,f)}return}var o=e(g,p,n,f);if(!o.keys){return}p=o.keys;n=o.fn;f=o.opt;var q=o.linkFlag;var m=c(g);if(!b.keyEvents[m]){b.keyEvents[m]={linkKeyStr:"",linkedKey:""}}if(!b.keyEvents[m].handler){b.keyEvents[m].handler=function(){b.handler.apply(g,arguments)}}if(q&&b.keyEvents[m].linkKeyStr.indexOf(" "+p+" ")==-1){b.keyEvents[m].linkKeyStr+=" "+p+" "}var h=f.type;if(!b.keyEvents[m][h]){b.keyEvents[m][h]={};d.addEvent(g,h,b.keyEvents[m].handler)}if(!b.keyEvents[m][h][p]){b.keyEvents[m][h][p]=[]}b.keyEvents[m][h][p].push({fn:n,disableInInput:f.disableInInput,key:p})},remove:function(m,u,r,h){if(d.core.arr.isArray(u)){for(var p=0;p<u.length;p++){a.remove(m,u[p],r,h)}return}var t=e(m,u,r,h);if(!t.keys){return}u=t.keys;r=t.fn;h=t.opt;linkFlag=t.linkFlag;var q=c(m),f,g,j;var o=h.type;if(q&&(f=b.keyEvents[q])&&(g=f[o])&&f.handler&&(j=g[u])){for(var p=0;p<j.length;){if(j[p].fn===r){j.splice(p,1)}else{p++}}if(j.length<1){delete g[u]}var n=false;for(var s in g){n=true;break}if(!n){d.removeEvent(m,o,f.handler);delete f[o]}if(linkFlag&&f.linkKeyStr){f.linkKeyStr=f.linkKeyStr.replace(" "+u+" ","")}}}};return a});STK.register("core.func.bind",function(a){return function(d,b,c){c=a.core.arr.isArray(c)?c:[c];return function(){return b.apply(d,c)}}});STK.register("core.func.memorize",function(a){return function(b,d){if(typeof b!=="function"){throw"core.func.memorize need a function as first parameter"}d=d||{};var c={};if(d.timeout){setInterval(function(){c={}},d.timeout)}return function(){var e=Array.prototype.join.call(arguments,"_");if(!(e in c)){c[e]=b.apply((d.context||{}),arguments)}return c[e]}}});STK.register("core.func.methodBefore",function(a){return function(){var b=false;var d=[];var c={};c.add=function(g,f){var e=a.core.obj.parseParam({args:[],pointer:window,top:false},f);if(e.top==true){d.unshift([g,e.args,e.pointer])}else{d.push([g,e.args,e.pointer])}return !b};c.start=function(){var g,e,j,f,h;if(b==true){return}b=true;for(g=0,e=d.length;g<e;g++){j=d[g][0];f=d[g][1];h=d[g][2];j.apply(h,f)}};c.reset=function(){d=[];b=false};c.getList=function(){return d};return c}});STK.register("core.io.getXHR",function(a){return function(){var e=false;try{e=new XMLHttpRequest()}catch(d){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){e=false}}}return e}});STK.register("core.str.parseURL",function(a){return function(d){var c=/^(?:([A-Za-z]+):(\/{0,3}))?([0-9.\-A-Za-z]+\.[0-9A-Za-z]+)?(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/;var h=["url","scheme","slash","host","port","path","query","hash"];var f=c.exec(d);var g={};for(var e=0,b=h.length;e<b;e+=1){g[h[e]]=f[e]||""}return g}});STK.register("core.json.queryToJson",function(a){return function(d,h){var m=a.core.str.trim(d).split("&");var j={};var c=function(o){if(h){return decodeURIComponent(o)}else{return o}};for(var f=0,g=m.length;f<g;f++){if(m[f]){var e=m[f].split("=");var b=e[0];var n=e[1];if(e.length<2){n=b;b="$nullName"}if(!j[b]){j[b]=c(n)}else{if(a.core.arr.isArray(j[b])!=true){j[b]=[j[b]]}j[b].push(c(n))}}}return j}});STK.register("core.json.jsonToQuery",function(a){var b=function(d,c){d=d==null?"":d;d=a.core.str.trim(d.toString());if(c){return encodeURIComponent(d)}else{return d}};return function(g,e){var h=[];if(typeof g=="object"){for(var d in g){if(g[d] instanceof Array){for(var f=0,c=g[d].length;f<c;f++){h.push(d+"="+b(g[d][f],e))}}else{if(typeof g[d]!="function"){h.push(d+"="+b(g[d],e))}}}}if(h.length){return h.join("&")}else{return""}}});STK.register("core.util.URL",function(a){return function(f,c){var e=a.core.obj.parseParam({isEncodeQuery:false,isEncodeHash:false},c||{});var d={};var h=a.core.str.parseURL(f);var b=a.core.json.queryToJson(h.query);var g=a.core.json.queryToJson(h.hash);d.setParam=function(j,m){b[j]=m;return this};d.getParam=function(j){return b[j]};d.setParams=function(m){for(var j in m){d.setParam(j,m[j])}return this};d.setHash=function(j,m){g[j]=m;return this};d.getHash=function(j){return g[j]};d.valueOf=d.toString=function(){var j=[];var m=a.core.json.jsonToQuery(b,e.isEncodeQuery);var n=a.core.json.jsonToQuery(g,e.isEncodeQuery);if(h.scheme!=""){j.push(h.scheme+":");j.push(h.slash)}if(h.host!=""){j.push(h.host);if(h.port!=""){j.push(":");j.push(h.port)}}j.push("/");j.push(h.path);if(m!=""){j.push("?"+m)}if(n!=""){j.push("#"+n)}return j.join("")};return d}});STK.register("core.io.ajax",function($){return function(oOpts){var opts=$.core.obj.parseParam({url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:null,onTimeout:$.core.func.empty,uniqueID:null,onFail:$.core.func.empty,method:"get",asynchronous:true,header:{},isEncode:false,responseType:"json"},oOpts);if(opts.url==""){throw"ajax need url in parameters object"}var tm;var trans=$.core.io.getXHR();var cback=function(){if(trans.readyState==4){clearTimeout(tm);var data="";if(opts.responseType==="xml"){data=trans.responseXML}else{if(opts.responseType==="text"){data=trans.responseText}else{try{if(trans.responseText&&typeof trans.responseText==="string"){data=eval("("+trans.responseText+")")}else{data={}}}catch(exp){data=opts.url+"return error : data error"}}}if(trans.status==200){if(opts.onComplete!=null){opts.onComplete(data)}}else{if(trans.status==0){}else{if(opts.onFail!=null){opts.onFail(data,trans)}}}}else{if(opts.onTraning!=null){opts.onTraning(trans)}}};trans.onreadystatechange=cback;if(!opts.header["Content-Type"]){opts.header["Content-Type"]="application/x-www-form-urlencoded"}if(!opts.header["X-Requested-With"]){opts.header["X-Requested-With"]="XMLHttpRequest"}if(opts.method.toLocaleLowerCase()=="get"){var url=$.core.util.URL(opts.url,{isEncodeQuery:opts.isEncode});url.setParams(opts.args);url.setParam("__rnd",new Date().valueOf());trans.open(opts.method,url,opts.asynchronous);try{for(var k in opts.header){trans.setRequestHeader(k,opts.header[k])}}catch(exp){}trans.send("")}else{trans.open(opts.method,opts.url,opts.asynchronous);try{for(var k in opts.header){trans.setRequestHeader(k,opts.header[k])}}catch(exp){}trans.send($.core.json.jsonToQuery(opts.args,opts.isEncode))}if(opts.timeout){tm=setTimeout(function(){try{trans.abort()}catch(exp){}opts.onTimeout({},trans);opts.onFail(data,trans)},opts.timeout)}return trans}});STK.register("core.io.scriptLoader",function(b){var c={};var a={url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:b.core.func.empty,onTimeout:null,isEncode:false,uniqueID:null};return function(h){var f,d;var e=b.core.obj.parseParam(a,h);if(e.url==""){throw"scriptLoader: url is null"}var g=e.uniqueID||b.core.util.getUniqueKey();f=c[g];if(f!=null&&b.IE!=true){b.core.dom.removeNode(f);f=null}if(f==null){f=c[g]=b.C("script")}f.charset=e.charset;f.id="scriptRequest_script_"+g;f.type="text/javascript";if(e.onComplete!=null){if(b.IE){f.onreadystatechange=function(){if(f.readyState.toLowerCase()=="loaded"||f.readyState.toLowerCase()=="complete"){try{clearTimeout(d);document.getElementsByTagName("head")[0].removeChild(f)}catch(j){}e.onComplete()}}}else{f.onload=function(){try{clearTimeout(d);b.core.dom.removeNode(f)}catch(j){}e.onComplete()}}}f.src=STK.core.util.URL(e.url,{isEncodeQuery:e.isEncode}).setParams(e.args);document.getElementsByTagName("head")[0].appendChild(f);if(e.timeout>0&&e.onTimeout!=null){d=setTimeout(function(){try{document.getElementsByTagName("head")[0].removeChild(f)}catch(j){}e.onTimeout()},e.timeout)}return f}});STK.register("core.io.jsonp",function(a){return function(f){var d=a.core.obj.parseParam({url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:null,onTimeout:null,responseName:null,isEncode:false,varkey:"callback"},f);var g=-1;var e=d.responseName||("STK_"+a.core.util.getUniqueKey());d.args[d.varkey]=e;var b=d.onComplete;var c=d.onTimeout;window[e]=function(h){if(g!=2&&b!=null){g=1;b(h)}};d.onComplete=null;d.onTimeout=function(){if(g!=1&&c!=null){g=2;c()}};return a.core.io.scriptLoader(d)}});STK.register("core.io.getIframeTrans",function(b){var a='<iframe id="#{id}" name="#{id}" height="0" width="0" frameborder="no"></iframe>';return function(c){var f,d,e;d=b.parseParam({id:"STK_iframe_"+b.core.util.getUniqueKey()},c);e={};f=b.C("DIV");f.innerHTML=b.templet(a,d);b.core.util.hideContainer.appendChild(f);e.getId=function(){return d.id};e.destroy=function(){f.innerHTML="";try{f.getElementsByTagName("iframe")[0].src="about:blank"}catch(g){}b.core.util.hideContainer.removeChild(f);f=null};return e}});STK.register("core.io.require",function(d){var c="//js.t.sinajs.cn/STK/js/";var f=function(n,j){var m=j.split(".");var h=n;var g=null;while(g=m.shift()){h=h[g];if(h===undefined){return false}}return true};var a=[];var e=function(g){if(d.core.arr.indexOf(g,a)!==-1){return false}d.core.io.scriptLoader({url:g,callback:function(){d.core.arr.foreach(a,function(j,h){if(j===g){a.splice(h,1);return false}})}});return false};var b=function(m,o,q){var j=null;for(var n=0,g=m.length;n<g;n+=1){var p=m[n];if(typeof p==="string"){if(!f(d,p)){e(c+p.replace(/\./ig,"/")+".js")}}else{if(!f(window,p.NS)){e(p.url)}}}var h=function(){for(var s=0,r=m.length;s<r;s+=1){var t=m[s];if(typeof t==="string"){if(!f(d,t)){j=setTimeout(h,25);return false}}else{if(!f(window,t.NS)){j=setTimeout(h,25);return false}}}clearTimeout(j);o.apply({},[].concat(q))};j=setTimeout(h,25)};b.setBaseURL=function(g){if(typeof g!=="string"){throw"[STK.kit.extra.require.setBaseURL] need string as frist parameter"}c=g};return b});STK.register("core.io.ijax",function(a){return function(c){var d,f,h,j,e,b,g;d=a.core.obj.parseParam({url:"",form:null,args:{},uniqueID:null,timeout:30*1000,onComplete:a.core.func.empty,onTimeout:a.core.func.empty,onFail:a.core.func.empty,asynchronous:true,isEncode:true,abaurl:null,responseName:null,varkey:"callback",abakey:"callback"},c);g={};if(d.url==""){throw"ijax need url in parameters object"}if(!d.form){throw"ijax need form in parameters object"}f=a.core.io.getIframeTrans();h=d.responseName||("STK_ijax_"+a.core.util.getUniqueKey());b={};b[d.varkey]=h;if(d.abaurl){d.abaurl=a.core.util.URL(d.abaurl).setParams(b);b={};b[d.abakey]=d.abaurl}d.url=a.core.util.URL(d.url,{isEncodeQuery:d.isEncode}).setParams(b).setParams(d.args);e=function(){window[h]=null;f.destroy();f=null;clearTimeout(j)};j=setTimeout(function(){e();d.onTimeout();d.onFail()},d.timeout);window[h]=function(m,n){e();d.onComplete(m,n)};d.form.action=d.url;d.form.target=f.getId();d.form.submit();g.abort=e;return g}});STK.register("core.json.clone",function(a){function b(f){var d;if(f instanceof Array){d=[];var e=f.length;while(e--){d[e]=b(f[e])}return d}else{if(f instanceof Object){d={};for(var c in f){d[c]=b(f[c])}return d}else{return f}}}return b});STK.register("core.json.include",function(a){return function(e,f){for(var c in f){if(typeof f[c]==="object"){if(f[c] instanceof Array){if(e[c] instanceof Array){if(f[c].length===e[c].length){for(var d=0,b=f[c].length;d<b;d+=1){if(!arguments.callee(f[c][d],e[c][d])){return false}}}else{return false}}else{return false}}else{if(typeof e[c]==="object"){if(!arguments.callee(f[c],e[c])){return false}}else{return false}}}else{if(typeof f[c]==="number"||typeof f[c]==="string"){if(f[c]!==e[c]){return false}}else{if(f[c]!==undefined&&f[c]!==null){if(e[c]!==undefined&&e[c]!==null){if(!f[c].toString||!e[c].toString){throw"json1[k] or json2[k] do not have toString method"}if(f[c].toString()!==e[c].toString()){return false}}else{return false}}}}}return true}});STK.register("core.json.compare",function(a){return function(c,b){if(a.core.json.include(c,b)&&a.core.json.include(b,c)){return true}else{return false}}});STK.register("core.json.jsonToStr",function(d){function e(f){return f<10?"0"+f:f}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(f){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(f){return this.valueOf()}}var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,j,b,n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},m;function a(f){h.lastIndex=0;return h.test(f)?'"'+f.replace(h,function(o){var p=n[o];return typeof p==="string"?p:"\\u"+("0000"+o.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function g(u,r){var p,o,w,f,s=j,q,t=r[u];if(t&&typeof t==="object"&&typeof t.toJSON==="function"){t=t.toJSON(u)}if(typeof m==="function"){t=m.call(r,u,t)}switch(typeof t){case"string":return a(t);case"number":return isFinite(t)?String(t):"null";case"boolean":case"null":return String(t);case"object":if(!t){return"null"}j+=b;q=[];if(Object.prototype.toString.apply(t)==="[object Array]"){f=t.length;for(p=0;p<f;p+=1){q[p]=g(p,t)||"null"}w=q.length===0?"[]":j?"[\n"+j+q.join(",\n"+j)+"\n"+s+"]":"["+q.join(",")+"]";j=s;return w}if(m&&typeof m==="object"){f=m.length;for(p=0;p<f;p+=1){o=m[p];if(typeof o==="string"){w=g(o,t);if(w){q.push(a(o)+(j?": ":":")+w)}}}}else{for(o in t){if(Object.hasOwnProperty.call(t,o)){w=g(o,t);if(w){q.push(a(o)+(j?": ":":")+w)}}}}w=q.length===0?"{}":j?"{\n"+j+q.join(",\n"+j)+"\n"+s+"}":"{"+q.join(",")+"}";j=s;return w}}return function(q,o,p){var f;j="";b="";if(typeof p==="number"){for(f=0;f<p;f+=1){b+=" "}}else{if(typeof p==="string"){b=p}}m=o;if(o&&typeof o!=="function"&&(typeof o!=="object"||typeof o.length!=="number")){throw new Error("JSON.stringify")}return g("",{"":q})}});STK.register("core.json.strToJson",function(g){var d,b,a={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},q,o=function(r){throw {name:"SyntaxError",message:r,at:d,text:q}},h=function(r){if(r&&r!==b){o("Expected '"+r+"' instead of '"+b+"'")}b=q.charAt(d);d+=1;return b},f=function(){var s,r="";if(b==="-"){r="-";h("-")}while(b>="0"&&b<="9"){r+=b;h()}if(b==="."){r+=".";while(h()&&b>="0"&&b<="9"){r+=b}}if(b==="e"||b==="E"){r+=b;h();if(b==="-"||b==="+"){r+=b;h()}while(b>="0"&&b<="9"){r+=b;h()}}s=+r;if(isNaN(s)){o("Bad number")}else{return s}},j=function(){var u,t,s="",r;if(b==='"'){while(h()){if(b==='"'){h();return s}else{if(b==="\\"){h();if(b==="u"){r=0;for(t=0;t<4;t+=1){u=parseInt(h(),16);if(!isFinite(u)){break}r=r*16+u}s+=String.fromCharCode(r)}else{if(typeof a[b]==="string"){s+=a[b]}else{break}}}else{s+=b}}}}o("Bad string")},n=function(){while(b&&b<=" "){h()}},c=function(){switch(b){case"t":h("t");h("r");h("u");h("e");return true;case"f":h("f");h("a");h("l");h("s");h("e");return false;case"n":h("n");h("u");h("l");h("l");return null}o("Unexpected '"+b+"'")},p,m=function(){var r=[];if(b==="["){h("[");n();if(b==="]"){h("]");return r}while(b){r.push(p());n();if(b==="]"){h("]");return r}h(",");n()}}o("Bad array")},e=function(){var s,r={};if(b==="{"){h("{");n();if(b==="}"){h("}");return r}while(b){s=j();n();h(":");if(Object.hasOwnProperty.call(r,s)){o('Duplicate key "'+s+'"')}r[s]=p();n();if(b==="}"){h("}");return r}h(",");n()}}o("Bad object")};p=function(){n();switch(b){case"{":return e();case"[":return m();case'"':return j();case"-":return f();default:return b>="0"&&b<="9"?f():c()}};return function(u,s){var r;q=u;d=0;b=" ";r=p();n();if(b){o("Syntax error")}return typeof s==="function"?(function t(z,y){var x,w,A=z[y];if(A&&typeof A==="object"){for(x in A){if(Object.hasOwnProperty.call(A,x)){w=t(A,x);if(w!==undefined){A[x]=w}else{delete A[x]}}}}return s.call(z,y,A)}({"":r},"")):r}});STK.register("core.obj.cascade",function(a){return function(e,c){for(var d=0,b=c.length;d<b;d+=1){if(typeof e[c[d]]!=="function"){throw"cascade need function list as the second paramsters"}e[c[d]]=(function(f){return function(){f.apply(e,arguments);return e}})(e[c[d]])}}});STK.register("core.obj.clear",function(a){return function(b){var c,d={};for(c in b){if(b[c]!=null){d[c]=b[c]}}return d}});STK.register("core.obj.cut",function(a){return function(e,d){var c={};if(!a.core.arr.isArray(d)){throw"core.obj.cut need array as second parameter"}for(var b in e){if(!a.core.arr.inArray(d,b)){c[b]=e[b]}}return c}});STK.register("core.obj.sup",function(a){return function(f,c){var e={};for(var d=0,b=c.length;d<b;d+=1){if(typeof f[c[d]]!=="function"){throw"super need function list as the second paramsters"}e[c[d]]=(function(g){return function(){return g.apply(f,arguments)}})(f[c[d]])}return e}});STK.register("core.str.bLength",function(a){return function(c){if(!c){return 0}var b=c.match(/[^\x00-\xff]/g);return(c.length+(!b?0:b.length))}});STK.register("core.str.dbcToSbc",function(a){return function(b){return b.replace(/[\uff01-\uff5e]/g,function(c){return String.fromCharCode(c.charCodeAt(0)-65248)}).replace(/\u3000/g," ")}});STK.register("core.str.parseHTML",function(a){return function(f){var d=/[^<>]+|<(\/?)([A-Za-z0-9]+)([^<>]*)>/g;var b,e;var c=[];while((b=d.exec(f))){var g=[];for(e=0;e<b.length;e+=1){g.push(b[e])}c.push(g)}return c}});STK.register("core.str.leftB",function(a){return function(d,b){var c=d.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");d=d.slice(0,c.slice(0,b).replace(/\*\*/g," ").replace(/\*/g,"").length);if(a.core.str.bLength(d)>b&&b>0){d=d.slice(0,d.length-1)}return d}});STK.register("core.str.queryString",function(a){return function(e,f){var d=a.core.obj.parseParam({source:window.location.href.toString(),split:"&"},f);var b=new RegExp("(^|)"+e+"=([^\\"+d.split+"]*)(\\"+d.split+"|$)","gi").exec(d.source),c;if(c=b){return c[2]}return null}});STK.register("core.util.cookie",function(b){var a={set:function(g,m,j){var c=[];var h,f;var e=b.core.obj.parseParam({expire:null,path:"/",domain:null,secure:null,encode:true},j);if(e.encode==true){m=escape(m)}c.push(g+"="+m);if(e.path!=null){c.push("path="+e.path)}if(e.domain!=null){c.push("domain="+e.domain)}if(e.secure!=null){c.push(e.secure)}if(e.expire!=null){h=new Date();f=h.getTime()+e.expire*3600000;h.setTime(f);c.push("expires="+h.toGMTString())}document.cookie=c.join(";")},get:function(e){e=e.replace(/([\.\[\]\$])/g,"\\$1");var d=new RegExp(e+"=([^;]*)?;","i");var f=document.cookie+";";var c=f.match(d);if(c){return c[1]||""}else{return""}},remove:function(c,d){d=d||{};d.expire=-10;a.set(c,"",d)}};return a});STK.register("core.util.drag",function(c){var a=function(d){d.cancelBubble=true;return false};var b=function(e,d){e.clientX=d.clientX;e.clientY=d.clientY;e.pageX=d.clientX+c.core.util.scrollPos()["left"];e.pageY=d.clientY+c.core.util.scrollPos()["top"];return e};return function(e,p){if(!c.core.dom.isNode(e)){throw"core.util.drag need Element as first parameter"}var o=c.core.obj.parseParam({actRect:[],actObj:{}},p);var j={};var m=c.core.evt.custEvent.define(o.actObj,"dragStart");var f=c.core.evt.custEvent.define(o.actObj,"dragEnd");var g=c.core.evt.custEvent.define(o.actObj,"draging");var n=function(r){var q=b({},r);document.body.onselectstart=function(){return false};c.core.evt.addEvent(document,"mousemove",h);c.core.evt.addEvent(document,"mouseup",d);c.core.evt.addEvent(document,"click",a,true);if(!c.IE){r.preventDefault();r.stopPropagation()}c.core.evt.custEvent.fire(m,"dragStart",q);return false};var h=function(r){var q=b({},r);r.cancelBubble=true;c.core.evt.custEvent.fire(m,"draging",q)};var d=function(r){var q=b({},r);document.body.onselectstart=function(){return true};c.core.evt.removeEvent(document,"mousemove",h);c.core.evt.removeEvent(document,"mouseup",d);c.core.evt.removeEvent(document,"click",a,true);c.core.evt.custEvent.fire(m,"dragEnd",q)};c.core.evt.addEvent(e,"mousedown",n);j.destroy=function(){c.core.evt.removeEvent(e,"mousedown",n);o=null};j.getActObj=function(){return o.actObj};return j}});STK.register("core.util.nameValue",function(a){return function(b){var j=b.getAttribute("name");var e=b.getAttribute("type");var h=b.tagName;var m={name:j,value:""};var f=function(n){if(n===false){m=false}else{if(!m.value){m.value=a.core.str.trim((n||""))}else{m.value=[a.core.str.trim((n||""))].concat(m.value)}}};if(!b.disabled&&j){switch(h){case"INPUT":if(e=="radio"||e=="checkbox"){if(b.checked){f(b.value)}else{f(false)}}else{if(e=="reset"||e=="submit"||e=="image"){f(false)}else{f(b.value)}}break;case"SELECT":if(b.multiple){var c=b.options;for(var d=0,g=c.length;d<g;d++){if(c[d].selected){f(c[d].value)}}}else{f(b.value)}break;case"TEXTAREA":f(b.value||b.getAttribute("value")||false);break;case"BUTTON":default:f(b.value||b.getAttribute("value")||b.innerHTML||false)}}else{return false}return m}});STK.register("core.util.htmlToJson",function(a){return function(h,c,e){var o={};c=c||["INPUT","TEXTAREA","BUTTON","SELECT"];if(!h||!c){return false}var b=a.core.util.nameValue;for(var f=0,g=c.length;f<g;f++){var n=h.getElementsByTagName(c[f]);for(var d=0,m=n.length;d<m;d++){var p=b(n[d]);if(!p||(e&&(p.value===""))){continue}if(o[p.name]){if(o[p.name] instanceof Array){o[p.name]=o[p.name].concat(p.value)}else{o[p.name]=[o[p.name]].concat(p.value)}}else{o[p.name]=p.value}}}return o}});STK.register("core.util.jobsM",function(a){return(function(){var e=[];var f={};var d=false;var g={};var b=function(m){var o=m.name;var h=m.func;var j=+new Date();if(!f[o]){try{h(a);h[o]=true}catch(n){a.log("jobs ["+o+"] execute Error!")}}};var c=function(h){if(h.length){a.core.func.timedChunk(h,{process:b,callback:arguments.callee});h.splice(0,h.length)}else{d=false}};g.register=function(h,j){e.push({name:h,func:j})};g.start=function(){if(d){return true}else{d=true}c(e)};g.load=function(){};a.core.dom.ready(g.start);return g})()});STK.register("core.util.language",function(a){return function(b,c){return b.replace(/#L\{((.*?)(?:[^\\]))\}/ig,function(){var e=arguments[1];var d;if(c&&c[e]!==undefined){d=c[e]}else{d=e}return d})}});STK.register("core.util.listener",function(a){return(function(){var e={};var b;var f=[];var d;function g(){if(f.length==0){return}clearTimeout(d);var h=f.splice(0,1)[0];try{h.func.apply(h.func,[].concat(h.data))}catch(j){a.log("listener: One of "+h+"-"+h+" function execute error.")}d=setTimeout(g,25)}var c={conn:function(){var h=window;while(h!=top){h=h.parent;if(h.STK&&h.STK["core"]&&h.STK["core"]["util"]&&h.STK["core"]["util"]["listener"]!=null){b=h}}},register:function(h,m,j){if(b!=null){b.STK["core"]["util"]["listener"].register(h,m,j)}else{e[h]=e[h]||{};e[h][m]=e[h][m]||[];e[h][m].push(j)}},fire:function(m,o,p){if(b!=null){b.listener.fire(m,o,p)}else{var n;var j,h;if(e[m]&&e[m][o]&&e[m][o].length>0){n=e[m][o];n.data_cache=p;for(j=0,h=n.length;j<h;j++){f.push({channel:m,evt:o,func:n[j],data:p})}g()}}},remove:function(m,o,n){if(b!=null){b.STK["core"]["util"]["listener"].remove(m,o,n)}else{if(e[m]){if(e[m][o]){for(var j=0,h=e[m][o].length;j<h;j++){if(e[m][o][j]===n){e[m][o].splice(j,1);break}}}}}},list:function(){return e},cache:function(h,j){if(b!=null){return b.listener.cache(h,j)}else{if(e[h]&&e[h][j]){return e[h][j].data_cache}}}};return c})()});STK.register("core.util.winSize",function(a){return function(c){var b,d;if(c){target=c.document}else{target=document}if(target.compatMode==="CSS1Compat"){b=target.documentElement.clientWidth;d=target.documentElement.clientHeight}else{if(self.innerHeight){if(c){target=c.self}else{target=self}b=target.innerWidth;d=target.innerHeight}else{if(target.documentElement&&target.documentElement.clientHeight){b=target.documentElement.clientWidth;d=target.documentElement.clientHeight}else{if(target.body){b=target.body.clientWidth;d=target.body.clientHeight}}}}return{width:b,height:d}}});STK.register("core.util.pageSize",function(a){return function(d){if(d){target=d.document}else{target=document}var f=(target.compatMode=="CSS1Compat"?target.documentElement:target.body);var e,c;if(window.innerHeight&&window.scrollMaxY){e=f.scrollWidth;c=window.innerHeight+window.scrollMaxY}else{if(f.scrollHeight>f.offsetHeight){e=f.scrollWidth;c=f.scrollHeight}else{e=f.offsetWidth;c=f.offsetHeight}}var b=a.core.util.winSize(d);if(c<b.height){pageHeight=b.height}else{pageHeight=c}if(e<b.width){pageWidth=b.width}else{pageWidth=e}return{page:{width:pageWidth,height:pageHeight},win:{width:b.width,height:b.height}}}});STK.register("core.util.queue",function(a){return function(){var b={};var c=[];b.add=function(d){c.push(d);return b};b.get=function(){if(c.length>0){return c.shift()}else{return false}};return b}});STK.register("core.util.timer",function(a){return(function(){var g={};var h={};var b=0;var e=null;var f=false;var d=25;var c=function(){for(var j in h){if(!h[j]["pause"]){h[j]["fun"]()}}return g};g.add=function(j){if(typeof j!="function"){throw ("The timer needs add a function as a parameters")}var m=""+(new Date()).getTime()+(Math.random())*Math.pow(10,17);h[m]={fun:j,pause:false};if(b<=0){g.start()}b++;return m};g.remove=function(j){if(h[j]){delete h[j];b--}if(b<=0){g.stop()}return g};g.pause=function(j){if(h[j]){h[j]["pause"]=true}return g};g.play=function(j){if(h[j]){h[j]["pause"]=false}return g};g.stop=function(){clearInterval(e);e=null;return g};g.start=function(){e=setInterval(c,d);return g};g.loop=c;g.get=function(j){if(j==="delay"){return d}if(j==="functionList"){return h}};g.set=function(j,m){if(j==="delay"){if(typeof m==="number"){d=Math.max(25,Math.min(m,200))}}};return g})()});STK.register("core.util.scrollTo",function(a){return function(c,m){if(!a.core.dom.isNode(c)){throw"core.dom.isNode need element as the first parameter"}var d=a.core.obj.parseParam({box:document.documentElement,top:0,step:2,onMoveStop:null},m);d.step=Math.max(2,Math.min(10,d.step));var b=[];var j=a.core.dom.position(c);var h;if(d.box==document.documentElement){h={t:0}}else{h=a.core.dom.position(d.box)}var e=Math.max(0,(j?j.t:0)-(h?h.t:0)-d.top);var f=d.box===document.documentElement?(d.box.scrollTop||document.body.scrollTop||window.pageYOffset):d.box.scrollTop;while(Math.abs(f-e)>d.step&&f!==0){b.push(Math.round(f+(e-f)*d.step/10));f=b[b.length-1]}if(!b.length){b.push(e)}var g=a.core.util.timer.add(function(){if(b.length){if(d.box===document.documentElement){window.scrollTo(0,b.shift())}else{d.box.scrollTop=b.shift()}}else{if(d.box===document.documentElement){window.scrollTo(0,e)}else{d.box.scrollTop=e}a.core.util.timer.remove(g);if(typeof d.onMoveStop==="function"){d.onMoveStop()}}})}});STK.register("core.util.stack",function(a){return function(){var c={};var b=[];c.add=function(d){b.push(d);return c};c.get=function(){if(b.length>0){return b.pop()}else{return false}};return c}});STK.register("core.util.swf",function(c){function a(j,m){var e=c.core.obj.parseParam({id:"swf_"+parseInt(Math.random()*10000,10),width:1,height:1,attrs:{},paras:{},flashvars:{},html:""},m);if(j==null){throw"swf: [sURL] ";return}var h;var g=[];var f=[];for(h in e.attrs){f.push(h+'="'+e.attrs[h]+'" ')}var d=[];for(h in e.flashvars){d.push(h+"="+e.flashvars[h])}e.paras.flashvars=d.join("&");if(c.IE){g.push('<object width="'+e.width+'" height="'+e.height+'" id="'+e.id+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ');g.push(f.join(""));g.push('><param name="movie" value="'+j+'" />');for(h in e.paras){g.push('<param name="'+h+'" value="'+e.paras[h]+'" />')}g.push("</object>")}else{g.push('<embed width="'+e.width+'" height="'+e.height+'" id="'+e.id+'" src="'+j+'" type="application/x-shockwave-flash" ');g.push(f.join(""));for(h in e.paras){g.push(h+'="'+e.paras[h]+'" ')}g.push(" />")}e.html=g.join("");return e}var b={};b.create=function(e,g,h){var f=c.E(e);if(f==null){throw"swf: ["+e+"] ";return}var d=a(g,h);f.innerHTML=d.html;return c.E(d.id)};b.html=function(e,f){var d=a(e,f);return d.html};b.check=function(){var e;if(STK.IE){var d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");e=d.GetVariable("$version")}else{e=navigator.plugins["Shockwave Flash"]["description"]}return e};return b});STK.register("core.util.templet",function(a){return function(b,c){return b.replace(/#\{(.+?)\}/ig,function(){var g=arguments[1].replace(/\s/ig,"");var e=arguments[0];var h=g.split("||");for(var f=0,d=h.length;f<d;f+=1){if(/^default:.*$/.test(h[f])){e=h[f].replace(/^default:/,"");break}else{if(c[h[f]]!==undefined){e=c[h[f]];break}}}return e})}});STK.register("core.util.easyTemplate",function(b){var a=function(e,g){if(!e){return""}if(e!==a.template){a.template=e;a.aStatement=a.parsing(a.separate(e))}var c=a.aStatement;var f=function(d){if(d){g=d}return arguments.callee};f.toString=function(){return(new Function(c[0],c[1]))(g)};return f};a.separate=function(c){var e=/\\'/g;var d=c.replace(/(<(\/?)#(.*?(?:\(.*?\))*)>)|(')|([\r\n\t])|(\$\{([^\}]*?)\})/g,function(m,j,s,r,q,p,o,n){if(j){return"{|}"+(s?"-":"+")+r+"{|}"}if(q){return"\\'"}if(p){return""}if(o){return"'+("+n.replace(e,"'")+")+'"}});return d};a.parsing=function(o){var n,e,h,d,g,f,j,m=["var aRet = [];"];j=o.split(/\{\|\}/);var c=/\s/;while(j.length){h=j.shift();if(!h){continue}g=h.charAt(0);if(g!=="+"&&g!=="-"){h="'"+h+"'";m.push("aRet.push("+h+");");continue}d=h.split(c);switch(d[0]){case"+et":n=d[1];e=d[2];m.push('aRet.push("<!--'+n+' start-->");');break;case"-et":m.push('aRet.push("<!--'+n+' end-->");');break;case"+if":d.splice(0,1);m.push("if"+d.join(" ")+"{");break;case"+elseif":d.splice(0,1);m.push("}else if"+d.join(" ")+"{");break;case"-if":m.push("}");break;case"+else":m.push("}else{");break;case"+list":m.push("if("+d[1]+".constructor === Array){with({i:0,l:"+d[1]+".length,"+d[3]+"_index:0,"+d[3]+":null}){for(i=l;i--;){"+d[3]+"_index=(l-i-1);"+d[3]+"="+d[1]+"["+d[3]+"_index];");break;case"-list":m.push("}}}");break;default:break}}m.push('return aRet.join("");');return[e,m.join("")]};return a});STK.register("core.util.storage",function(b){var a=window.localStorage;if(a){return{get:function(d){return unescape(a.getItem(d))},set:function(d,e,f){a.setItem(d,escape(e))},del:function(d){a.removeItem(d)},clear:function(){a.clear()},getAll:function(){var d=a.length,f=null,g=[];for(var e=0;e<d;e++){f=a.key(e),g.push(f+"="+this.getKey(f))}return g.join("; ")}}}else{if(window.ActiveXObject){store=document.documentElement;STORE_NAME="localstorage";try{store.addBehavior("#default#userdata");store.save("localstorage")}catch(c){}return{set:function(d,e){store.setAttribute(d,e);store.save(STORE_NAME)},get:function(d){store.load(STORE_NAME);return store.getAttribute(d)},del:function(d){store.removeAttribute(d);store.save(STORE_NAME)}}}else{return{get:function(h){var f=document.cookie.split("; "),e=f.length,d=[];for(var g=0;g<e;g++){d=f[g].split("=");if(h===d[0]){return unescape(d[1])}}return null},set:function(d,e,f){if(!(f&&typeof f===date)){f=new Date(),f.setDate(f.getDate()+1)}document.cookie=d+"="+escape(e)+"; expires="+f.toGMTString()},del:function(d){document.cookie=d+"=''; expires=Fri, 31 Dec 1999 23:59:59 GMT;"},clear:function(){var f=document.cookie.split("; "),e=f.length,d=[];for(var g=0;g<e;g++){d=f[g].split("=");this.deleteKey(d[0])}},getAll:function(){return unescape(document.cookie.toString())}}}}});STK.register("core.util.pageletM",function(f){var e="https://js.t.sinajs.cn/t4/";var d="https://img.t.sinajs.cn/t4/";if(typeof $CONFIG!="undefined"){e=$CONFIG.jsPath||e;d=$CONFIG.cssPath||d}var o={},g,s={},a={};var q=function(v,t){var u=o[v]||(o[v]={loaded:false,list:[]});if(u.loaded){t(v);return false}u.list.push(t);if(u.list.length>1){return false}return true};var j=function(u){var t=o[u].list;for(var v=0;v<t.length;v++){t[v](u)}o[u].loaded=true;delete o[u].list};var m=function(x,t,v){if(!q(x,v)){return}var u=d+x;var y=f.C("link");y.setAttribute("rel","Stylesheet");y.setAttribute("type","text/css");y.setAttribute("charset","utf-8");y.setAttribute("href",u);document.getElementsByTagName("head")[0].appendChild(y);var z=f.C("div");z.id=t;f.core.util.hideContainer.appendChild(z);var w=3000;var A=function(){if(parseInt(f.core.dom.getStyle(z,"height"))==42){f.core.util.hideContainer.removeChild(z);j(x);return}if(--w>0){setTimeout(A,10)}else{f.log(x+"timeout!");f.core.util.hideContainer.removeChild(z);delete o[x]}};setTimeout(A,50)};var c=function(v,u){if(!q(v,u)){return}var t=e+v;f.core.io.scriptLoader({url:t,onComplete:function(){j(v)},onTimeout:function(){f.log(v+"timeout!");delete o[v]}})};var r=function(u,t){if(!s[u]){s[u]=t}};var b=function(t){if(t){if(s[t]){try{a[t]=s[t](f)}catch(v){f.log(t,v)}}else{f.log("start:ns="+t+" ,have not been registed")}return}var u=[];for(t in s){u.push(t)}f.timedChunk(u,{process:function(w){try{a[w]=s[w](f)}catch(x){f.log(w,x)}}})};var p=function(t){var u=1,y,A,w,B,D,v,x;t=t||{};w=t.html;B=t.css;D=t.js;if(!t.pid||(!(A=f.E(t.pid))&&w!=null)){f.log("node pid["+t.pid+"] is not on the body");return}if(D&&!f.isArray(D)){D=[D]}v=function(){if(--u>0){return}(typeof w!="undefined")&&(A.innerHTML=w);if(D){x()}};x=function(E){if(D.length>0){c(D.splice(0,1)[0],x)}if(E&&E.indexOf("/pl/")!=-1){var F=E.replace(/^.*?\/(pl\/.*)\.js\??.*$/,"$1").replace(/\//g,".");b(F)}};if(B){u+=B.length;for(var z=0,C;(C=B[z]);z++){m(C,"js_"+C.replace(/^\/?(.*)\.css$/i,"$1").replace(/\//g,"_"),v)}}v()};var h=function(t){if(t){if(a[t]){f.log("destroy:"+t);try{a[t].destroy()}catch(u){f.log(u)}delete a[t]}return}for(t in a){f.log("destroy:"+t);try{a[t]&&a[t].destroy&&a[t].destroy()}catch(u){f.log(t,u)}}a={}};var n={register:r,start:b,view:p,clear:h,destroy:function(){n.clear();o={};a={};s={};g=undefined}};f.core.dom.ready(function(){f.addEvent(window,"unload",function(){f.removeEvent(window,"unload",arguments.callee);n.destroy()})});return n});(function(){var b=STK.core;var c={tween:b.ani.tween,tweenArche:b.ani.tweenArche,arrCopy:b.arr.copy,arrClear:b.arr.clear,hasby:b.arr.hasby,unique:b.arr.unique,foreach:b.arr.foreach,isArray:b.arr.isArray,inArray:b.arr.inArray,arrIndexOf:b.arr.indexOf,findout:b.arr.findout,domNext:b.dom.next,domPrev:b.dom.prev,isNode:b.dom.isNode,addHTML:b.dom.addHTML,insertHTML:b.dom.insertHTML,setXY:b.dom.setXY,contains:b.dom.contains,position:b.dom.position,trimNode:b.dom.trimNode,insertAfter:b.dom.insertAfter,insertBefore:b.dom.insertBefore,removeNode:b.dom.removeNode,replaceNode:b.dom.replaceNode,Ready:b.dom.ready,setStyle:b.dom.setStyle,setStyles:b.dom.setStyles,getStyle:b.dom.getStyle,addClassName:b.dom.addClassName,hasClassName:b.dom.hasClassName,removeClassName:b.dom.removeClassName,builder:b.dom.builder,cascadeNode:b.dom.cascadeNode,selector:b.dom.selector,sizzle:b.dom.sizzle,addEvent:b.evt.addEvent,custEvent:b.evt.custEvent,removeEvent:b.evt.removeEvent,fireEvent:b.evt.fireEvent,fixEvent:b.evt.fixEvent,getEvent:b.evt.getEvent,stopEvent:b.evt.stopEvent,delegatedEvent:b.evt.delegatedEvent,preventDefault:b.evt.preventDefault,hotKey:b.evt.hotKey,memorize:b.func.memorize,bind:b.func.bind,getType:b.func.getType,methodBefore:b.func.methodBefore,timedChunk:b.func.timedChunk,funcEmpty:b.func.empty,ajax:b.io.ajax,jsonp:b.io.jsonp,ijax:b.io.ijax,scriptLoader:b.io.scriptLoader,require:b.io.require,jsonInclude:b.json.include,jsonCompare:b.json.compare,jsonClone:b.json.clone,jsonToQuery:b.json.jsonToQuery,queryToJson:b.json.queryToJson,jsonToStr:b.json.jsonToStr,strToJson:b.json.strToJson,objIsEmpty:b.obj.isEmpty,beget:b.obj.beget,cascade:b.obj.cascade,objSup:b.obj.sup,parseParam:b.obj.parseParam,bLength:b.str.bLength,dbcToSbc:b.str.dbcToSbc,leftB:b.str.leftB,trim:b.str.trim,encodeHTML:b.str.encodeHTML,decodeHTML:b.str.decodeHTML,parseURL:b.str.parseURL,parseHTML:b.str.parseHTML,queryString:b.str.queryString,htmlToJson:b.util.htmlToJson,cookie:b.util.cookie,drag:b.util.drag,timer:b.util.timer,jobsM:b.util.jobsM,listener:b.util.listener,winSize:b.util.winSize,pageSize:b.util.pageSize,templet:b.util.templet,queue:b.util.queue,stack:b.util.stack,swf:b.util.swf,URL:b.util.URL,scrollPos:b.util.scrollPos,scrollTo:b.util.scrollTo,getUniqueKey:b.util.getUniqueKey,storage:b.util.storage,pageletM:b.util.pageletM};for(var a in c){STK.regShort(a,c[a])}})();STK.register("kit.extra.language",function(b){window.$LANG||(window.$LANG={});var a=function(e,g){var f=[];for(var d=2,c=arguments.length;d<c;d+=1){f.push(arguments[d])}return e.replace(/#L\{((.*?)(?:[^\\]))\}/ig,function(){var j=arguments[1];var h;if(g&&g[j]!==undefined){h=g[j]}else{h=j}if(f.length){h=h.replace(/(\%s)/ig,function(){var m=f.shift();if(m!==undefined){return m}else{return arguments[0]}})}return h})};return function(c){var e=[].splice.call(arguments,1,arguments.length);var d=[c,$LANG].concat(e);var f=a.apply(this,d);return f}});STK.register("kit.extra.reuse",function(a){return function(e,m){var j,h,b;j=a.parseParam({},m);b=[];var f=function(){var n=e();b.push({store:n,used:true});return n};var g=function(n){a.foreach(b,function(p,o){if(n===p.store){p.used=true;return false}})};var d=function(n){a.foreach(b,function(p,o){if(n===p.store){p.used=false;return false}})};var c=function(){for(var o=0,n=b.length;o<n;o+=1){if(b[o]["used"]===false){b[o]["used"]=true;return b[o]["store"]}}return f()};h={};h.setUsed=g;h.setUnused=d;h.getOne=c;h.getLength=function(){return b.length};return h}});STK.register("module.layer",function(b){var c=function(e){var d={};if(e.style.display=="none"){e.style.visibility="hidden";e.style.display="";d.w=e.offsetWidth;d.h=e.offsetHeight;e.style.display="none";e.style.visibility="visible"}else{d.w=e.offsetWidth;d.h=e.offsetHeight}return d};var a=function(g,f){f=f||"topleft";var e=null;if(g.style.display=="none"){g.style.visibility="hidden";g.style.display="";e=b.core.dom.position(g);g.style.display="none";g.style.visibility="visible"}else{e=b.core.dom.position(g)}if(f!=="topleft"){var d=c(g);if(f==="topright"){e.l=e.l+d.w}else{if(f==="bottomleft"){e.t=e.t+d.h}else{if(f==="bottomright"){e.l=e.l+d.w;e.t=e.t+d.h}}}}return e};return function(h){var n=b.core.dom.builder(h);var g=n.list.outer[0],e=n.list.inner[0];var m=b.core.dom.uniqueID(g);var j={};var d=b.core.evt.custEvent.define(j,"show");b.core.evt.custEvent.define(d,"hide");var f=null;j.show=function(){g.style.display="";b.core.evt.custEvent.fire(d,"show");return j};j.hide=function(){g.style.display="none";b.custEvent.fire(d,"hide");return j};j.getPosition=function(o){return a(g,o)};j.getSize=function(o){if(o||!f){f=c.apply(j,[g])}return f};j.html=function(o){if(o!==undefined){e.innerHTML=o}return e.innerHTML};j.text=function(o){if(text!==undefined){e.innerHTML=b.core.str.encodeHTML(o)}return b.core.str.decodeHTML(e.innerHTML)};j.appendChild=function(o){e.appendChild(o);return j};j.getUniqueID=function(){return m};j.getOuter=function(){return g};j.getInner=function(){return e};j.getParentNode=function(){return g.parentNode};j.getDomList=function(){return n.list};j.getDomListByKey=function(o){return n.list[o]};j.getDom=function(p,o){if(!n.list[p]){return false}return n.list[p][o||0]};j.getCascadeDom=function(p,o){if(!n.list[p]){return false}return b.core.dom.cascadeNode(n.list[p][o||0])};return j}});STK.register("module.dialog",function(a){return function(q,r){if(!q){throw"module.dialog need template as first parameter"}var n,g,h,f,o,m,t,j,b,c,p,e;b=true;var d=function(){if(b!==false){g.hide()}};var s=function(){n=a.parseParam({t:null,l:null,width:null,height:null},r);g=a.module.layer(q,n);f=g.getOuter();o=g.getDom("title");j=g.getDom("title_content");m=g.getDom("inner");t=g.getDom("close");a.addEvent(t,"click",function(u){a.preventDefault(u);p();return false});a.custEvent.add(g,"show",function(){a.hotKey.add(document.documentElement,["esc"],d,{type:"keyup",disableInInput:true})});a.custEvent.add(g,"hide",function(){a.hotKey.remove(document.documentElement,["esc"],d,{type:"keyup"});b=true})};s();e=a.objSup(g,["show","hide"]);p=function(u){if(typeof c==="function"&&!u){if(c()===false){return false}}e.hide();if(a.contains(document.body,g.getOuter())){document.body.removeChild(g.getOuter())}return h};h=g;h.show=function(){if(!a.contains(document.body,g.getOuter())){document.body.appendChild(g.getOuter())}e.show();return h};h.hide=p;h.setPosition=function(u){f.style.top=u.t+"px";f.style.left=u.l+"px";return h};h.setMiddle=function(){var u=a.core.util.winSize();var v=g.getSize(true);f.style.top=a.core.util.scrollPos()["top"]+(u.height-v.h)/2+"px";f.style.left=(u.width-v.w)/2+"px";return h};h.setTitle=function(u){j.innerHTML=u;return h};h.setContent=function(u){if(typeof u==="string"){m.innerHTML=u}else{m.appendChild(u)}return h};h.clearContent=function(){while(m.children.length){a.removeNode(m.children[0])}return h};h.setAlign=function(){};h.setBeforeHideFn=function(u){c=u};h.clearBeforeHideFn=function(){c=null};h.unsupportEsc=function(){b=false};h.supportEsc=function(){b=true};return h}});STK.register("kit.dom.cssText",function(b){var a=function(f,e){var c=(f+";"+e).replace(/(\s*(;)\s*)|(\s*(:)\s*)/g,"$2$4"),d;while(c&&(d=c.match(/(^|;)([\w\-]+:)([^;]*);(.*;)?\2/i))){c=c.replace(d[1]+d[2]+d[3],"")}return c};return function(d){d=d||"";var e=[],c={push:function(g,f){e.push(g+":"+f);return c},remove:function(g){for(var f=0;f<e.length;f++){if(e[f].indexOf(g+":")==0){e.splice(f,1)}}return c},getStyleList:function(){return e.slice()},getCss:function(){return a(d,e.join(";"))}};return c}});STK.register("kit.dom.fix",function(d){var a=!(d.core.util.browser.IE6||(document.compatMode!=="CSS1Compat"&&STK.IE)),b=/^(c)|(lt)|(lb)|(rt)|(rb)$/;function c(g){return d.core.dom.getStyle(g,"display")!="none"}function e(h){h=d.core.arr.isArray(h)?h:[0,0];for(var g=0;g<2;g++){if(typeof h[g]!="number"){h[g]=0}}return h}function f(m,u,p){if(!c(m)){return}var t="fixed",w,x,g,s,n=m.offsetWidth,o=m.offsetHeight,q=d.core.util.winSize(),r=0,v=0,h=d.kit.dom.cssText(m.style.cssText);if(!a){t="absolute";var j=d.core.util.scrollPos();r=w=j.top;v=x=j.left;switch(u){case"lt":w+=p[1];x+=p[0];break;case"lb":w+=q.height-o-p[1];x+=p[0];break;case"rt":w+=p[1];x+=q.width-n-p[0];break;case"rb":w+=q.height-o-p[1];x+=q.width-n-p[0];break;case"c":default:w+=(q.height-o)/2+p[1];x+=(q.width-n)/2+p[0]}g=s=""}else{w=s=p[1];x=g=p[0];switch(u){case"lt":s=g="";break;case"lb":w=g="";break;case"rt":x=s="";break;case"rb":w=x="";break;case"c":default:w=(q.height-o)/2+p[1];x=(q.width-n)/2+p[0];s=g=""}}if(u=="c"){if(w<r){w=r}if(x<v){x=v}}h.push("position",t).push("top",w+"px").push("left",x+"px").push("right",g+"px").push("bottom",s+"px");m.style.cssText=h.getCss()}return function(h,q,j){var m,r,n=true,g;if(d.core.dom.isNode(h)&&b.test(q)){var o={getNode:function(){return h},isFixed:function(){return n},setFixed:function(s){(n=!!s)&&f(h,m,r);return this},setAlign:function(s,t){if(b.test(s)){m=s;r=e(t);n&&f(h,m,r)}return this},destroy:function(){if(!a){a&&d.core.evt.removeEvent(window,"scroll",p)}d.core.evt.removeEvent(window,"resize",p);d.core.evt.custEvent.undefine(g)}};g=d.core.evt.custEvent.define(o,"beforeFix");o.setAlign(q,j);function p(s){s=s||window.event;d.core.evt.custEvent.fire(g,"beforeFix",s.type);if(n&&(!a||m=="c")){f(h,m,r)}}if(!a){d.core.evt.addEvent(window,"scroll",p)}d.core.evt.addEvent(window,"resize",p);return o}}});STK.register("module.mask",function(e){var n,c=[],b,m=false,a="STK-Mask-Key";var g=e.core.dom.setStyle,j=e.core.dom.getStyle,h=e.core.evt.custEvent;function d(){n=e.C("div");var p='<div node-type="outer">';if(e.core.util.browser.IE6){p+='<div style="position:absolute;width:100%;height:100%;"></div>'}p+="</div>";n=e.builder(p).list.outer[0];document.body.appendChild(n);m=true;b=e.kit.dom.fix(n,"lt");var q=function(){var r=e.core.util.winSize();n.style.cssText=e.kit.dom.cssText(n.style.cssText).push("width",r.width+"px").push("height",r.height+"px").getCss()};h.add(b,"beforeFix",q);q()}function o(p){var q;if(!(q=p.getAttribute(a))){p.setAttribute(a,q=e.getUniqueKey())}return">"+p.tagName.toLowerCase()+"["+a+'="'+q+'"]'}var f={getNode:function(){return n},show:function(q,p){if(m){q=e.core.obj.parseParam({opacity:0.3,background:"#000000"},q);if($CONFIG.pageid=="pic"){q.opacity=0.9}n.style.background=q.background;g(n,"opacity",q.opacity);n.style.opacity=q.opacity;n.style.display="";b.setAlign("lt");p&&p()}else{d();f.show(q,p)}return f},hide:function(){n.style.display="none";nowIndex=undefined;c=[];return f},showUnderNode:function(q,p){if(e.isNode(q)){f.show(p,function(){g(n,"zIndex",j(q,"zIndex"));var s=o(q);var r=e.core.arr.indexOf(c,s);if(r!=-1){c.splice(r,1)}c.push(s);e.core.dom.insertElement(q,n,"beforebegin")})}return f},back:function(){if(c.length<1){return f}var q,p;c.pop();if(c.length<1){f.hide()}else{if((p=c[c.length-1])&&(q=e.sizzle(p,document.body)[0])){g(n,"zIndex",j(q,"zIndex"));e.core.dom.insertElement(q,n,"beforebegin")}else{f.back()}}return f},destroy:function(){h.remove(b);n.style.display="none";lastNode=undefined;_cache={}}};return f});STK.register("kit.dom.drag",function(a){return function(d,s){var h,g,q,o,c,n,e,j;var t=function(){f();m()};var f=function(){h=a.parseParam({moveDom:d,perchStyle:"border:solid #999999 2px;",dragtype:"perch",actObj:{},pagePadding:5},s);q=h.moveDom;g={};o={};c=a.drag(d,{actObj:h.actObj});if(h.dragtype==="perch"){n=a.C("div");e=false;j=false;q=n}d.style.cursor="move"};var m=function(){a.custEvent.add(h.actObj,"dragStart",p);a.custEvent.add(h.actObj,"dragEnd",b);a.custEvent.add(h.actObj,"draging",r)};var p=function(u,x){document.body.style.cursor="move";var w=a.core.util.pageSize()["page"];o=a.core.dom.position(h.moveDom);o.pageX=x.pageX;o.pageY=x.pageY;o.height=h.moveDom.offsetHeight;o.width=h.moveDom.offsetWidth;o.pageHeight=w.height;o.pageWidth=w.width;if(h.dragtype==="perch"){var v=[];v.push(h.perchStyle);v.push("position:absolute");v.push("z-index:"+(h.moveDom.style.zIndex+10));v.push("width:"+h.moveDom.offsetWidth+"px");v.push("height:"+h.moveDom.offsetHeight+"px");v.push("left:"+o.l+"px");v.push("top:"+o.t+"px");n.style.cssText=v.join(";");j=true;setTimeout(function(){if(j){document.body.appendChild(n);e=true}},100)}if(d.setCapture!==undefined){d.setCapture()}};var b=function(u,v){document.body.style.cursor="auto";if(d.setCapture!==undefined){d.releaseCapture()}if(h.dragtype==="perch"){j=false;h.moveDom.style.top=n.style.top;h.moveDom.style.left=n.style.left;if(e){document.body.removeChild(n);e=false}}};var r=function(w,D){var C=o.t+(D.pageY-o.pageY);var v=o.l+(D.pageX-o.pageX);var z=C+o.height;var A=v+o.width;var u=o.pageHeight-h.pagePadding;var B=o.pageWidth-h.pagePadding;if(z<u&&C>0){q.style.top=C+"px"}else{if(C<0){q.style.top="0px"}if(z>=u){q.style.top=u-o.height+"px"}}if(A<B&&v>0){q.style.left=v+"px"}else{if(v<0){q.style.left="0px"}if(A>=B){q.style.left=B-o.width+"px"}}};t();g.destroy=function(){document.body.style.cursor="auto";if(typeof q.setCapture==="function"){q.releaseCapture()}if(h.dragtype==="perch"){j=false;if(e){document.body.removeChild(n);e=false}}a.custEvent.remove(h.actObj,"dragStart",p);a.custEvent.remove(h.actObj,"dragEnd",b);a.custEvent.remove(h.actObj,"draging",r);if(c.destroy){c.destroy()}h=null;q=null;o=null;c=null;n=null;e=null;j=null};g.getActObj=function(){return h.actObj};return g}});STK.register("ui.dialog",function(e){var d='<div class="W_layer" node-type="outer" style="display:none;position:absolute;z-index:10001;"><div class="bg"><table border="0" cellspacing="0" cellpadding="0"><tr><td><div class="content" node-type="layoutContent"><div class="title" node-type="title"><span node-type="title_content"></span></div><a href="javascript:void(0);" class="W_close" title="#L{}" node-type="close"></a><div node-type="inner"></div></div></td></tr></table></div></div>';var f=e.kit.extra.language;var b=null,c;var a=function(){var h=e.module.dialog(f(c.template));e.custEvent.add(h,"show",function(){e.module.mask.showUnderNode(h.getOuter())});e.custEvent.add(h,"hide",function(){e.module.mask.back();h.setMiddle()});e.kit.dom.drag(h.getDom("title"),{actObj:h,moveDom:h.getOuter()});h.destroy=function(){g(h);try{h.hide(true)}catch(j){}};return h};var g=function(h){h.setTitle("").clearContent();b.setUnused(h)};return function(h){c=e.parseParam({template:d,isHold:false},h);var m=c.isHold;c=e.core.obj.cut(c,["isHold"]);if(!b){b=e.kit.extra.reuse(a)}var j=b.getOne();if(!m){e.custEvent.add(j,"hide",function(){e.custEvent.remove(j,"hide",arguments.callee);g(j)})}return j}});STK.register("ui.alert",function(d){var c='<div node-type="outer" class="layer_point"><dl class="point clearfix"><dt><span class="" node-type="icon"></span></dt><dd node-type="inner"><p class="W_texta" node-type="textLarge"></p><p class="W_textb" node-type="textSmall"></p></dd></dl><div class="btn"><a href="javascript:void(0)" class="S_btn_b" node-type="OK"></a></div></div>';var f={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon_questionM"};var e=d.kit.extra.language;var b=null;var a=function(h,g){h.getDom("icon").className=g.icon;h.getDom("textLarge").innerHTML=g.textLarge;h.getDom("textSmall").innerHTML=g.textSmall;h.getDom("OK").innerHTML="<span>"+g.OKText+"</span>"};return function(g,p,j){var o,n,m,r,q;o=d.parseParam({title:e("#L{}"),icon:"warn",textLarge:g,textSmall:"",OK:d.funcEmpty,OKText:e("#L{}"),timeout:0},p);o.icon=f[o.icon];n={};if(!b){b=d.kit.extra.reuse(function(){var s=d.module.layer(e(c));return s})}m=b.getOne();r=d.ui.dialog();r.setContent(m.getOuter());r.setTitle(o.title);a(m,o);var h=function(s){r.is_closed=s.target.parentNode.getAttribute("node-type");d.preventDefault(s);r.hide()};d.addEvent(m.getDom("OK"),"click",h);d.custEvent.add(r,"hide",function(){d.custEvent.remove(r,"hide",arguments.callee);d.removeEvent(m.getDom("OK"),"click",h);b.setUnused(m);clearTimeout(q);r.is_closed=="OK"?o.OK():j[0].innerHTML=e("#L{}")});if(o.timeout){q=setTimeout(r.hide,o.timeout)}r.show().setMiddle();n.alt=m;n.dia=r;return n}});STK.register("ui.confirm",function(c){var b='<div node-type="outer" class="layer_point"><dl class="point clearfix"><dt><span class="" node-type="icon"></span></dt><dd node-type="inner"><p class="W_texta" node-type="textLarge"></p><p class="W_textb" node-type="textComplex"></p><p class="W_textb" node-type="textSmall"></p></dd></dl><div class="btn"><a href="javascript:void(0)" class="S_btn_b" node-type="OK"></a><a href="javascript:void(0)" class="Sbtn_a" node-type="cancel"></a></div></div>';var e={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon_questionM"};var d=c.kit.extra.language;var a=null;return function(g,p){var o,n,h,q,m,f;o=c.parseParam({title:d("#L{}"),icon:"question",textLarge:g,textComplex:"",textSmall:"",OK:c.funcEmpty,OKText:d("#L{}"),cancel:c.funcEmpty,cancelText:d("#L{}")},p);o.icon=e[o.icon];n={};if(!a){a=c.kit.extra.reuse(function(){var r=c.module.layer(b);return r})}h=a.getOne();q=c.ui.dialog();q.setContent(h.getOuter());h.getDom("icon").className=o.icon;h.getDom("textLarge").innerHTML=o.textLarge;h.getDom("textComplex").innerHTML=o.textComplex;h.getDom("textSmall").innerHTML=o.textSmall;h.getDom("OK").innerHTML="<span>"+o.OKText+"</span>";h.getDom("cancel").innerHTML="<span>"+o.cancelText+"</span>";q.setTitle(o.title);var j=function(){m=true;f=c.htmlToJson(h.getDom("textComplex"));q.hide()};c.addEvent(h.getDom("OK"),"click",j);c.addEvent(h.getDom("cancel"),"click",q.hide);c.custEvent.add(q,"hide",function(){c.custEvent.remove(q,"hide",arguments.callee);c.removeEvent(h.getDom("OK"),"click",j);c.removeEvent(h.getDom("cancel"),"click",q.hide);a.setUnused(h);if(m){o.OK(f)}else{o.cancel(f)}});q.show().setMiddle();n.cfm=h;n.dia=q;return n}});STK.register("kit.extra.merge",function(a){return function(d,c){var f={};for(var e in d){f[e]=d[e]}for(var e in c){f[e]=c[e]}return f}});STK.register("kit.io.ajax",function(b){var a=function(d,e,f){e=(e|0)||1;f=f||"fail";var c=d.args;if(c.__rnd){delete c.__rnd}(new Image()).src="//weibolog.sinaapp.com/?t="+e+"&u="+encodeURIComponent(d.url)+"&p="+encodeURIComponent(b.core.json.jsonToQuery(c))+"&m="+f};return function(m){var j,g,f,h,n,c,d;c=function(p){n=false;m.onComplete(p,j.args);setTimeout(o,0)};d=function(p){n=false;if(typeof m.onFail==="function"){m.onFail(p,j.args)}setTimeout(o,0);try{a(j)}catch(q){}};f=[];h=null;n=false;j=b.parseParam({url:"",method:"get",responseType:"json",timeout:30*1000,onTraning:b.funcEmpty,isEncode:true},m);j.onComplete=c;j.onFail=d;j.onTimeout=function(){try{a(j)}catch(p){}};var o=function(){if(!f.length){return}if(n===true){return}n=true;j.args=f.shift();if(j.method.toLowerCase()=="post"){var p=b.core.util.URL(j.url);p.setParam("__rnd",new Date().valueOf());j.url=p.toString()}h=b.ajax(j)};var e=function(q){while(f.length){f.shift()}n=false;if(h){try{h.abort()}catch(p){}}h=null};g={};g.request=function(p){if(!p){p={}}if(m.noQueue){e()}if(!m.uniqueRequest||!h){f.push(p);p._t=0;o()}};g.abort=e;return g}});STK.register("kit.io.jsonp",function(a){return function(d){var c,f,b,h,e;c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:30*1000,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:true},d);b=[];h={};e=false;var g=function(){if(!b.length){return}if(e===true){return}e=true;h.args=b.shift();h.onComplete=function(j){e=false;c.onComplete(j,h.args);setTimeout(g,0)};h.onFail=function(j){e=false;c.onFail(j);setTimeout(g,0)};a.jsonp(a.kit.extra.merge(c,{args:h.args,onComplete:function(j){h.onComplete(j)},onFail:function(j){try{h.onFail(j)}catch(m){}}}))};f={};f.request=function(j){if(!j){j={}}b.push(j);j._t=1;g()};f.abort=function(j){while(b.length){b.shift()}e=false;h=null};return f}});STK.register("kit.io.inter",function(a){return function(){var b,d,c;b={};d={};c={};b.register=function(f,e){if(d[f]!==undefined){throw f+" interface has been registered"}d[f]=e;c[f]={}};b.hookComplete=function(e,g){var f=a.core.util.getUniqueKey();c[e][f]=g;return f};b.removeHook=function(e,f){if(c[e]&&c[e][f]){delete c[e][f]}};b.getTrans=function(g,e){var f=a.kit.extra.merge(d[g],e);f.onComplete=function(j,n){try{e.onComplete(j,n)}catch(m){}if(j.code==="100000"){try{e.onSuccess(j,n)}catch(m){}}else{try{if(j.code==="100002"){window.location.href=j.data;return}e.onError(j,n)}catch(m){}}for(var h in c[g]){try{c[g][h](j,n)}catch(m){}}};if(d[g]["requestMode"]==="jsonp"){return a.kit.io.jsonp(f)}else{if(d[g]["requestMode"]==="ijax"){return a.kit.io.ijax(f)}else{return a.kit.io.ajax(f)}}};b.request=function(h,e,g){var f=a.core.json.merge(d[h],e);f.onComplete=function(m,o){try{e.onComplete(m,o)}catch(n){}if(m.code==="100000"){try{e.onSuccess(m,o)}catch(n){}}else{try{if(m.code==="100002"){window.location.href=m.data;return}e.onError(m,o)}catch(n){}}for(var j in c[h]){try{c[h][j](m,o)}catch(n){}}};f=a.core.obj.cut(f,["noqueue"]);f.args=g;if(d[h]["requestMode"]==="jsonp"){return a.jsonp(f)}else{if(d[h]["requestMode"]==="ijax"){return a.ijax(f)}else{return a.ajax(f)}}};return b}});STK.register("common.trans.global",function(d){var b=d.kit.io.inter();var c=b.register;var e="/ajax/jsProxy.php?interurl=http://new.weibo.com";var a="/ajax/";c("language",{url:"/ajax/user/lang",method:"post"});c("followList",{url:a+"suggestion",method:"get"});c("share",{url:"/ajax/mblog/searchshare",method:"post"});c("topshare",{url:"/ajax/mblog/searchshare",method:"post"});c("publish",{url:"/ajax/mblog/topic/shareweibo",method:"post"});c("followpub",{url:"/ajax/user/follow",method:"post"});c("followTopic",{url:"/ajax/like/objectfollow",method:"post"});c("upcover",{url:"/ajax/claim/uploadpic",method:"post"});c("commitcover",{url:"/ajax/claim/Setinfo",method:"post"});c("weiboActs",{url:"/ajax/claim/topicweibo",method:"get"});c("weibotop",{url:"/ajax/claim/shield",method:"get"});return b});STK.register("comp.common.changeLanguage",function(a){var b=null;return function(d){var g={},c=a.kit.extra.language,n={"zh-cn":c("#L{}"),"zh-tw":c("#L{}"),"en-us":c("#L{}")};var e=(function(){var p=a.common.trans.global.getTrans("language",{onComplete:function(q){if(q&&q.code=="100000"){window.location.reload()}else{a.ui.alert(q.msg)}}});return function(q){p.request({lang:q})}})();var f={changeLanguage:function(){var p=d.value;a.ui.confirm(n[p],{OK:function(){e(p)},cancel:function(){d.value=$CONFIG.lang}})}};var j=function(){if(!a.core.dom.isNode(d)){throw"[STK.comp.comment.changeLanguage]:node is not a Node!"}};var h=function(){a.addEvent(d,"change",f.changeLanguage)};var m=function(){a.removeEvent(d,"change",f.changeLanguage);f.changeLanguage&&(f.changeLanguage=null)};var o=function(){if(b){return}b=d;j();h()}();g.destroy=function(){return};return g}});STK.pageletM.register("pl.common.changeLanguage",function(b){var a=b.E("pl_common_changeLanguage");if(a){return b.comp.common.changeLanguage(a)}});STK.register("common.form.enterSubmit",function($){return function(options){var extend;extend=function(oSource,oParams){var key;for(key in oParams){oSource[key]=oParams[key]}return oSource};options=extend({parent:document},options);var _p=$.E(options.parent);var _checkEnter=function(){var _e=$.core.evt.getEvent();var _k=_e.keyCode;var _act=options.action||null;if(_k===13&&_act){try{if(typeof _act==="string"){eval("("+_act+")();")}else{if(typeof _act==="function"){_act()}}}catch(e){}}};if(_p){var els=_p.getElementsByTagName("input");for(var i=0,l=els.length;i<l;i++){var cur=els[i];var _t=cur.getAttribute("type").toLowerCase();if(_t==="text"||_t==="password"||_t==="checkbox"){if(cur.getAttribute("passenter")==="1"){continue}$.core.evt.addEvent(cur,"keydown",_checkEnter)}}}}});STK.register("common.form.valueChange",function(b){var d={27:"esc",9:"tab",13:"enter",145:"scrolllock",20:"capslock",144:"numlock",19:"pause",45:"insert",36:"home",35:"end",33:"pageup",34:"pagedown",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",17:"ctrl",16:"shift"};var a,c;return function(j,h){var f={delay:0,callback:b.core.func.empty};var m;h=b.parseParam(f,h);a=b.core.str.trim(j.value);var g=function(n){if(d[n]){return true}else{return false}};var e=function(){if(m){clearTimeout(m)}var o=b.core.evt.getEvent();var n=o.keyCode;c=b.core.str.trim(j.value);if(!g(n)&&c!=a){m=setTimeout(function(){h.callback();a=c;m=null},h.delay)}};b.core.evt.addEvent(j,"keyup",e)}});STK.register("common.dialog.masterIframe",function(d){var c,a,e,b;c={create:function(f){if(d.core.util.browser.IE6){if(a){c.destroy(a)}e=d.core.dom.position(f);b={w:f.offsetWidth,h:f.offsetHeight};zindex=d.core.dom.getStyle(f,"zIndex");a=d.C("DIV");a.style.cssText="left:"+e.l+";top:"+e.t+";position:absolute;z-index:"+(zindex-1);a.innerHTML='<iframe frameborder="no" width="'+b.w+'px" height="'+b.h+'px"></iframe>';document.body.appendChild(a);return c}return c},getOuter:function(){return a},destroy:function(){try{document.body.removeChild(a)}catch(f){}a=null},setPosition:function(f){a.style.top=f.t+"px";a.style.left=f.l+"px";return c},setSize:function(f){a.style.width=f.w+"px";a.style.height=f.h+"px"}};return c});STK.register("common.search.suggestInput",function(g){var f,s,c={},a,q,h,t,w,d,e,v,j,m,p,b={},u,r={},n,o="weibo";return function(y,x){y=g.E(y);y.setAttribute("autocomplete","off");if(!y){throw"common.form.suggestInput : need el as a param"}var F='<#et tip data><ul><#list data as list><li action-type="suggestList"><a href="javascript:;" style="padding:5px 0; white-space:normal;"><span style="margin:0 5px;display:block;overflow:hidden;height:14px;">${list}</span></a></li></#list></ul></#et>';var E="T_"+g.core.util.getUniqueKey();f={url:"/ajax/aj_find_lenovo.php",template:F,focusTemplate:"",focusArgs:{type:"hot",key:""},focusclass:"current",left:0,top:0,width:0,focusback:g.core.func.empty,clickback:g.core.func.empty,blurback:g.core.func.empty,getDataback:g.core.func.empty,css:"",className:"K_menu_list",args:{},key:"key",defaultText:"",offset:{top:0,left:0}};r[E]=g.core.json.merge(f,x);j=g.core.evt.addEvent;m=g.core.evt.removeEvent;var z="__HOT_LIST_KEYWORD__";var G={listOver:function(I){h=0;var H=I.el;clearTimeout(a);if(e){g.core.dom.removeClassName(e,r[E].focusclass)}e=H;a=setTimeout(function(){g.core.dom.addClassName(H,r[E].focusclass)},20)},listOut:function(I){var H=I.el;clearTimeout(q);q=setTimeout(function(){g.core.dom.removeClassName(H,r[E].focusclass)},10)},clickItem:function(I){if(I.data&&I.data.uid){G.userItem(I);return false}var H=I.el;r[E].clickback(I)},userItem:function(H){if(H.data&&H.data.uid){window.location.href="//weibo.com/"+H.data.uid}return false},delItem:function(I){I.currentType=o;var H=I.el;delete b[r[E].url+u+"_"+E];c[E].style.display="";r[E].delback(I);return false},hotKey:function(I){var J=I||window.event;var H=J.keyCode;if(!h){h=0}switch(H){case 38:G.upKey();break;case 40:G.downKey();break;case 13:G.enterKey();default:break}},downKey:function(){var I,H;if(!t||t.length==0){return}if(h>0){g.core.dom.removeClassName(t[h-1],r[E].focusclass)}h++;if(h>=t.length+1){h=0;y.value=v}if(h>0){g.core.dom.addClassName(t[h-1],r[E].focusclass);I=g.core.dom.builder(t[h-1]).list;H=I.suggestlist_text?I.suggestlist_text[0].innerText||I.suggestlist_text[0].textContent:v;y.value=H;e=t[h-1]}},upKey:function(){var I,H;if(!t||t.length==0){return}if(h>0){g.core.dom.removeClassName(t[h-1],r[E].focusclass)}h--;if(h<0){h=t.length}if(h>0){g.core.dom.addClassName(t[h-1],r[E].focusclass);I=g.core.dom.builder(t[h-1]).list;H=I.suggestlist_text?I.suggestlist_text[0].innerText||I.suggestlist_text[0].textContent:v;y.value=H;e=t[h-1]}else{if(h<=0){y.value=v}}g.preventDefault()},enterKey:function(){if(h-1<0){return}var H=t[h-1];g.core.evt.fireEvent(H,"click")},faceInit:function(J,L){var I={};if(J.searchHistoryData.length===0&&J.searchUserData.length===0&&J.searchValueData.length===0){D.hide();return}if(!L){L=r[E].template}I.searchHistoryData=J.searchHistoryData?J.searchHistoryData:[];I.searchUserData=J.searchUserData?J.searchUserData:[];I.searchValueData=J.searchValueData?J.searchValueData:[];I.searchData=J.data;tipHTML=g.core.util.easyTemplate(g.kit.extra.language(L),I);var M=decodeURIComponent(u);var H=new RegExp("(<a.*?>)(.*?)(</a>)","gi");if(y.value.length!=0){tipHTML=tipHTML.toString().replace(H,function(O,N,R,Q){var P=new RegExp("^"+M,"gi");return N+(M===z||!P.test(R)?"":M)+'<em class="bold">'+R.replace(P,"")+"</em>"+Q})}if(!c[E]){c[E]=g.C("DIV");document.body.appendChild(c[E]);c[E].className=r[E].className;var K=g.core.evt.delegatedEvent(c[E]);K.add("suggestList","mouseover",G.listOver);K.add("suggestList","mouseout",G.listOut);K.add("suggestList","click",G.clickItem);K.add("suggestList_del","click",G.delItem);t=[]}c[E].style.cssText="z-index:999;left:"+(r[E].left?r[E].left:(g.core.dom.position(y).l+r[E].offset.left))+"px;top:"+(r[E].top?r[E].top:(g.core.dom.position(y).t+y.offsetHeight+r[E].offset.top))+"px;width:"+((r[E].width?r[E].width:y.offsetWidth))+"px;position:absolute;"+r[E].css;c[E].innerHTML=tipHTML;n=g.common.dialog.masterIframe.create(c[E]);t=g.core.dom.sizzle('[action-type="suggestList"]',c[E]);h=0}};var C=function(I,H){o=r[E].args.type?r[E].args.type:"weibo";u=encodeURIComponent(y.value);if(u==""){u=z}if(typeof b[r[E].url+u+"_"+E]!="undefined"){G.faceInit(b[r[E].url+u+"_"+E],I);if(typeof(r[E].getDataback)=="function"){r[E].getDataback(b[r[E].url+u+"_"+E])}}else{H[r[E]["key"]]=(u==z)?"":u;g.core.io.ajax({url:r[E].url,args:H,method:"get",responseType:"json",onComplete:function(R){if(R.code=="100000"){R.searchHistoryData=[],R.searchUserData=[],R.searchValueData=[];var Q={hot:"weibo",gs_weibo:"weibo",weibo:"wb",user:"user",friend_index:"user",pic:"weibo",apps:"weibo",video:"weibo",};if(Q[o]){o=Q[o]}else{o=Q[$CONFIG.pageid]?Q[$CONFIG.pageid]:"weibo"}var L=o,S=g.core.util.storage.get(L),P,O=decodeURIComponent(u);if(S!="null"&&S!=""){P=S.replace(/^\|@\|/,"").replace(/\|@\|$/,"").split("|@|");if(O===z){g.core.arr.foreach(P,function(T,U){var V=T.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");R.searchHistoryData.push(V)})}else{R.searchHistoryData=[];g.core.arr.foreach(P,function(T,U){try{var W=new RegExp(O,"gi");if(W.test(T)){var V=T.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");R.searchHistoryData.push(V)}}catch(X){}})}}if(R.data&&R.data.length!=0){g.core.arr.foreach(R.data,function(T,U){if(T.u_id){R.searchUserData.push(T)}else{R.searchValueData.push(T)}})}if(R.searchHistoryData&&R.searchHistoryData.length>=3){R.searchHistoryData=R.searchHistoryData.slice(0,3)}if(u!=z){var M=[];if(R.searchHistoryData&&R.searchHistoryData.length!=0&&R.searchValueData&&R.searchValueData.length!=0){g.core.arr.foreach(R.searchValueData,function(T,U){var V=T,W=true;g.core.arr.foreach(R.searchHistoryData,function(X,Y){if(!!V.key&&V.key===X||V===X){W=false}});if(W){M.push(T)}});R.searchValueData=M}}if(R.searchUserData&&R.searchUserData.length>=3){R.searchUserData=R.searchUserData.slice(0,3)}if(R.searchValueData&&R.searchValueData.length>=7){R.searchValueData=R.searchValueData.slice(0,7)}b[r[E].url+u+"_"+E]=R;G.faceInit(R,I);if(typeof(r[E].getDataback)=="function"){r[E].getDataback(R)}for(var N=0;N<R.searchValueData.length;N++){var J=R.searchValueData[N];if(J&&J.monitor&&J.monitor.ad_id){K(J)}}function K(V){var T={word:V.word,url_show:V.monitor.pc_show,};var U=new Image();U.src="//j.s.weibo.com/doit.png?type=show&position=s_suggest_show&word="+T.word+"&time="+(+new Date());if(T.url_show){var W=new Image();W.src=decodeURIComponent(T.url_show).replace("__REQUESTID__","s_suggest_show"+(+new Date()))+"&word="+T.word}}}}})}};var B=function(I,H){if(p){clearTimeout(p)}p=setTimeout(function(){if(H){C(I,r[E].focusArgs)}else{C(I,r[E].args)}},10)};var D={};var A=function(){var H=g.core.evt.getActiveElement();if(H!=y){D.hide()}};D.hide=function(){if(c[E]){c[E].style.display="none";h=0;t=[];m(document.body,"click",A);n.destroy(n.getOuter())}};D.show=function(H){if(y.value.length===0){D.showHot(r[E].focusTemplate);return}if(g.core.str.bLength(g.core.str.trim(y.value))==0){D.hide();return}if(window.sugData&&y.value===window.sugData.defaultText){window.sugData.setValue()}B(H);v=y.value;j(document.body,"click",A)};D.showHot=function(H){B(H,true);v=y.value;j(document.body,"click",A)};g.core.evt.addEvent(window,"resize",function(){if(c[E]&&c[E].style.display!="none"){c[E].style.cssText="z-index:100;left:"+(g.core.dom.position(y).l+r[E].offset.left+1)+"px;top:"+(g.core.dom.position(y).t+y.offsetHeight+r[E].offset.top-1)+"px;width:"+(r[E].width?r[E].width:y.offsetWidth)+"px;position:absolute;"+r[E].css}});g.common.form.valueChange(y,{callback:D.show,delay:100});g.addEvent(y,"focus",function(){if(y.value==r[E].defaultText){y.value=""}if(y.value==""&&r[E].focusTemplate){D.showHot(r[E].focusTemplate)}});g.addEvent(y,"blur",function(){if(g.bLength(g.trim(y.value))==0){y.value=r[E].defaultText}window.setTimeout(function(){D.hide()},200)});D.setOption=function(H){r[E]=g.core.json.merge(r[E],H);return D};j(y,"keydown",G.hotKey);return D}});STK.register("comp.searchItems",function(a){return function(e){var j={};var n=252,c,m=true;var f=window.location.href;var g={showItems:function(p){if(a.core.dom.hasClassName(c.moreItems,"hidden_li")){a.core.dom.removeClassName(c.moreItems,"hidden_li");a.core.dom.addClassName(c.moreItems,"li_show");c.more.style.display="none"}else{a.core.dom.removeClassName(c.moreItems,"li_show");a.core.dom.addClassName(c.moreItems,"hidden_li");c.more.style.display=""}}};var b=function(){if(!e){throw"need an element node as param ->comp.searchItems"}c={moreItems:a.sizzle("[node-type=moreItems]",e)[0],more:a.sizzle("[node-type=more]",e)[0]}};var d=function(){};var h=function(){a.core.evt.addEvent(c.more,"click",g.showItems)};var o=function(){b();d();h()};o();j.destroy=function(){};return j}});STK.register("common.search.cityList",function(b){var a={"/":{code:0,city:{"/":0}},"":{code:34,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":10,"":11,"":12,"":13,"":14,"":15,"":16,"":17,"":18}},"":{code:11,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":11,"":12,"":13,"":14,"":15,"":16,"":17,"":28,"":29}},"":{code:50,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":12,"":13,"":14,"":15,"":22,"":23,"":24,"":25,"":26,"":27,"":28,"":29,"":30,"":31,"":32,"":33,"":34,"":35,"":36,"":37,"":38,"":40,"":41,"":42,"":43,"":81,"":82,"":83,"":84}},"":{code:35,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9}},"":{code:62,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":24,"":26,"":29,"":30}},"":{code:44,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":12,"":13,"":14,"":15,"":16,"":17,"":18,"":19,"":20,"":51,"":52,"":53}},"":{code:45,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":12,"":13,"":14}},"":{code:52,city:{"":1,"":2,"":3,"":4,"":22,"":23,"":24,"":26,"":27}},"":{code:46,city:{"":1,"":2,"":90}},"":{code:13,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11}},"":{code:23,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":12,"":27}},"":{code:41,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":12,"":13,"":14,"":15,"":16,"":17}},"":{code:42,city:{"":1,"":2,"":3,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":12,"":13,"":28}},"":{code:43,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":12,"":13,"":31}},"":{code:15,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":22,"":25,"":26,"":28,"":29}},"":{code:32,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":12,"":13}},"":{code:36,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11}},"":{code:22,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":24}},"":{code:21,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":12,"":13,"":14}},"":{code:64,city:{"":1,"":2,"":3,"":4,"":5}},"":{code:63,city:{"":1,"":21,"":22,"":23,"":25,"":26,"":27,"":28}},"":{code:14,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":23}},"":{code:37,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":12,"":13,"":14,"":15,"":16,"":17}},"":{code:31,city:{"":1,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":12,"":13,"":14,"":15,"":16,"":17,"":18,"":19,"":20,"":30}},"":{code:51,city:{"":1,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":13,"":14,"":15,"":16,"":17,"":18,"":19,"":20,"":32,"":33,"":34}},"":{code:12,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":12,"":13,"":14,"":15,"":21,"":23,"":25}},"":{code:54,city:{"":1,"":21,"":22,"":23,"":24,"":25,"":26}},"":{code:65,city:{"":1,"":2,"":21,"":22,"":23,"":27,"":28,"":29,"":30,"":31,"":32,"":40,"":42,"":43,"":44}},"":{code:53,city:{"":1,"":3,"":4,"":5,"":6,"":23,"":25,"":26,"":27,"":28,"":29,"":31,"":32,"":33,"":34,"":35}},"":{code:33,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11}},"":{code:61,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10}},"":{code:71,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":90}},"":{code:81,city:{"":1}},"":{code:82,city:{"":1}},"":{code:400,city:{"":1,"":2,"":3,"":4,"":5,"":6,"":7,"":8,"":9,"":10,"":11,"":12,"":13,"":14,"":15,"":16}},"":{code:100,city:{"":1000}}};return a});STK.register("common.search.regionSelect",function(b){var a=b.common.search.cityList;return function(c){var m,n,q,o,p,j,d,h,g;m=c.provDom;n=c.cityDom||null;q=c.provCode||0;o=c.cityCode||0;if(typeof m=="undefined"){throw"Lack of provDom -> path : common.search.regionSelect"}m.options.length=0;p=m.options;for(var f in a){p[p.length]=new Option(f,a[f]["code"]);if(a[f]["code"]==q){j=true}}if(j){m.value=q}else{m.value=0}var e=function(s,t){o=t?t:o;h=a[s]["city"];n.options.length=0;g=n.options;g[0]=new Option("",1000);for(var r in h){g[g.length]=new Option(r,h[r]);if(h[r]==o){d=true}}if(d){n.value=o}else{if(q!=0){n.value=1000}else{n.value=0}}};if(n){b.core.evt.addEvent(m,"change",function(){e(m.options[m.selectedIndex].text,1000)});e(m.options[m.selectedIndex].text)}}});STK.register("common.search.template.calendar",function(b){var a='<#et userlist data><div class="selector"><select action-type="month" class="month"><option value="0" ${data.showDate.month==0?\'selected=""\':\'\'}>#L{}</option><option value="1" ${data.showDate.month==1?\'selected=""\':\'\'}>#L{}</option><option value="2" ${data.showDate.month==2?\'selected=""\':\'\'}>#L{}</option><option value="3" ${data.showDate.month==3?\'selected=""\':\'\'}>#L{}</option><option value="4" ${data.showDate.month==4?\'selected=""\':\'\'}>#L{}</option><option value="5" ${data.showDate.month==5?\'selected=""\':\'\'}>#L{}</option><option value="6" ${data.showDate.month==6?\'selected=""\':\'\'}>#L{}</option><option value="7" ${data.showDate.month==7?\'selected=""\':\'\'}>#L{}</option><option value="8" ${data.showDate.month==8?\'selected=""\':\'\'}>#L{}</option><option value="9" ${data.showDate.month==9?\'selected=""\':\'\'}>#L{}</option><option value="10" ${data.showDate.month==10?\'selected=""\':\'\'}>#L{}</option><option value="11" ${data.showDate.month==11?\'selected=""\':\'\'}>#L{}</option></select><select action-type="year" class="year"><#list data.years as year><option value="${year}"${(data.showDate.year==year)?\' selected=""\':""}>${year}</option></#list></select></div><ul class="weeks"><li>#L{}</li><li>#L{}</li><li>#L{}</li><li>#L{}</li><li>#L{}</li><li>#L{}</li><li>#L{}</li></ul><ul class="days"><#list data.dates as list><li><#if (list!="")><#if ((data.start.year<data.showDate.year&&data.showDate.year<data.end.year)||(data.start.year==data.showDate.year&&data.showDate.year<data.end.year&&data.start.month<data.showDate.month)||(data.start.year==data.showDate.year&&data.showDate.year<data.end.year&&data.start.month==data.showDate.month&&data.start.date<=list&&list<=data.start.max)||(data.start.year<data.showDate.year&&data.showDate.year==data.end.year&&data.showDate.month<data.end.month)||(data.start.year<data.showDate.year&&data.showDate.year==data.end.year&&data.showDate.month==data.end.month&&list<=data.end.date)||(data.start.year==data.showDate.year&&data.showDate.year==data.end.year&&data.start.month<data.showDate.month&&data.showDate.month<data.end.month)||(data.start.year==data.showDate.year&&data.showDate.year==data.end.year&&data.start.month<data.showDate.month&&data.showDate.month==data.end.month&&list<=data.end.date)||(data.start.year==data.showDate.year&&data.showDate.year==data.end.year&&data.start.month==data.showDate.month&&data.start.date<=list&&list<=data.start.max&&data.showDate.month<data.end.month)||(data.start.year==data.showDate.year&&data.showDate.year==data.end.year&&data.start.month==data.showDate.month&&data.start.date<=list&&list<=data.start.max&&data.showDate.month==data.end.month&&list<=data.end.date))><a action-type="date" href="#date" onclick="return false;" title="${data.showDate.year}-${data.showDate.month+1}-${list}"year="${data.showDate.year}" month="${data.showDate.month+1}" day="${list}"${(data.today.year==data.showDate.year&&data.today.month==data.showDate.month&&list==data.showDate.date)?\' class="day"\':\'\'}><strong>${list}</strong></a><#else>${list}</#if></#if></li></#list></ul>';return a});STK.register("common.search.calendar",function(d){var c;function a(){c.node.style.display="none";d.core.evt.removeEvent(document,"click",a);d.custEvent.fire(c,"close")}function b(){d.core.evt.stopEvent()}function e(){var g=arguments;this.today=this.getDefaultDate.apply(this,g);this.showDate={};for(var f in this.today){this.showDate[f]=this.today[f]}this.getKeyPoint.apply(this,g);this.getCurrentMonthInfo();d.custEvent.define(this,"close");d.custEvent.define(this,"show")}e.prototype={data:{},defaultStartDate:new Date(2009,7,16,0,0,0,0),solarMonth:[31,28,31,30,31,30,31,31,30,31,30,31],maxMonthDay:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],solarDays:function(g,f){if(f==1){return(((g%4==0)&&(g%100!=0)||(g%400==0))?29:28)}else{return(this.solarMonth[f])}},getDefaultDate:function(){var h=arguments;var n;var m;var o;var g;var j=/^(\d{4})[-\/](\d{1,2})[-\/](\d{1,2})$/;var p;var f;if(h.length==0){n=new Date()}else{if(j.test(h[0])){n=h[0].match(j);m=n[1]*1;o=n[2]*1-1;g=n[3]*1;n=new Date(m,o,g,0,0,0,0)}else{if(h[0].constructor==Date){n=h[0]}else{if(h.length==3){n=new Date(h[0],h[1],h[2],0,0,0,0)}else{if(h[0]!=""&&typeof h[0]=="string"){n=new Date(h[0])}else{n=new Date()}}}}}f={year:n.getFullYear(),month:n.getMonth(),date:n.getDate()};p=this.solarDays(f.year,f.month);f.max=p;return f},getKeyPoint:function(){var f=arguments;var h=f.length;var g;if(h>1){g=f[h-1];this.start=(g.start!=null)?g.start:this.defaultStartDate;this.end=(g.end!=null)?g.end:new Date();this.callback=g.callback;this.source=g.source;if(typeof this.start=="string"&&d.core.util.browser.IE6){this.start=this.start.replace("-","/")}this.defaultStartDate=new Date(this.start)}else{this.start=this.defaultStartDate;this.end=new Date()}this.start=this.getDefaultDate.call(this,this.start);this.end=this.getDefaultDate.call(this,this.end)},getCurrentMonthInfo:function(){var r=this.showDate;var q=r.year;var p=r.month;var h=r.date;var f=new Date(q,p,1,0,0,0,0);this.count=this.solarDays(q,p);this.firstWeek=f.getDay();var m=d.core.arr.copy(this.maxMonthDay);var t=(this.firstWeek==0)?[]:new Array(this.firstWeek).join().split(",");t=t.concat(m.splice(0,this.count));var g=($CONFIG!=null&&$CONFIG.timeDiff!=null)?$CONFIG.timeDiff:0;var n=[];var o=this.defaultStartDate.getFullYear();var u=new Date(new Date(this.end.year,this.end.month,this.end.date).getTime()-g).getFullYear();var s=u-o;var j=0;while(j<=s){n.push(o+j);j++}this.data={today:this.today,showDate:this.showDate,start:this.start,end:this.end,dates:t,years:n};this.showUI()},showUI:function(){var g=d.core;var j;var m;var h;var f;var n=this.getContainer();var o;if(this.source!=null){o=d.core.dom.position(this.source);o.t+=this.source.clientHeight}if(n==null){j=d.common.search.template.calendar;j='<div node-type="calendar" class="pc_caldr" style="top:'+o.t+"px;left:"+o.l+'px;z-index:10005">'+j+"</div>";m=g.util.easyTemplate(j);h=m(this.data).toString();h=d.kit.extra.language(h);f=g.dom.builder(h);document.body.appendChild(f.box);n=this.getContainer();c=this;this.delegate(n);d.core.evt.addEvent(document,"click",a)}else{j=d.common.search.template.calendar;m=g.util.easyTemplate(j);h=m(this.data).toString();h=d.kit.extra.language(h);n.innerHTML=h;n.style.cssText="display:block; top:"+o.t+"px;left:"+o.l+"px;z-index:10005";if(n.style.display=="block"){d.core.evt.addEvent(document,"click",a)}c=this}this.node=n;d.custEvent.fire(c,"show");d.core.evt.stopEvent()},getContainer:function(){var f=d.core.dom.sizzle('[node-type="calendar"]',document.body);f=(f.length>0)?f[0]:null;return f},setYear:function(f){this.showDate.year=f;this.getCurrentMonthInfo();this.showUI()},setMonth:function(f){this.showDate.month=f*1;this.getCurrentMonthInfo();this.showUI()},setDate:function(f){f=f.replace(/(\d+)/g,function(h,g){return(g.length==1)?"0"+g:g});this.source.value=f;a();if(this.callback&&typeof this.callback=="function"){this.callback(f)}},delegate:function(g){var f=d.core.evt.delegatedEvent(g);f.add("month","change",function(h){var j=h.el.value;if(j!=c.showDate.month){c.setMonth(h.el.value)}});f.add("month","click",function(h){var j=h.el.value;if(j!=c.showDate.month){c.setMonth(h.el.value)}});f.add("year","change",function(h){var j=h.el.value;if(j!=c.showDate.year){c.setYear(j)}});f.add("year","click",function(h){var j=h.el.value;if(j!=c.showDate.year){c.setYear(j)}});f.add("date","click",function(h){c.setDate(h.el.title)});d.core.evt.addEvent(g,"click",b)}};return e});STK.register("common.form.suggestInput",function(g){var f,r,c={},a,p,h,s,v,d,e,u,j,m,o,b={},t,q={},n;return function(B,A){B=g.E(B);if(!B){throw"common.form.suggestInput : need el as a param"}var C='<#et tip data><ul><#list data as list><li action-type="suggestList"><a href="javascript:;" style="padding:5px 0; white-space:normal;"><span style="margin:0 5px;display:block;overflow:hidden;height:14px;">${list}</span></a></li></#list></ul></#et>';var D="T_"+g.core.util.getUniqueKey();f={url:"/ajax/suggestion",template:C,left:0,top:0,width:0,focusback:g.core.func.empty,clickback:g.core.func.empty,blurback:g.core.func.empty,css:"",className:"s_suggest_box",focusclass:"current",args:{},key:"key",defaultText:"",nameSelector:null,dataBack:g.core.func.empty,offset:{top:0,left:0}};r=function(F,E){var G;for(G in E){F[G]=E[G]}return F};q[D]=r(f,A);j=g.core.evt.addEvent;m=g.core.evt.removeEvent;var z={listOver:function(F){h=0;var E=F.el;clearTimeout(a);if(e){g.core.dom.removeClassName(e,q[D].focusclass)}e=E;a=setTimeout(function(){g.core.dom.addClassName(E,q[D].focusclass)},20)},listOut:function(F){var E=F.el;clearTimeout(p);p=setTimeout(function(){g.core.dom.removeClassName(E,q[D].focusclass)},10)},clickItem:function(F){var E=F.el;q[D].clickback({el:E})},hotKey:function(F){var G=F||window.event;var E=G.keyCode;if(!h){h=0}switch(E){case 38:z.upKey();break;case 40:z.downKey();break;case 13:z.enterKey();default:break}},downKey:function(){if(h>0){g.core.dom.removeClassName(s[h-1],q[D].focusclass)}h++;if(h>=s.length+1){h=0;B.value=u}if(h>0){var G=s[h-1],F,E=q[D].nameSelector;g.core.dom.addClassName(G,q[D].focusclass);if(q[D].nameSelector){F=g.sizzle(E,G)[0].innerHTML.replace(/<[^>]+>/g,"")}else{F=b[t+"_"+D].data[h-1]}B.value=F;e=G}},upKey:function(){if(h>0){g.core.dom.removeClassName(s[h-1],q[D].focusclass)}h--;if(h<0){h=s.length}if(h>0){var G=s[h-1],F,E=q[D].nameSelector;g.core.dom.addClassName(G,q[D].focusclass);if(q[D].nameSelector){F=g.sizzle(E,G)[0].innerHTML.replace(/<[^>]+>/g,"")}else{F=b[t+"_"+D].data[h-1]}B.value=F;e=s[h-1]}else{if(h<=0){B.value=u}}},enterKey:function(){if(h-1<0){return}var E=s[h-1];q[D].clickback({el:E})},faceInit:function(E){q[D].dataBack(E);if(E.data.length==0){x.hide();return}tipHTML=g.core.util.easyTemplate(q[D].template,E.data);if(!c[D]){c[D]=g.C("DIV");document.body.appendChild(c[D]);c[D].className=q[D].className;var F=g.core.evt.delegatedEvent(c[D]);F.add("suggestList","mouseover",z.listOver);F.add("suggestList","mouseout",z.listOut);F.add("suggestList","click",z.clickItem);s=[]}c[D].style.cssText="left:"+((q[D].left?q[D].left:g.core.dom.position(B).l)+(q[D].offset.left||0))+"px;top:"+((q[D].top?q[D].top:g.core.dom.position(B).t+B.offsetHeight)+(q[D].offset.top||0))+"px;width:"+((q[D].width?q[D].width:B.offsetWidth)-4)+"px;position:absolute;"+q[D].css;c[D].innerHTML=tipHTML;n=g.common.dialog.masterIframe.create(c[D]);s=g.core.dom.sizzle('[action-type="suggestList"]',c[D]);h=0}};var w=function(){t=encodeURIComponent(B.value);if(typeof b[t+"_"+D]!="undefined"){z.faceInit(b[t+"_"+D])}else{q[D].args[q[D].key]=t;g.core.io.ajax({url:q[D].url,args:q[D].args,method:"get",responseType:"json",onComplete:function(E){if(E.code=="100000"){b[t+"_"+D]=E;z.faceInit(E)}}})}};var y=function(){if(o){clearTimeout(o)}o=setTimeout(w,200)};var x={};x.hide=function(){if(c[D]){c[D].style.display="none";h=0;s=[];m(document.body,"click");m(B,"click");n.destroy()}};x.show=function(){if(g.core.str.bLength(g.core.str.trim(B.value))==0){x.hide();return}y();u=B.value;j(document.body,"click",x.hide)};g.core.evt.addEvent(window,"resize",function(){if(c[D]&&c[D].style.display!="none"){c[D].style.cssText="left:"+(g.core.dom.position(B).l+q[D].offset.left+1)+"px;top:"+(g.core.dom.position(B).t+B.offsetHeight+q[D].offset.top-1)+"px;width:"+(q[D].width?q[D].width:B.offsetWidth)+"px;position:absolute;"+q[D].css}});g.common.form.valueChange(B,{callback:x.show,delay:100});g.addEvent(B,"focus",function(){if(B.value==q[D].defaultText){B.value=""}});g.addEvent(B,"blur",function(){if(g.bLength(g.trim(B.value))==0){B.value=q[D].defaultText}window.setTimeout(function(){x.hide()},200)});j(B,"keydown",z.hotKey);j(B,"click",function(){g.core.evt.stopEvent()});return x}});STK.register("common.dialog.advSearch",function(j){var c=j.kit.extra.language;var p=j.core.dom.sizzle;var e=false;var d,m;var q=c("#L{}");var f=20;var b=$CONFIG.pageid;var o='<div class="search_adv_detail form_table clearfix" node-type="outer"><div node-type="inner" class="adv_form"></div><div class="adv_btn"><dl class="p_btn clearfix"><dt>&nbsp;</dt><dd><a href="javascript:void(0);" class="W_btn_cb" node-type="OK" suda-data="key=tblog_search_'+b+"&value="+b+'_profes_OK"><span>#L{'+(b==="user"?"":"")+'}</span></a><a href="javascript:void(0);" class="cancelbtn" node-type="cancel" suda-data="key=tblog_search_'+b+"&value="+b+'_profes_cancel">#L{}</a></dd></dl></div></div>';var a=null;var n=function(s,r,t){s.getDom("inner").innerHTML=r.innerStr};var g=function(t,s){for(var r in t){if(!t[r]){delete t[r]}else{if(t[r]==s[r]){delete t[r]}}}return t};var h=function(t){var s=["timescope","region"];for(var r in t){if(!j.inArray(r,s)){t[r]=encodeURIComponent(encodeURIComponent(t[r]))}}return t};return function(s){var t,u,w,x,r;t=j.parseParam({title:c("#L{}"),OK:j.funcEmpty,cancel:j.funcEmpty,timeout:0,innerStr:"",defaultConfig:{}},s);u={};if(!a){a=j.kit.extra.reuse(function(){var z=j.module.layer(c(o));return z})}w=a.getOne();x=j.ui.dialog();x.setContent(w.getOuter());x.setTitle(t.title);n(w,t,x);var y=function(){var A={};var C=[];var z=j.builder(w.getDom("inner")).list,D;j.foreach(z,function(E){if(D=E[0]){A[D.getAttribute("node-type")]=D;if(D.getAttribute("suggest")){C.push(D)}}});if(A.prov&&A.city){j.common.search.regionSelect({provDom:A.prov,cityDom:A.city?A.city:null,provCode:A.prov.getAttribute("truevalue"),cityCode:A.city?A.city.getAttribute("truevalue"):0})}var B={url:"/ajax/suggestion",clickback:function(){},focusclass:"cur",className:"layer_menu_list",css:"z-index:10002"};j.foreach(C,function(F,G){B.url="/ajax/suggestion?where="+F.name;var E=j.common.form.suggestInput(F,j.parseParam(B,{clickback:function(H){F.value=H.el.getElementsByTagName("A")[0].getElementsByTagName("SPAN")[0].innerHTML;setTimeout(function(){E.hide()},100)}}))})};var v=function(){var G,I;var E=j.sizzle('input[type="checkbox"]',w.getDom("inner"));var K=j.core.util.htmlToJson(w.getDom("inner"));var D=g(K,t.defaultConfig);G=K.keyword?encodeURIComponent(encodeURIComponent(K.keyword)):$CONFIG.s_search;delete K.keyword;if($CONFIG.pageid=="user"){var F=true;for(var C in K){if(K[C]){if(C=="auth"){continue}else{if(C=="gender"){continue}else{if(C=="prov"&&K[C]==0){continue}else{if(C=="city"&&K[C]==0){continue}else{if(C=="age"){continue}}}}}F=false;break}}if(F){j.ui.alert(c("#L{}"),{OK:function(){x.getOuter().style.display=""}});if(j.core.util.browser.IE6){x.getOuter().style.display="none"}return false}}if(K.prov&&K.prov!=0){K.region="custom:"+K.prov+":"+K.city;delete K.prov;delete K.city}if(K.prov==0){delete K.prov;delete K.city}if(K.xsort=="live"){delete K.xsort}if(K.auth=="all"){delete K.auth}if(K.age=="all"){delete K.age}if(K.type){if(K.type=="hot"){K.xsort="hot"}else{if(K.type=="ori"){K.scope="ori"}else{if(K.type=="category_4"){K.category="4"}else{if(K.type=="category_5"){K.category="5"}else{K[K.type]=1}}}}delete K.type}if(K.sub){K[K.sub]=1;delete K.sub}if(K.userscope){if(K.userscope.length>=f){K.userscope=K.userscope.substr(0,f)}K.userscope="custom:"+K.userscope}if(K.stime||K.etime){K.stime=K.stime?K.stime:"";K.stime=K.stime==q?"":K.stime;K.etime=K.etime?K.etime:"";K.etime=K.etime==q?"":K.etime;if(K.stime||K.etime){K.timescope="custom:"+(K.stime?K.stime:"")+":"+(K.etime?K.etime:"");d=K.stime;m=K.etime}delete K.stime;delete K.etime}if(K.startHour||K.endHour){d+=K.startHour?"-"+K.startHour:"";m+=K.endHour?"-"+K.endHour:"";delete K.startHour;delete K.endHour;K.timescope="custom:"+d+":"+m}if(K.tag||K.school||K.work||K.nickname){G=""}if(K.nickname){if(K.nickname.length>=f){K.nickname=K.nickname.substr(0,f)}}var J=j.core.json.jsonToQuery(h(K));if(J){J="&"+J}var B=location.href;$CONFIG.pageid=="user"?G="":G=G;if(window.location.href.indexOf("/weibo/")>-1||window.location.href.indexOf("user")>-1||window.location.href.indexOf("/wb/")>-1){var z=B.substr(0,B.lastIndexOf("/")+1)+G+J+"&Refer=g"}else{var A=j.sizzle("[node-type=work]")[0];if(!A){if(!!G==false){j.ui.alert(c("#L{}"),{OK:function(){x.getOuter().style.display=""}});if(j.core.util.browser.IE6){x.getOuter().style.display="none"}return}z=B.substr(0,B.lastIndexOf("/")+1)+"weibo/"+G+J+"&Refer=g"}else{if(A){G="";if(!K.nickname&&!K.tag&&!K.school&&!K.work&&!K.region&&!K.age){j.ui.alert(c("#L{}"),{OK:function(){x.getOuter().style.display=""}});if(j.core.util.browser.IE6){x.getOuter().style.display="none"}return}z=B.substr(0,B.lastIndexOf("/")+1)+"user/"+G+J+"&Refer=g"}}}var H=z.replace(/(top\/|list\/)/,"");setTimeout(function(){window.location.href=H},0);x.hide()};if(!e){e=true;j.addEvent(w.getDom("OK"),"click",v)}j.addEvent(w.getDom("cancel"),"click",x.hide);j.custEvent.add(x,"hide",function(){j.custEvent.remove(x,"hide",arguments.callee);j.removeEvent(w.getDom("OK"),"click",x.hide);a.setUnused(w);clearTimeout(r);t.OK()});if(t.timeout){r=setTimeout(x.hide,t.timeout)}x.show().setMiddle();y();u.alt=w;u.dia=x;return u}});STK.register("common.search.parseSearchParam",function(b){var a=window.location.href;return function(){var f;var c,h;var n=a.substr(a.indexOf("&")+1);var m="nickname=";var d=a.indexOf(m);var g;var j=a.indexOf("Refer");var e=b.queryToJson(n);if(e.region){f=e.region.split(":");e.prov=f[1];e.city=f[2];delete e.region}if(e.timescope){if(e.timescope.indexOf("%3A")>-1){e.timescope=e.timescope.replace(/%3A/g,":")}f=e.timescope.split(":");if(f[1]){c=f[1].split("-");e.stime=c[0]+"-"+c[1]+"-"+c[2];if(c[3]){e.startHour=c[3]}}if(f[2]){h=f[2].split("-");e.etime=h[0]+"-"+h[1]+"-"+h[2];if(h[3]){e.endHour=h[3]}}delete e.timescope}if(e.userscope){e.userscope=e.userscope.replace(/custom%253A|custom%3A|custom:/,"")}if(d>-1){g=decodeURIComponent(decodeURIComponent(a.substring(d+m.length)))}else{if(j>-1){g=decodeURIComponent(decodeURIComponent(a.substring(a.indexOf("user/")+5,a.indexOf("&"))))}else{g=""}}e.nickName=g;return e}});STK.register("common.extra.shine",function(b){var a=function(c){return c.slice(0,c.length-1).concat(c.concat([]).reverse())};return function(e,s){var p=b.parseParam({start:"#fff",color:"#fbb",times:2,step:5},s);var f=p.start.split("");var c=p.color.split("");var h=[];for(var o=0;o<p.step;o+=1){var q=f[0];for(var m=1;m<4;m+=1){var n=parseInt(f[m],16);var g=parseInt(c[m],16);q+=Math.floor(parseInt(n+(g-n)*o/p.step,10)).toString(16)}h.push(q)}for(var o=0;o<p.times;o+=1){h=a(h)}var r=false;var d=b.timer.add(function(){if(!h.length){b.timer.remove(d);return}if(r){r=false;return}else{r=true}e.style.backgroundColor=h.pop()})}});STK.register("comp.common.getConfig",function(b){return{s_search:function(e){var d="",c=[];if(!e){return d}d=decodeURIComponent(e);if(d.indexOf("+")>-1){d=d.split("+");b.core.arr.foreach(d,function(f,g){c.push(decodeURIComponent(f))});d=c.join(" ")}else{d=decodeURIComponent(decodeURIComponent(e))}return d},htmlspecialchars:function a(c){c=c.replace(/&/g,"&amp;");c=c.replace(/</g,"&lt;");c=c.replace(/>/g,"&gt;");c=c.replace(/"/g,"&quot;");c=c.replace(/'/g,"&#039;");return c}}});STK.register("comp.filter.advSearch",function(a){return function(y,s){var I=a.kit.extra.language;var o={};var x=[],m,F,e,B,t="",q=I("#L{}"),u,h,j,v,H;var z={typeall:"",suball:"",xsort:"",vip:"",atten:"",haspic:"",hasvideo:"",userscope:"",scope:"",stime:"",etime:"",prov:0,city:0,hasvideo:0,hasmusic:0,haslink:0,startHour:"",endHour:"",category:""};var E=I('<#et weibo data><dl class="adv_input adv_keywords clearfix"><dt>#L{}</dt><dd class="conbox"><input type="text" value="#myValue#" class="W_inputStp" name="keyword"/></dd></dl><dl class="search_adv_rank clearfix"><dt>#L{}</dt><dd class="conbox"><span class="radwrp"><input class="W_radio" name="type" type="radio" checked ${data.typeall == 1 ? ("checked=checked"): ""} value="typeall" id="radio01" /><label for="radio01" class="labw">#L{}</label></span><span class="radwrp"><input class="W_radio" name="type" type="radio" ${data.xsort ==  "hot"? ("checked=checked"): ""} value="hot" id="radio02" /><label for="radio02" class="labw">#L{}</label></span><span class="radwrp"><input class="W_radio" name="type" type="radio" ${data.scope == "ori" ? ("checked=checked"): ""} value="ori" id="radio03" /><label for="radio03" class="labw">#L{}</label></span><span class="radwrp"><input class="W_radio" name="type" type="radio" ${data.atten == 1 ? ("checked=checked"): ""} value="atten" id="radio04" /><label for="radio04" class="labw">#L{}</label></span><span class="radwrp"><input class="W_radio" name="type" type="radio" ${data.vip == 1 ? ("checked=checked"): ""} value="vip" id="radio05" /><label for="radio05" class="labw">#L{}</label></span><span class="radwrp"><input class="W_radio" name="type" type="radio" ${data.category == 4 ? ("checked=checked"): ""} value="category_4" id="radio07" /><label for="radio07" class="labw">#L{}</label></span></dd></dl><dl class="search_adv_sorts clearfix"><dt>#L{}</dt><dd class="conbox"><span class="chewrp"><input class="W_checkbox" name="sub" type="radio" checked ${data.suball == 1 ? ("checked=checked"): ""} value="suball" id="radio_sub1" /><label for="radio_sub1" class="labwc">#L{}</label></span><span class="chewrp"><input class="W_checkbox" name="sub" type="radio" ${data.haspic == 1 ? ("checked=checked"): ""} value="haspic" id="radio_sub2" /><label for="radio_sub2" class="labwc">#L{}</label></span><span class="chewrp"><input class="W_checkbox" name="sub" type="radio" ${data.hasvideo == 1 ? ("checked=checked"): ""} value="hasvideo" id="radio_sub3" /><label for="radio_sub3" class="labwc">#L{}</label></span><span class="chewrp"><input class="W_checkbox" name="sub" type="radio" ${data.hasmusic == 1 ? ("checked=checked"): ""} value="hasmusic" id="radio_sub4" /><label for="radio_sub4" class="labwc">#L{}</label></span><span class="chewrp"><input class="W_checkbox" name="sub" type="radio" ${data.haslink == 1 ? ("checked=checked"): ""} value="haslink" id="radio_sub5" /><label for="radio_sub5" class="labwc">#L{}</label></span></dd></dl><dl class="adv_time clearfix"><dt>#L{}</dt><dd class="conbox"><input type="text" readonly="true" value="${data.stime}"  class="W_inputStp" style="color:#b5b5b5;" node-type="stime" name="stime" action-type="time" />'+($CONFIG.lang!="en-us"?'<select class="select2" isFirst=1 name="startHour" action-type="selectHour" node-type="startHour"><option value="">#L{}</option></select>':"")+'<i class="chotxt2">#L{}</i><input type="text" readonly="true" value="${data.etime}"  action-type="time" name="etime" node-type="etime" class="W_inputStp" style="color:#b5b5b5;" />'+($CONFIG.lang!="en-us"?'<select class="select2" isFirst=1 name="endHour" action-type="selectHour" node-type="endHour"><option value="">#L{}</option></select></dd>':"")+"</dl>"+($CONFIG.lang!="en-us"?'<dl class="search_adv_dir clearfix"><dt>#L{}</dt><dd class="conbox"><select class="select2" name="prov" node-type="prov" truevalue="${data.prov}"><option></option></select><select class="select2" name="city" node-type="city" truevalue="${data.city}"><option></option></select></dd></dl>':"")+"</#et>");var f={};var c={adv_search:function(){var J=a.comp.common.getConfig;var L=J.htmlspecialchars(J.s_search($CONFIG.s_search));F=a.common.dialog.advSearch({innerStr:a.core.util.easyTemplate(E,m).toString().replace("#myValue#",L),defaultConfig:{},title:"",OK:function(N){}});if(a.core.util.browser.IE6){a.custEvent.add(F.dia,"hide",function(){a.core.evt.fireEvent(document.body,"click")})}if(!e){e=true;B=a.sizzle('[node-type="attentDD"]',F.dia.getInner())[0];var M=a.delegatedEvent(F.dia.getInner());M.add("byTime","click",c.byTime);M.add("byHot","click",c.byHot);M.add("bySocail","click",c.bySocail);M.add("selectHour","click",c.selectHour);M.add("time","click",c.show_date)}u=a.sizzle('[node-type="startHour"]',F.dia.getInner())[0];h=a.sizzle('[node-type="endHour"]',F.dia.getInner())[0];j=a.sizzle('[node-type="stime"]',F.dia.getInner())[0];v=a.sizzle('[node-type="etime"]',F.dia.getInner())[0];if(u){for(var K=0;K<24;K++){u[K+1]=new Option(K+I("#L{}"),K);h[K+1]=new Option(K+I("#L{}"),K)}if(m.startHour){u.options[parseInt(m.startHour)+1].selected=true}if(m.endHour){h.options[parseInt(m.endHour)+1].selected=true}if(!m.stime||m.stime==q){u.disabled=true}if(!m.etime||m.etime==q){h.disabled=true}}},bySocail:function(){B.style.display="";B.getElementsByTagName("INPUT")[0].checked=false},byHot:function(){B=a.sizzle('[node-type="attentDD"]',F.dia.getInner())[0];B.style.display="none";B.getElementsByTagName("INPUT")[0].checked=false},byTime:function(){B.style.display="";B.getElementsByTagName("INPUT")[0].checked=false},selectHour:function(J){var K=J.el;if(K.getAttribute("node-type")=="startHour"){if(!j.value){a.common.extra.shine(j)}}else{if(!v.value){a.common.extra.shine(v)}}},show_date:function(J){if(J.el.value==q){J.el.value=""}var K=new a.common.search.calendar(J.el.value,{source:J.el,callback:function(){if(J.el.value){if(u){J.el.getAttribute("node-type")=="stime"?u.disabled=false:h.disabled=false}}}})}};var C={};var r={};var A=function(){w();d();D();b();g();n();p()};var w=function(){if(!y){throw"[pl_advsearchWeibo] : missing  -> path : comp.filter.advsearchWeibo"}s=a.core.obj.parseParam({html:""},s)};var d=function(){var J=a.builder(y).list,K;a.foreach(J,function(L){if(K=L[0]){x[K.getAttribute("node-type")]=K}});if(!x){throw"Lack of necessary nodes  -> path : comp.filter.searchWeiboFilter"}};var D=function(){m=a.common.search.parseSearchParam();m=a.parseParam(z,m);m.stime?m.stime=m.stime:m.stime=q;m.etime?m.etime=m.etime:m.etime=q};var b=function(){};var g=function(){a.core.evt.addEvent(y,"click",c.adv_search)};var n=function(){};var p=function(){};var G=function(){a.core.evt.removeEvent(y,"click",c.adv_search)};A();o.destroy=G;o.eventHandler=c.adv_search;return o}});STK.register("common.layer.region",function(e){var d="hidden";var a,f,g,n;var b=e.kit.extra.language;var h='<#list data as list><#if (list_index == 0)><#if (list.type=="city")><dd><a action-type="allRegion" action-data="prov=${list.provCode}&region=${list.prov}" sort="${list.type}" href="javascript:void(0);"><strong></strong></a></dd><#else><dd><a action-type="allRegion" action-data="prov=none" sort="${list.type}" href="javascript:void(0);"><strong></strong></a></dd></#if></#if><dd><a class="${list.checked}" action-type="${list.type}" action-data="code=${list.code}&region=${list.region}&prov=${list.provCode}&city=${list.cityCode}" href="javascript:void(0);">${list.name}</a></dd></#list>';var m='<#et region data><div node-type="outer" style="position: absolute; width: 270px;z-index:2000" class="search_district clearfix"><div node-type="head" class="more_title1 clearfix"><p node-type="curRegion" class="dis_state">#L{}</p><p class="dis_chose"><span class="reg_dis"><#if ($CONFIG.islogin && $CONFIG.islogin == "1")>#L{}</#if><a action-type="myRegion" node-type="myRegion" href="javascript:void(0);"></a><span node-type="splitFlag">-</span><a action-type="myCity" node-type="myCity" href="javascript:void(0);"></a></span><a href="javascript:;" action-type="close" class="close_btn"></a></p></div><dl node-type="inner" class="more_detail">'+h+"</dl></div></#et>";var j="<#et region data>"+h+"</#et>";var c=e.common.search.cityList;return function(B){var x,o,u,t,D,y,s,w;o=true;var q=function(){if(o!==false){u.hide()}};x=e.parseParam({t:null,l:null,prov:"",city:"",curRegion:null,myRegion:null,myCity:null,callback:e.core.func.empty},B);var A=function(F){F=F||null;var E=[];for(var G in c){if(G!="/"){E.push({name:G,code:c.code,checked:G==F?"current":"",type:"prov",region:G,provCode:c.code,cityCode:"",hasArea:F?F:""})}}return E};var r=function(H,G){G=G||null;var E=[];for(var F in c[H]["city"]){E.push({name:F,prov:H,code:c[H]["code"]+"_"+c[H]["city"][F],checked:F==G?"current":"",type:"city",region:H+"_"+F,provCode:c[H]["code"],cityCode:c[H]["city"][F],hasArea:G?G:""})}return E};var p=function(H){var E=[];var G=H.type||"prov";var F=H.checked||null;if(G=="city"){if(!H.prov){throw"you must set prov   common.layer.region"}E=r(H.prov,F)}else{E=A(F)}return E};var C=function(){a=e.core.util.easyTemplate(b(m),p({type:x.city?"city":"prov",prov:x.prov,checked:x.city?x.city:x.prov})).toString();u=e.module.layer(a);f=u.getOuter();g=u.getDom("head");t=u.getDom("curRegion");D=u.getDom("myRegion");y=u.getDom("myCity");s=u.getDom("splitFlag");content=u.getDom("inner");t.innerHTML=B.type=="prov"?b("#L{}"):('<a href="javascript:void(0);" action-type="modify" action-data="region='+B.prov+'"></a><em class="space">&gt;</em>'+B.prov);D.innerHTML=x.myRegion?x.myRegion:"";if(x.myCity){y.innerHTML=x.myCity;s.style.display=""}else{y.innerHTML="";s.style.display="none"}e.custEvent.add(u,"show",function(){e.hotKey.add(document.documentElement,["esc"],q,{type:"keyup",disableInInput:true})});e.custEvent.add(u,"hide",function(){e.hotKey.remove(document.documentElement,["esc"],q,{type:"keyup"});o=true});var E=e.delegatedEvent(u.getOuter());e.addEvent(u.getOuter(),"click",function(){e.stopEvent()});E.add("allRegion","click",function(F){F.el.className="current";x.callback({type:"all",sort:F.el.getAttribute("sort"),prov_code:F.data.prov,data:F.data})});E.add("myRegion","click",function(F){x.callback({type:"myRegion"})});E.add("myCity","click",function(F){x.callback({type:"myCity"})});E.add("prov","click",function(F){v.setRegion({prov:F.data.region,type:"city"})});E.add("city","click",function(F){x.callback(F.data)});E.add("modify","click",function(F){v.setRegion({prov:F.data.region,type:"prov",checked:F.data.region})});E.add("close","click",function(F){z()})};C();sup=e.objSup(u,["show","hide"]);diaHide=function(E){if(typeof beforeHideFn==="function"&&!E){if(beforeHideFn()===false){return false}}sup.hide();if(e.contains(document.body,u.getOuter())){document.body.removeChild(u.getOuter());e.removeEvent(document.body,"click",v.hide)}return v};var v=u;v.show=function(){if(d=="hidden"){if(!e.contains(document.body,u.getOuter())){document.body.appendChild(u.getOuter());u.getOuter().style.display=""}d="show";setTimeout(function(){e.addEvent(document.body,"click",z)},0);w=e.common.dialog.masterIframe.create(u.getOuter())}else{u.getOuter().style.display="none";z()}};var z=function(){diaHide();d="hidden";e.core.evt.removeEvent(document.body,"click",z);w.destroy()};v.hide=z;v.unsupportEsc=function(){o=false};v.supportEsc=function(){o=true};v.setPosition=function(E){f.style.top=E.t+"px";f.style.left=E.l+"px";return v};v.setContent=function(E){if(typeof E==="string"){content.innerHTML=E}else{content.appendChild(E)}return v};v.clearContent=function(){while(content.children.length){e.removeNode(content.children[0])}return v};v.setRegion=function(E){E=E||{};if(E.city==""){E.city=""}E.type=E.type||"prov";t=u.getDom("curRegion");t.innerHTML=E.type=="prov"?b("#L{}"):('<a href="javascript:void(0);" action-type="modify" action-data="region='+E.prov+'"></a><em class="space">&gt;</em>'+E.prov);n=e.core.util.easyTemplate(b(j),p({type:E.type,prov:E.prov,checked:E.type=="prov"?E.prov:E.city})).toString();v.setContent(n);return v};v.setMyRegion=function(E){D.innerHTML=E;return v};return v}});STK.register("comp.filter.advsearchUser",function(a){return function(t,p){var m={};var s=[];var d=false,h,q;var A=a.kit.extra.language;var u={nickname:"",tag:"",school:"",work:"",auth:"",prov:0,city:0,age:"all",gender:"all"};var y=A('<#et user data><dl class="adv_input clearfix"><dt>#L{}</dt><dd class="conbox"><input type="text" name="nickname" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.nickname)))}" class="W_inputStp" /></dd></dl><dl class="adv_input clearfix"><dt>#L{}</dt><dd class="conbox"><input node-type="tag" suggest="true" type="text" name="tag" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.tag)))}" class="W_inputStp" /></dd></dl><dl class="adv_input clearfix"><dt>#L{}</dt><dd class="conbox"><input node-type="school" suggest="true" type="text" name="school" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.school)))}" class="W_inputStp" /></dd></dl><dl class="adv_input clearfix"><dt>#L{}</dt><dd class="conbox"><input node-type="work" suggest="true" type="text" name="work" value="${STK.encodeHTML(decodeURIComponent(decodeURIComponent(data.work)))}" class="W_inputStp" / ></dd></dl><dl class="adv_user clearfix"><dt>#L{}</dt><dd class="conbox"><select hidefocus="true" class="select2" name="auth" node-type="auth" truevalue="${data.auth}"><option value="all" >#L{}</option><option ${data.auth == "org_vip" ? "selected" : ""} value="org_vip">#L{}</option><option ${data.auth == "per_vip" ? "selected" : ""} value="per_vip">#L{}</option><option ${data.auth == "ord" ? "selected" : ""} value="ord">#L{}</option></select></dd></dl>'+($CONFIG.lang!="en-us"?'<dl class="adv_add clearfix"><dt>#L{}</dt><dd class="conbox"><select hidefocus="true" class="select2" name="prov" node-type="prov" truevalue="${data.prov}"><option></option></select></dd><dd class="conbox"><select hidefocus="true" class="select2" name="city" node-type="city" truevalue="${data.city}"><option></option></select></dd></dl>':"")+'<dl class="adv_age clearfix"><dt>#L{}</dt><dd class="conbox"><select hidefocus="true" name="age" class="select2"><option value="all">#L{}</option><option ${data.age == "18y" ? "selected" : ""} value="18y">#L{18}</option><option ${data.age == "22y" ? "selected" : ""} value="22y">19~22#L{}</option><option ${data.age == "29y" ? "selected" : ""} value="29y">23~29#L{}</option><option ${data.age == "39y" ? "selected" : ""} value="39y">30~39#L{}</option><option ${data.age == "40y" ? "selected" : ""} value="40y">#L{40}</option></select></dd></dl><dl class="adv_sex clearfix"><dt>#L{}</dt><dd class="conbox"><select hidefocus="true" class="select2" name="gender" value="${data.gender}"><option value="">#L{}</option><option ${data.gender == "man" ? "selected" : ""} value="man">#L{}</option><option ${data.gender == "women" ? "selected" : ""} value="women">#L{}</option></select></dd></dl></#et>');var f={};var c={adv_search:function(){if(!h.auth){h.auth="all"}a.common.dialog.advSearch({innerStr:a.core.util.easyTemplate(y,h),defaultConfig:{}})}};var w={};var o={};var v=function(){r();e();x();b();g();j();n()};var r=function(){if(!t){throw"[pl_advsearchUser] : missing  -> path : comp.filter.advsearchUser"}p=a.core.obj.parseParam({html:""},p)};var e=function(){var B=a.builder(t).list,C;a.foreach(B,function(D){if(C=D[0]){s[C.getAttribute("node-type")]=C}});if(!s){throw"Lack of necessary nodes  -> path : comp.filter.advsearchUser"}};var x=function(){q=a.common.search.parseSearchParam();h=a.parseParam(u,q)};var b=function(){};var g=function(){a.core.evt.addEvent(t,"click",c.adv_search)};var j=function(){};var n=function(){};var z=function(){};v();m.destroy=z;m.eventHandler=c.adv_search;return m}});STK.register("kit.dom.parseDOM",function(a){return function(c){for(var b in c){if(c[b]&&(c[b].length==1)){c[b]=c[b][0]}}return c}});STK.register("kit.dom.textSelection",function(a){return function(h,j){var e,f;e={};f=a.parseParam({},j);var m=function(n){return a.core.dom.selectText(h,n)};var d=function(){h.__areaQuery=a.jsonToQuery(a.core.dom.textSelectArea(h))};var g=function(){h.__areaQuery=false};a.addEvent(h,"beforedeactivate",d);a.addEvent(h,"active",g);var c=function(){var n=null;try{n=a.core.dom.textSelectArea(h)}catch(o){n=a.queryToJson(h.__areaQuery)}if(n.start===0&&n.len===0&&h.__areaQuery){n=a.queryToJson(h.__areaQuery)}n.start=parseInt(n.start,10);n.len=parseInt(n.len,10);return n};var b=function(s,p){var q=h.value;var t=p.start;var n=p.len||0;var o=q.slice(0,t);var r=q.slice(t+n,q.length);h.value=o+s+r;q=null;o=null;r=null;var t=null;var n=null};e.setCursor=function(n){m(n)};e.getCursor=function(){return c()};e.insertCursor=function(o){var n=c();b(o,n);n.len=o.length;m(n)};e.TempletCursor=function(o){var p,q,n;p=c();if(p.len>0){q=h.value.substr(p.start,p.len)}else{q=""}n=a.templet(o,{origin:q});b(n,p);p.start=p.start+o.indexOf("#{origin");p.len=n.length-o.replace(/#\{[origin].+?\}/,"").length;m(p)};e.insertText=b;e.destroy=function(){a.removeEvent(h,"beforedeactivate",d);a.removeEvent(h,"active",g);h=null};return e}});STK.register("comp.searchHead",function(c){var b="comp.searchHead";var a;return function(B,v){var q={};var A="weibo";var y,G,t="",z,u,w;var o,g;var E;var m=$CONFIG.s_domain+"/help/gs";var h={};var e={getTryHtml:function(){var L='<p class="suglist_tit">:</p><ul class="sug_list clearfix">';if($CONFIG.islogin=="1"){L+='<li action-type="suggestList"><i class="Gs_recommend_icon_article gs_icons"></i></li><li action-type="suggestList"><i class="Gs_recommend_icon_article gs_icons"></i>24</li>'}else{L+='<li action-type="suggestList"><i class="Gs_recommend_icon_article gs_icons"></i></li><li action-type="suggestList"><i class="Gs_recommend_icon_article gs_icons"></i>24</li>'}if(!c.core.dom.hasClassName(G[0],"cur")){return""}var H=STK.core.util.storage,M,J;var I="";M=H.get("ls-suggests");if(M==="null"||M===null||M===""){return L+I+"</ul>"}else{J=c.core.json.strToJson(M);var K=document.referrer.replace(/(.*)\?.*/,function(O,N){return N});if(K===m){e.tryHtmlClick(false)}if(J.count>=25){return L+"</ul>"}}return L+I+"</ul>"},tryHtmlClick:function(N){var J="";var P=document.referrer.replace(/(.*)\?.*/,function(R,Q){return Q});var M=STK.core.util.storage,H="",O;H=M.get("ls-suggests");if(H===null||H==="null"||H===""){window.location=m+"?refer=xsyd_1";return}O=c.core.json.strToJson(H);if(O.count<3){J=m}if(P===m){J=""}if(O.count<=25&&J===""){var I=c.trim(O.data[O.index]);window.sugData=window.sugData||{value:[],setValue:function(){if(window.sugData.value.length==0){window.sugData.templateHTML='<span class="hand_tip"><img src="//img.t.sinajs.cn/t4/appstyle/searchV45/images/common/hand_sug.gif"> ~</span>';window.sugData.value[0]=window.sugData.templateHTML}}};window.sugData.setValue();window.sugData.defaultText=I;for(var K=I.length,L=1;L<=K;L++){(function(Q){setTimeout(function(){var R=I.slice(0,Q);y.text.value=R;window.sugData.currentText=R;u.show()},120*Q)})(L)}}if(O.count>=25&&N){N.el.parentNode.removeChild(N.el);C();return}if(true){if(O.index===O.data.length-1){O.index=0}else{O.index+=1}if(N&&N.evt.type==="click"){O.count+=1}M.set("ls-suggests",c.core.json.jsonToStr(O));if(J!=""){setTimeout(function(){window.location=J+"?refer=xsyd_1"},800)}}},showItems:function(H){if(c.core.dom.hasClassName(y.moreItems,"hidden_li")){c.core.dom.removeClassName(y.moreItems,"hidden_li");c.core.dom.addClassName(y.moreItems,"li_show");y.more.style.display="none"}else{c.core.dom.removeClassName(y.moreItems,"li_show");c.core.dom.addClassName(y.moreItems,"hidden_li");y.more.style.display=""}},typeChange:function(H){for(var K=0;K<G.length;K++){G[K].className=""}H.el.className="cur";A=H.data.type;E=H.data;var L=event.target||event.srcElement;t=L.getAttribute("action_params");if(A==="weibo"){w=A="gs_weibo"}else{if(A==="wb"){w=A="weibo"}}var J={url:"/ajax/suggestion?where="+A,args:{type:A}};var I={weibo:'<#et tip data><div class="suglist_box"><ul class="sug_list clearfix"><#if (data.searchHistoryData.length != 0)><#list data.searchHistoryData as list><#if (list.length != 0)><li action-type="suggestList" ><span class="icon_close_sug" action-type="suggestList_del"></span><i class="icon_history_sug"></i><a href="javascript:void(0)" class="list_link" node-type="suggestlist_text" >${list}</a></li></#if></#list><li class="list_link_line"></li></#if><#list data.searchValueData as list><#if (typeof list === \'object\')><li action-type="suggestList" suda-data="key=tblog_search_v4.1&value=index_allsearch"><i class="${list_index<=2?"icon_hot_top":"icon_hot_sug"}">${list_index + 1}</i><a href="javascript:void(0)" node-type="suggestlist_text" class="list_link">${list.word}</a></li><#else><#if (typeof list === \'string\')><li action-type="suggestList" suda-data="key=tblog_search_v4.1&value=index_allsearch"><i class="${list_index<=2?"icon_hot_top":"icon_hot_sug"}">${list_index + 1}</i><a href="javascript:void(0)" node-type="suggestlist_text" class="list_link">${list}</a></li><#else><li action-type="suggestList" suda-data="key=tblog_search_v4.1&value=index_allsearch"><#if (list.pic)><i class="${list_index<=2?"icon_hot_top":"icon_hot_sug"}">${list_index + 1}</i></#if><a href="javascript:void(0)" node-type="suggestlist_text" class="list_link">${list.key}</a></li></#if></#if></#list></ul><p class="sug_more clearfix"><a suda-data="key=tblog_search_v4.1&value=index_allsearch" href="/top/summary" class="sugmore_txt">&raquo;</a></p></div></#et>',other:'<#et tip data><div class=""><div class="suglist_box"><ul class="sug_list clearfix"><#if (data.searchHistoryData.length != 0)><#list data.searchHistoryData as list><#if (list.length != 0)><li action-type="suggestList" ><span class="icon_close_sug" action-type="suggestList_del"></span><i class="icon_history_sug"></i><a href="javascript:void(0)" class="list_link" node-type="suggestlist_text" >${list}</a></li></#if></#list><li class="list_link_line"></li></#if><#list data.searchValueData as list><#if (typeof list === \'string\')><li action-type="suggestList" suda-data="key=tblog_search_v4.1&value=index_allsearch"><i class="${list_index<=2?"icon_hot_top":"icon_hot_sug"}">${list_index + 1}</i><a href="javascript:void(0)" node-type="suggestlist_text" class="list_link">${list}</a></li><#else><li action-type="suggestList" suda-data="key=tblog_search_v4.1&value=index_allsearch"><#if (list.pic)><i class="${list_index<=2?"icon_hot_top":"icon_hot_sug"}">${list_index + 1}</i></#if><a href="javascript:void(0)" node-type="suggestlist_text" class="list_link">${list.key}</a></li></#if></#list></ul><p class="sug_more clearfix"><a suda-data="key=tblog_search_v4.1&value=index_allsearch" href="/top/summary" class="sugmore_txt">&raquo;</a></p></div></div></#et>'};if(A==="gs_weibo"){J.focusTemplate=I.weibo}else{J.focusTemplate=I.weibo}u.setOption(J);if(H.data.type!="user"&&H.data.type!="wb"){}else{if(true){if(H.data.type=="user"){w="user"}else{if(H.data.type=="weibo"){w="weibo"}}}}},submit:function(H){if(c.core.str.trim(y.text.value)!=""){var I="";if(typeof H=="string"&&H.length!=0){I+=H}if($CONFIG.pageid=="top_summary"){I+="top"}else{I+="index"}if(A=="gs_weibo"){w=A="weibo"}if(t!=null&&t!=""){t="&"+t}else{t=""}if(A=="list/relpage"){window.location.href="/"+A+"?search="+encodeURIComponent(encodeURIComponent(c.core.str.trim(y.text.value)))+"&Refer="+I}else{window.location.href="/"+A+"/"+encodeURIComponent(encodeURIComponent(c.core.str.trim(y.text.value)))+t+"&Refer="+I}c.preventDefault()}else{y.text.focus()}},clear:function(){if(a&&y.text.value==a){y.text.value="";y.text.style.color=""}u.show()},restore:function(){var H=y.text.value;if(a&&!H){y.text.style.color="#999";y.text.value=a}}};var D={};var s={};var C=function(){x();f();F();d();j();p();r()};var x=function(){if(!B){throw"[pl_searchBar] : missing  -> path : comp.searchBar"}};var f=function(){y=c.kit.dom.parseDOM(c.builder(B).list)};var F=function(){a=y.text.value;if(!a){}var H={parent:y.text.parentNode,action:function(){e.submit()}};c.common.form.enterSubmit(H);G=c.sizzle("[action-type=type]",B);if(true){var J=c.core.str.queryString("Refer",{source:window.location.href});w=A=(J!=null)?J.replace(/friend_index_/gi,""):"";if(c.core.dom.hasClassName(G[0],"cur")){w=A="gs_weibo"}else{if(c.core.dom.hasClassName(G[1],"cur")){w=A="weibo"}else{if(c.core.dom.hasClassName(G[2],"cur")){w=A="user"}else{if(c.core.dom.hasClassName(G[3],"cur")){w=A="list/relpage"}else{if(c.core.dom.hasClassName(G[4],"cur")){w=A="pic"}else{if(c.core.dom.hasClassName(G[5],"cur")){w=A="apps"}}}}}}}var I="/ajax/suggestion?where="+A;u=c.common.search.suggestInput(y.text,{className:"suggest_list3",focusclass:"current",template:'<#et tip data><ul class="sug_list clearfix"><#if (data.searchHistoryData.length != 0)><#list data.searchHistoryData as list><#if (list.length != 0)><li action-type="suggestList" ><span class="icon_close_sug" action-type="suggestList_del"></span><a href="javascript:void(0)" class="list_link first_history" node-type="suggestlist_text" >${list}</a></li></#if></#list></#if><#if (data.searchValueData.length != 0)><#list data.searchValueData as list><#if (typeof list === \'string\')><li action-type="suggestList" suda-data="key=tblog_search_v4.1&value=index_allsearch"><a href="javascript:void(0)" node-type="suggestlist_text" class="list_link">${list}</a></li><#else><#if (window.sugData && window.sugData.defaultText === window.sugData.currentText && window.sugData.value.length != 0 && list.pic)><li action-type="suggestList" class="current"><#else><li action-type="suggestList"></#if><#if (list.pic)><a href="javascript:void(0)" node-type="suggestlist_text" class="list_link">${list.key}</a><#if (window.sugData && window.sugData.defaultText === window.sugData.currentText)>${window.sugData.value.length != 0 ? window.sugData.value.splice(0,1) : ""}</#if><#else><a href="javascript:void(0)" node-type="suggestlist_text" class="list_link">${list.key}</a></#if></li></#if></#list></#if><#if (data.searchValueData.length != 0 && data.searchUserData.length != 0)><li class="list_link_line"></li></#if></ul><#if (data.searchUserData.length != 0)><ul class="sug_list2 clearfix"><#list data.searchUserData as list><li class="s_user_r clearfix" action-type="suggestList" action-data="uid=${list.u_id}"><div class="s_user"><div class="s_user_img"><img src="${list.u_pic}"></div><div class="s_info"><p class="name" node-type="">${list.u_name}<#if (list.is_v === true)><img width="11" height="10" class="${list.extra}" alt="" src="//img.t.sinajs.cn/t4/style/images/common/transparent.gif"></#if></p><p class="fans">${list.fans_n}</p></div></div></li></#list></ul></#if></#et>',focusTemplate:'<#et tip data><div class="suglist_box"><ul class="sug_list clearfix"><#if (data.searchHistoryData.length != 0)><#list data.searchHistoryData as list><#if (list.length != 0)><li action-type="suggestList" ><span class="icon_close_sug" action-type="suggestList_del"></span><i class="icon_history_sug"></i><a href="javascript:void(0)" class="list_link" node-type="suggestlist_text" >${list}</a></li></#if></#list><li class="list_link_line"></li></#if><#list data.searchValueData as list><#if (typeof list === \'object\')><#if (typeof list.monitor === \'object\')><li action-type="suggestList" suda-data="key=tblog_search_v4.1&value=index_allsearch" word="${list.word}" url_show="${list.monitor.pc_show}" url_click="${list.monitor.pc_click}" ad_id="${list.monitor.ad_id}"><#else><li action-type="suggestList" suda-data="key=tblog_search_v4.1&value=index_allsearch"></#if><i class="${list_index<=2?"icon_hot_top":"icon_hot_sug"}">${list_index + 1}</i><a href="javascript:void(0)" node-type="suggestlist_text" class="list_link">${list.word}</a></li><#else><#if (typeof list === \'string\')><li action-type="suggestList" suda-data="key=tblog_search_v4.1&value=index_allsearch"><i class="${list_index<=2?"icon_hot_top":"icon_hot_sug"}">${list_index + 1}</i><a href="javascript:void(0)" node-type="suggestlist_text" class="list_link">${list}</a></li><#else><li action-type="suggestList" suda-data="key=tblog_search_v4.1&value=index_allsearch"><#if (list.pic)><i class="${list_index<=2?"icon_hot_top":"icon_hot_sug"}">${list_index + 1}</i></#if><a href="javascript:void(0)" node-type="suggestlist_text" class="list_link">${list.key}</a></li></#if></#if></#list></ul><p class="sug_more clearfix"><a suda-data="key=tblog_search_v4.1&value=index_allsearch" href="/top/summary" class="sugmore_txt">&raquo;</a></p></div></#et>',focusArgs:{type:"hot",key:""},url:I,args:{type:A},width:y.text.offsetWidth+16,offset:{left:-8,top:0},clickback:function(S){var L=c.builder(S.el).list,P;if(!L.suggestlist_text){return}selectedSearchWord=(L.suggestlist_text[0].innerText||L.suggestlist_text[0].textContent).replace(/~/,"");var N="";if(A=="gs_weibo"){N+="focus_";if(y.text.value.length!=0){N+="lx_"}}var W={word:S.el.getAttribute("word"),ad_id:S.el.getAttribute("ad_id"),url_click:S.el.getAttribute("url_click")};if(W.ad_id){var O=false,M=false;var T=new Image();T.onload=K;T.error=Q;T.src="//j.s.weibo.com/doit.png?type=click&position=s_suggest_click&word="+W.word+"&time="+(+new Date());if(W.url_click){var R=new Image();R.onload=V;R.error=Q;R.src=decodeURIComponent(W.url_click).replace("__REQUESTID__","s_suggest_click"+(+new Date()))+"&word="+W.word}function Q(X){lock=true;window.location.href="/weibo/"+encodeURIComponent(W.word)}function K(X){O=true;W.url_click?U():Q()}function V(X){M=true;U()}function U(){if(O&&M){lock=true;window.location.href="/weibo/"+encodeURIComponent(W.word)}}}else{y.text.value=c.trim(selectedSearchWord);e.submit()}},delback:function(O){var L=O.currentType,K=c.core.util.storage.get(L),Q,N="|@|",M,P;if(K==="null"){return}M=c.builder(O.el.parentNode);if(M.list.suggestlist_text){P=M.list.suggestlist_text[0].innerText||M.list.suggestlist_text[0].textContent;Q=K.replace(N+P+N,N);if(Q.length<=3){Q=""}c.core.util.storage.set(L,Q);M.box.parentElement.removeChild(M.box);u.show()}}})};var d=function(){};var j=function(){var H=c.core.evt.delegatedEvent(y.searchItems);H.add("type","click",e.typeChange);c.core.evt.addEvent(y.submit,"click",e.submit);c.core.evt.addEvent(y.text,"focus",e.clear);c.core.evt.addEvent(y.text,"blur",e.restore)};var p=function(){};var r=function(){};var n=function(){c.core.evt.removeEvent("nodes.submit","click",e.submit);c.core.evt.removeEvent(y.text,"focus",e.clear);c.core.evt.removeEvent(y.text,"blur",e.restore);var H=c.core.evt.delegatedEvent(y.searchItems);H.remove("type","click")};C();q.destory=n;return q}});STK.pageletM.register("pl.searchHead",function(b){var a=b.E("pl_searchHead");if(a){return b.comp.searchHead(a)}});STK.register("kit.dom.isTurnoff",function(a){return function(b){return !(b.parentNode&&b.parentNode.nodeType!=11&&!b.disabled)}});STK.register("kit.extra.textareaUtils",function(c){var a={},b=document.selection;a.selectionStart=function(f){if(!b){try{return f.selectionStart}catch(m){return 0}}var n=b.createRange(),j,d,h=0;var g=document.body.createTextRange();g.moveToElementText(f);for(h;g.compareEndPoints("StartToStart",n)<0;h++){g.moveStart("character",1)}return h};a.selectionBefore=function(d){return d.value.slice(0,a.selectionStart(d))};a.selectText=function(d,e,f){d.focus();if(!b){d.setSelectionRange(e,f);return}var g=d.createTextRange();g.collapse(1);g.moveStart("character",e);g.moveEnd("character",f-e);g.select()};a.insertText=function(f,e,h,g){f.focus();g=g||0;if(!b){var j=f.value,n=h-g,d=n+e.length;f.value=j.slice(0,n)+e+j.slice(h,j.length);a.selectText(f,d,d);return}var m=b.createRange();m.moveStart("character",-g);m.text=e};a.replaceText=function(g,e){g.focus();var h=g.value;var n=a.getSelectedText(g);var f=n.length;if(n.length==0){a.insertText(g,e,a.getCursorPos(g))}else{var m=a.getCursorPos(g);if(b){var j=b.createRange();j.text=e;a.setCursor(g,m+e.length)}else{var d=m+n.length;g.value=h.slice(0,m)+e+h.slice(m+f,h.length);a.setCursor(g,m+e.length);return}}};a.getCursorPos=function(g){var f=0;if(STK.core.util.browser.IE){g.focus();var d=null;d=b.createRange();var e=d.duplicate();e.moveToElementText(g);e.setEndPoint("EndToEnd",d);g.selectionStart=e.text.length-d.text.length;g.selectionEnd=g.selectionStart+d.text.length;f=g.selectionStart}else{if(g.selectionStart||g.selectionStart=="0"){f=g.selectionStart}}return f};a.getSelectedText=function(e){var f="";var d=function(g){if(g.selectionStart!=undefined&&g.selectionEnd!=undefined){return g.value.substring(g.selectionStart,g.selectionEnd)}else{return""}};if(window.getSelection){f=d(e)}else{f=b.createRange().text}return f};a.setCursor=function(f,g,e){g=g==null?f.value.length:g;e=e==null?0:e;f.focus();if(f.createTextRange){var d=f.createTextRange();d.move("character",g);d.moveEnd("character",e);d.select()}else{f.setSelectionRange(g,g+e)}};a.unCoverInsertText=function(g,j,f){f=(f==null)?{}:f;f.rcs=f.rcs==null?g.value.length:f.rcs*1;f.rccl=f.rccl==null?0:f.rccl*1;var h=g.value,d=h.slice(0,f.rcs),e=h.slice(f.rcs+f.rccl,h==""?0:h.length);g.value=d+j+e;this.setCursor(g,f.rcs+(j==null?0:j.length))};return a});STK.register("kit.extra.count",function(b){function a(m){var e=41,o=140,c=20,f=m;var n=m.match(/(http|https):\/\/[a-zA-Z0-9]+(\.[a-zA-Z0-9]+)+([-A-Z0-9a-z_\$\.\+\!\*\(\)\/,:;@&=\?\~\#\%]*)*/gi)||[];var d=0;for(var g=0,j=n.length;g<j;g++){var h=b.core.str.bLength(n[g]);if(/^((http|https):\/\/t.cn)/.test(n[g])){continue}else{if(/^((http|https):\/\/)+(t.sina.com.cn|t.sina.cn)/.test(n[g])||/^((http|https):\/\/)+(weibo.com|weibo.cn)/.test(n[g])){d+=h<=e?h:(h<=o?c:(h-o+c))}else{d+=h<=o?c:(h-o+c)}}f=f.replace(n[g],"")}var p=Math.ceil((d+b.core.str.bLength(f))/2);return p}return function(c){c=c.replace(/\r\n/g,"\n");return num=a(c)}});STK.register("module.editor",function(e){var c=e.core.evt.addEvent;var b=e.core.evt.custEvent;var a=e.core.dom.getStyle;var d=e.core.dom.setStyle;return function(y,o){var q={};var o=o;var x={},u="";var n={reset:function(){x.textEl.value="";e.core.evt.custEvent.fire(q,"changed");x.textEl.removeAttribute("extra");u=""},delWords:function(D){var C=n.getWords();if(C.indexOf(D)>-1){x.textEl.value="";A.textInput(C.replace(D,""))}else{return false}},getWords:function(){return e.core.str.trim(x.textEl.value)},getExtra:function(){var D;var C=x.textEl.getAttribute("extra")||"";if(C!=null){D=e.core.str.trim(C)}return D},focus:function(E,C){if(typeof E!="undefined"){e.kit.extra.textareaUtils.setCursor(x.textEl,E,C)}else{var D=x.textEl.value.length;e.kit.extra.textareaUtils.setCursor(x.textEl,D)}f.cacheCurPos()},blur:function(){x.textEl.blur()},addExtraInfo:function(C){if(typeof C=="string"){x.textEl.setAttribute("extra",C)}},disableEditor:function(C){e.core.evt.removeEvent(x.textEl,"mouseup",f.cacheCurPos);if(C===true){x.textEl.setAttribute("disabled","disabled")}else{e.core.evt.addEvent(x.textEl,"mouseup",f.cacheCurPos);x.textEl.removeAttribute("disabled")}},getCurPos:function(){var C=x.textEl.getAttribute("range")||"0&0";return C.split("&")},count:function(){var C=(e.core.str.trim(x.textEl.value).length==0)?e.core.str.trim(x.textEl.value):x.textEl.value;return e.kit.extra.count(C)},addShortUrlLog:function(C){C=C&&e.trim(C);if(C){var D=new RegExp("^"+C+"$|_"+C+"$|^"+C+"_|_"+C+"_");if(!D.test(u)){if(!u){u=C}else{u=u+"_"+C}}}},getShortUrlLog:function(){return u}};var f={textElFocus:function(){if(x.recommendTopic){e.core.dom.setStyle(x.recommendTopic,"display","none")}e.custEvent.fire(q,"focus");if(x.num){e.core.dom.setStyle(x.num,"display","block")}if(n.getWords()==o.tipText){n.delWords(o.tipText)}},textElBlur:function(){setTimeout(function(){if(x.textEl.value.length===0){if(x.recommendTopic){e.core.dom.setStyle(x.recommendTopic,"display","block")}if(x.num&&x.recommendTopic){e.core.dom.setStyle(x.num,"display","none")}e.custEvent.fire(q,"blur");if(typeof o.tipText!="undefined"){x.textEl.value=o.tipText}}},50)},cacheCurPos:function(){var D=e.kit.extra.textareaUtils.getSelectedText(x.textEl);var E=(D==""||D==null)?0:D.length;var F=e.kit.extra.textareaUtils.getCursorPos(x.textEl);var C=F+"&"+E;x.textEl.setAttribute("range",C)}};var A={textChanged:function(){e.custEvent.fire(q,"keyUpCount")},textInput:function(D,F){var E=n.getCurPos();var F=E[0];var C=E[1];if(n.getWords()==o.tipText&&D!=o.tipText){n.delWords(o.tipText)}e.kit.extra.textareaUtils.unCoverInsertText(x.textEl,D,{rcs:E[0],rccl:E[1]});f.cacheCurPos();e.core.evt.custEvent.fire(q,"changed")}};var t={};var g=function(){w();h()};var z=function(){p();r();s();j()};var j=function(){if(o.storeWords){if(x.textEl.value.length==0){A.textInput(o.storeWords)}return}if(o.tipText){x.textEl.value=o.tipText}};var w=function(){if(!y){throw"node is not defined in module editor"}};var h=function(){var C=e.core.dom.builder(y).list;x=e.kit.dom.parseDOM(C);if(!x.widget){throw"can not find nodes.widget in module editor"}};var p=function(){e.core.evt.addEvent(x.textEl,"focus",f.textElFocus);e.core.evt.addEvent(x.textEl,"blur",f.textElBlur);e.core.evt.addEvent(x.textEl,"mouseup",f.cacheCurPos);e.core.evt.addEvent(x.textEl,"keyup",f.cacheCurPos)};var m=function(){e.core.evt.custEvent.define(q,"changed")};var r=function(){m();e.core.evt.custEvent.add(q,"changed",A.textChanged)};var s=function(){};var B=function(){};g();var v={reset:n.reset,getWords:n.getWords,getExtra:n.getExtra,delWords:n.delWords,focus:n.focus,blur:n.blur,insertText:A.textInput,check:A.textChanged,addExtraInfo:n.addExtraInfo,disableEditor:n.disableEditor,getCurPos:n.getCurPos,count:n.count,textElFocus:f.textElFocus,cacheCurPos:f.cacheCurPos,addShortUrlLog:n.addShortUrlLog,getShortUrlLog:n.getShortUrlLog};q.destroy=B;q.API=v;q.nodeList=x;q.init=z;q.opts=o;return q}});STK.register("common.editor.plugin.count",function(e){var b;function d(p){var h=41,r=140,f=20,j=p;var q=p.match(/(http|https):\/\/[a-zA-Z0-9]+(\.[a-zA-Z0-9]+)+([-A-Z0-9a-z_\$\.\+\!\*\(\)\/\,\:;@&=\?~#%]*)*/gi)||[];var g=0;for(var m=0,o=q.length;m<o;m++){var n=e.core.str.bLength(q[m]);if(/^((http|https):\/\/t.cn)/.test(q[m])){continue}else{if(/^((http|https):\/\/)+(t.sina.com.cn|t.sina.cn)/.test(q[m])||/^((http|https):\/\/)+(weibo.com|weibo.cn)/.test(q[m])){g+=n<=h?n:(n<=r?f:(n-r+f))}else{g+=n<=r?f:(n-r+f)}}j=j.replace(q[m],"")}var s=Math.ceil((g+e.core.str.bLength(j))/2);return s}function a(j){var h=d(j);var g=Math.abs(b-h);var f;if(h>b||h<1){f={wordsnum:h,vnum:g,overflow:true}}else{if(h==0){f={wordsnum:h,vnum:g,overflow:true}}else{f={wordsnum:h,vnum:g,overflow:false}}}return f}function c(f,g){if(!f.textEl){throw"[editor plugin count]: plz check nodeList"}}return function(j){var f=j.nodeList;var g;var o=j.opts;var n=e.kit.extra.language;b=o.limitNum;c(f);e.core.evt.custEvent.define(j,"textNum");e.custEvent.define(j,"keyUpCount");var p=f.textEl;var h=f.num;e.addEvent(p,"focus",function(){g=setInterval(function(){m()},200)});e.addEvent(p,"blur",function(){clearInterval(g)});var m=function(){var s=(e.core.str.trim(p.value).length==0)?e.core.str.trim(p.value):p.value;var q=j&&j.opts&&j.opts.extendText;s=s.replace(/\r\n/g,"\n");var r=a(s,o.limitNum);if(s.length>=0&&p.focus){if(r.overflow&&r.wordsnum!=0){h.innerHTML=(q?n(q):"")+n("#L{}")+'<span class="W_error">'+r.vnum+"</span>"}else{h.innerHTML=(q?n(q):"")+n("#L{}")+"<span>"+r.vnum+"</span>"}}else{if(s.length===0){h.innerHTML=(q?n(q):"")+n("#L{}")+"<span>"+r.vnum+"</span>"}}e.core.evt.custEvent.fire(j,"textNum",{count:r.wordsnum,isOver:r.overflow})};STK.core.evt.addEvent(p,"keyup",m);e.custEvent.add(j,"keyUpCount",m)}});STK.register("common.listener",function(b){var c={};var a={};a.define=function(e,f){if(c[e]!=null){throw"common.listener.define: "}c[e]=f;var d={};d.register=function(h,g){if(c[e]==null){throw"common.listener.define: "}b.listener.register(e,h,g)};d.fire=function(g,h){if(c[e]==null){throw"commonlistener.define: "}b.listener.fire(e,g,h)};d.remove=function(h,g){b.listener.remove(e,h,g)};d.cache=function(g){return b.listener.cache(e,g)};return d};return a});STK.register("module.at",function(g){var r=window,m=document,o=g.core.util.browser,b="font-family:Tahoma,;",q=g.kit.extra.textareaUtils.selectionStart;var s;var c,h,e,n;var f=(function(){var d={"<":"&lt;",">":"&gt;",'"':"&quot;","\\":"&#92;","&":"&amp;","'":"&#039;","\r":"","\n":"<br>"," ":(navigator.userAgent.match(/.+(?:ie) ([\d.]+)/i)||[8])[1]<8?['<pre style="overflow:hidden;display:inline;',b,'word-wrap:break-word;"> </pre>'].join(""):['<span style="white-space:pre-wrap;',b,'"> </span>'].join("")};return function(u){var t=u.replace(/(<|>|\"|\\|&|\'|\n|\r| )/g,function(v){return d[v]});return t}})();var a=function(){var d=[],u=s.textEl.style.cssText,t;g.foreach(["margin","padding","border"],function(v){g.foreach(["Top","Left","Bottom","Right"],function(x){var w;if(v!="border"){w=d.push(v,"-",x.toLowerCase(),":",g.getStyle(s.textEl,v+x),";");return}g.foreach(["Color","Style","Width"],function(y){d.push(v,"-",x.toLowerCase(),"-",y.toLowerCase(),":",g.getStyle(s.textEl,[v,x,y].join("")),";")})})});d.push("font-size:"+g.getStyle(s.textEl,"fontSize")+";");return g.kit.dom.cssText([u,d.join(""),b,"			word-wrap: break-word;			line-height: 18px;			overflow-y:auto;			overflow-x:hidden;			outline:none;		"].join("")).getCss()};var p=(function(){var y=g.builder(['<div node-type="wrap" style="display:none;">','<span node-type="before"></span>','<span node-type="flag"></span>','<span node-type="after"></span>',"</div>"].join("")).list;var t=y.wrap[0],z=y.flag[0],d=y.after[0],B=y.before[0],x=0,v,u,A;var w=function(C){if(o.MOZ){return -2}if(o.MOBILE&&o.SAFARI&&(o.IPAD||o.ITOUCH||o.IPHONE)){return -2}return 0};return{bind:function(){if(u===s.textEl){return}n=g.position(s.textEl);var C=["left:",n.l,"px;top:",n.t+20,"px;"].join("");u=s.textEl;var D=a();u.style.cssText=D;A=[C,D,"					position:absolute;					filter:alpha(opacity=0);					opacity:0;					z-index:-1000;				"].join("");t.style.cssText=A;if(!x){x=1;m.body.appendChild(t)}},content:function(C,E,F,D){t.style.cssText=[A,"					width:",((parseInt(g.getStyle(u,"width"))||u.offsetWidth)+w()),"px;					height:",((parseInt(g.getStyle(u,"height"))||u.offsetHeight)),"px;					overflow-x:hidden;					overflow-y:",(/webkit/i.test(navigator.userAgent))?"hidden":g.getStyle(u,"overflowY"),";				"].join("");B.innerHTML=f(C);z.innerHTML=f(E)||"&thinsp;";d.innerHTML=f([F,D].join(""));clearTimeout(v);v=setTimeout(function(){var G=g.position(z);g.custEvent.fire(s.eId,"at",{t:(G.t-u.scrollTop)-n.t,l:G.l-n.l,key:F,flag:E,textarea:s.textEl})},30)},hide:function(){t.style.display="none"},show:function(){t.style.display=""}}})();var j=function(){if(g.kit.dom.isTurnoff(s.textEl)){clearInterval(c);return}var d=s.textEl.value.replace(/\r/g,"");var w=q(s.textEl);if(w<0||w==e){return}e=w;var u=d.slice(0,w);var t=u.match(new RegExp(["(",s.flag,")([a-zA-Z0-9\u4e00-\u9fa5_]{0,20})$"].join("")));if(!t){g.custEvent.fire(s.eId,"hidden");return}var v=d.slice(w);u=u.slice(0,-t[0].length);p.content(u,t[1],t[2],v)};return function(t){if(!t||!t.textEl){return}t=g.parseParam({textEl:null,flag:"@",eId:g.custEvent.define({},["at","hidden"])},t);var u=function(){if(!s){return}clearInterval(c);g.removeEvent(s.textEl,"blur",u);p.hide()};var d=function(){u();s=t;e=null;p.bind();p.show();c=setInterval(j,200);g.addEvent(t.textEl,"blur",u)};g.addEvent(t.textEl,"focus",d);return t.eId}});STK.register("module.suggest",function(m){var h=null,e=m.custEvent,p=e.define,f=e.fire,r=e.add,g=m.addEvent,c=m.removeEvent,q=m.stopEvent;var b=[],a={};var j={ENTER:13,ESC:27,UP:38,DOWN:40,TAB:9};var o=function(z){var y=-1,w=[],u=z.textNode,v=z.uiNode;var D=m.core.evt.delegatedEvent(v);var s=p(u,["open","close","indexChange","onSelect","onIndexChange","onClose","onOpen","openSetFlag"]);s.setFlag=t;var t=function(E){z.flag=E};var B=function(){return m.sizzle(["[action-type=",z.actionType,"]"].join(""),v)};var C=function(){y=-1;c(u,"keydown",x);D.destroy()};var x=function(G){var H,F;if(!(H=G)||!(F=H.keyCode)){return}if(F==j.ENTER){q();f(s,"onSelect",[y,u,z.flag]);return false}if(F==j.UP){q();var E=B().length;y=y<1?E-1:y-1;f(s,"onIndexChange",[y]);return false}if(F==j.DOWN){q();var E=B().length;y=y==(E-1)?0:y+1;f(s,"onIndexChange",[y]);return false}if(F==j.ESC){q();C();f(s,"onClose");return false}if(F==j.TAB){C();f(s,"onClose");return false}};var A=function(E){f(s,"onSelect",[m.core.arr.indexOf(E.el,B()),u,z.flag])};var n=function(E){y=m.core.arr.indexOf(E.el,B());f(s,"onIndexChange",[m.core.arr.indexOf(E.el,B())])};r(s,"open",function(F,E){u=E;C();g(E,"keydown",x);D.add(z.actionType,"mouseover",n);D.add(z.actionType,"click",A);f(s,"onOpen",[z.flag])});r(s,"openSetFlag",function(F,E){t(E)});r(s,"close",function(){C();f(s,"onClose",[z.flag])});r(s,"indexChange",function(E,F){y=F;f(s,"onIndexChange",[y,z.flag])});return s};var d=function(n){var s=n.textNode;var t=m.core.arr.indexOf(s,b);if(!a[t]){b[t=b.length]=s;a[t]=o(n)}return a[t]};return function(n){if(!n.textNode||!n.uiNode){return}n=m.parseParam({textNode:h,uiNode:h,actionType:"item",actionData:"index",flag:""},n);return d(n)}});STK.register("common.channel.at",function(b){var a=["open","close"];return b.common.listener.define("common.channel.at",a)});STK.register("common.editor.plugin.at",function(e){var m='<div style="" class="layer_menu_list"><ul node-type="suggestWrap"></ul></div>';var o={"@":'<#et temp data><li class="suggest_title">@</li><#list data as list><li action-type="item" <#if (list_index == 0)>class="cur" </#if>action-data="value=${list.nickname}" value="${list.nickname}"><a href="#">${list.nickname}<#if (list.remark)>(${list.remark})</#if></a></li><#if (list.count)><span>${list.count}</span></#if></#list></#et>',"#":'<#et temp data><li class="suggest_title"></li><#list data as list><li action-type="item" <#if (list_index == 0)>class="cur" </#if>action-data="value=${list.topic}" value="${list.topic}"><a href="#">${list.topic}<#if (list.count)>(${list.count})</#if></a></li></#list></#et>'};var f,j,v,c,q,x,h=false,n;var u;var t={"@":"followList","#":"topicList"};var d=0;var g=function(){setTimeout(function(){e.custEvent.fire(f,"close")},200)};var a=function(){q.style.display="none"};var p=function(){e.custEvent.add(f,"onIndexChange",function(z,y){r(y)});e.custEvent.add(f,"onSelect",function(y,E,I,G){e.core.evt.stopEvent();var L=u[E].getAttribute("value");L=L.replace(/\(.*\)/,"");try{I.focus()}catch(F){}var K=e.kit.extra.textareaUtils.selectionStart(I)*1;var z=new RegExp(G+"([a-zA-Z0-9\u4e00-\u9fa5_]{0,20})$");var A=I.value.slice(0,K).match(z);var C=I.value.slice(K,K+1);A=(A&&A[1])?A[1].length:0;var H=e.kit.extra.textareaUtils;if(G=="#"){if(typeof C!="undefined"&&C!=G){L=L+G+" "}}else{L=L+" "}H.insertText(I,L,K,A);var B=H.getCursorPos(I);if(G=="#"&&C==G){H.setCursor(I,B+1);H.insertText(I," ",B+1,0)}B=H.getCursorPos(I);var J=H.getSelectedText(I);var D=(J==""||J==null)?0:J.length;I.setAttribute("range",B+"&"+D);e.custEvent.fire(f,"close")});e.addEvent(v.textEl,"blur",g);e.custEvent.add(f,"onClose",a);e.custEvent.add(f,"onOpen",function(z,y){c.style.display="";q.style.display="";h=true;setTimeout(function(){e.custEvent.fire(f,"indexChange",0)},100)})};var w=function(){e.core.evt.custEvent.add(j,"hidden",function(y,z){e.custEvent.fire(f,"close")});e.core.evt.custEvent.add(j,"at",function(A,B){x=B.key;if(x.length==0){e.custEvent.fire(f,"close");return}var y=B.flag;var z=e.common.trans.global.getTrans(t[y],{onSuccess:function(D,G){var C=e.core.util.easyTemplate(o[y],D.data);e.custEvent.fire(f,"openSetFlag",y);e.custEvent.fire(f,"open",B.textarea);var E=e.core.dom.builder(C);var F=E.box;c.innerHTML=F;q.style.cssText=["z-index:11001;background-color:#ffffff;position:absolute;"].join("");e.common.channel.at.fire("open");e.kit.dom.layoutPos(q,B.textarea,{pos:"left-top",offsetX:B.l,offsetY:B.t})},onError:function(){e.custEvent.fire(f,"close")}}).request({key:x,where:"at"})})};var b=function(){n=v.textEl;j=STK.module.at({textEl:n,flag:"@|#"})};var s=function(y){q=STK.C("div");document.body.appendChild(q);if(q.innerHTML.length==0){q.innerHTML=m;c=e.core.dom.sizzle('[node-type="suggestWrap"]',q)[0];q.style.display="none"}f=e.module.suggest({textNode:y,uiNode:c,actionType:"item",actionData:"value",flag:"@"});p()};var r=function(y){u=e.sizzle("li[class!=suggest_title]",c);e.core.dom.removeClassName(u[d],"cur");e.core.dom.addClassName(u[y],"cur");d=y};return function(z,y){v=z.nodeList;var A={};A.init=function(){b();s(v.textEl);w()};return A}});STK.register("common.editor.base",function(c){var b={limitNum:140};function a(){}return function(h,d){var j={};var n,m,g,o;n=c.kit.extra.merge(b,d);m=c.module.editor(h,n);g=m.nodeList;o=[];if(typeof d.count=="undefined"||d.count=="enable"){var f=c.common.editor.plugin.count(m,n)}var e=c.common.editor.plugin.at(m,n);e.init();m.init();m.widget=function(q,r,p){o.push(q);q.init(m,r,p);return m};m.closeWidget=function(){if(o&&o.length!=0){for(var q=0,p=o.length;q<p;q++){o[q].hide()}}};return m}});STK.register("kit.dom.layoutPos",function(a){return function(e,c,b){if(!a.isNode(c)){throw"kit.dom.layerOutElement need element as first parameter"}if(c===document.body){return false}if(!c.parentNode){return false}if(c.style.display==="none"){return false}var g,f,j,n,h,m,d;g=a.parseParam({pos:"left-bottom",offsetX:0,offsetY:0},b);f=c;if(!f){return false}while(f!==document.body){f=f.parentNode;if(f.style.display==="none"){return false}m=a.getStyle(f,"position");d=f.getAttribute("layout-shell");if(m==="absolute"||m==="fixed"){break}if(d==="true"&&m==="relative"){break}}f.appendChild(e);j=a.position(c,{parent:f});n={w:c.offsetWidth,h:c.offsetHeight};h=g.pos.split("-");if(h[0]==="left"){e.style.left=j.l+g.offsetX+"px"}else{if(h[0]==="right"){e.style.left=j.l+n.w+g.offsetX+"px"}else{if(h[0]==="center"){e.style.left=j.l+n.w/2+g.offsetX+"px"}}}if(h[1]==="top"){e.style.top=j.t+g.offsetY+"px"}else{if(h[1]==="bottom"){if($CONFIG.pageid=="pic"){g.offsetY+=f.scrollTop}e.style.top=j.t+n.h+g.offsetY+"px"}else{if(h[1]==="middle"){e.style.top=j.t+n.h/2+g.offsetY+"px"}}}return true}});STK.register("module.bubble",function(a){return function(h,j){if(!h){throw"module.bubble need template as first parameter"}var f;var g,e,d,n,m,c;g=a.parseParam({width:null,height:null,parent:document.body},j);e=a.module.layer(h);d=e.getDom("outer");n=e.getDom("inner");if(e.getDomListByKey("close")){m=e.getDom("close")}d.style.display="none";c=false;var b=function(p){if(c){return true}var o=a.fixEvent(p);if(!a.contains(d,o.target)){e.hide()}};if(m){a.addEvent(m,"click",e.hide)}a.custEvent.add(e,"show",function(){setTimeout(function(){a.addEvent(document.body,"click",b)},0)});a.custEvent.add(e,"hide",function(){c=false;a.removeEvent(document.body,"click",b)});f=e;f.setPosition=function(o){d.style.top=o.t+"px";d.style.left=o.l+"px";return f};f.setLayout=function(o,p){if(!a.isNode(o)){throw"module.bubble.setDown need element as first parameter"}a.kit.dom.layoutPos(d,o,p);return f};f.setContent=function(o){if(typeof o==="string"){n.innerHTML=o}else{if(a.isNode(o)){n.appendChild(o)}}return f};f.setArrow=function(o){var p;if(e.getDomListByKey("arrow")){p=e.getDom("arrow");if(o.className){p.className=o.className||""}if(o.style){p.style.cssText=o.style||""}}};f.clearContent=function(){while(n.children.length){a.removeNode(n.children[0])}};f.stopBoxClose=function(){c=true};f.startBoxClose=function(){c=false};f.destroy=function(){a.removeEvent(document.body,"click",b);e=null;d=null;n=null;m=null};return f}});STK.register("core.util.getUniqueKey",function(c){var a=(new Date()).getTime().toString(),b=1;return function(){return a+(b++)}});STK.register("ui.bubble",function(c){var b=['<div class="W_layer" node-type="outer">','<div class="bg">','<table cellspacing="0" cellpadding="0" border="0">','<tbody><tr><td><div class="content" node-type="layoutContent">','<a class="W_close" href="javascript:void(0);" node-type="close" title=""></a>','<div node-type="inner"></div>',"</div></td></tr></tbody>","</table>",'<div class="arrow arrow_t" node-type="arrow"></div>',"</div>","</div>"].join("");var a=[];return function(d){var e=c.parseParam({template:b,isHold:false},d);var f={get:function(){if(e.isHold){return c.module.bubble(e.template,e)}else{return f.checkBob()}},checkBob:function(){var j;for(var h=0,g=a.length;h<g;h++){if(!a[h]["used"]){j=a[h]["bub"];continue}}if(!j){j=f.create()}return j},refresh:function(m,h){for(var j=0,g=a.length;j<g;j++){if(m===a[j]["bub"]){a[j]["used"]=h;return}}},cevt:function(g){c.custEvent.add(g,"hide",function(){f.refresh(g,false);g.clearContent()});c.custEvent.add(g,"show",function(){f.refresh(g,true)})},create:function(){var g=c.module.bubble(e.template,e);a.push({bub:g,used:true});f.cevt(g);return g}};return f.get()}});STK.register("common.trans.publisher",function(d){var b=d.kit.io.inter();var e="/ajax/jsProxy.php?interurl=http://new.weibo.com";var a="/ajax/";var c=b.register;c("publish",{url:a+"mblog/add",method:"post"});c("publishLive",{url:a+"mblog/liveadd",method:"post"});c("face",{url:a+"mblog/face?type=face",method:"get"});c("magicFace",{url:a+"mblog/face?type=ani",method:"post"});c("getTopic",{url:a+"mblog/face?type=cartoon",method:"post"});c("suggestMusic",{url:e+"/aj/mblog/music/suggest&method=get",requestMode:"jsonp"});c("searchMusic",{url:e+"/aj/mblog/music/search&method=get",requestMode:"jsonp"});c("addMusic",{url:e+"/aj/mblog/music/submit&method=get",requestMode:"jsonp"});c("parseMusic",{url:e+"/aj/mblog/music/parse&method=get",requestMode:"jsonp"});c("parseVideo",{url:e+"/aj/mblog/video&method=post"});return b});STK.register("common.magic",function(f){var h=f.core.util.swf;var b=f.module.mask;var a,n,c,m,d,e;var g=function(){if(a){return}a=f.C("div");a.style.cssText="display:none;width:440px;height:360px;z-index:100000;";n=f.core.dom.uniqueID(a);d=function(o){o=f.fixEvent(o||window.event);if(o.target.getAttribute("name")!=n){j.hide()}};document.body.appendChild(a)};var j=function(o,p){g();if(c){return}c=true;b.showUnderNode(a);f.addEvent(b.getNode(),"click",d);b.getNode().title="";a.style.display="";if(!m){m=f.kit.dom.fix(a,"c")}else{m.setAlign("c")}a.innerHTML=h.html(o,{id:n,width:440,height:360,paras:{allowScriptAccess:"never",wmode:"transparent"},attrs:{name:n},flashvars:{playMovie:"true"}});clearInterval(e);e=setInterval(function(){var r=document[n]||window[n],q=0;if(r&&r.PercentLoaded()==100){clearInterval(e);e=setInterval(function(){var v=r.CurrentFrame(),s;try{s=r.TotalFrames()}catch(u){s=r.TotalFrames}if(v<0){return}if(v<s&&q<=v){q=v}else{j.hide()}},80)}},100)};j.hide=function(){if(a){a.style.display="none";a.innerHTML=""}clearInterval(e);f.removeEvent(b.getNode(),"click",d);b.getNode().title="";b.back();c=false;return j};j.destroy=function(){j.hide();m&&m.destroy();f.removeNode(a);e=a=n=c=m=d};return j});STK.register("common.bubble.face",function(h){var F=h.kit.extra.language;var e='<div node-type="outer" class="layer_faces clearfix"><div class="tab W_textb"><p><a href="javascript:void(0);"  node-type="general">#L{}</a><em class="W_vline">|</em><a href="javascript:void(0);"  node-type="magic">#L{}</a></p></div><div class=""><p class="tab_kind W_linkb"><span class="right"><a href="javascript:void(0);" node-type="prev" action-type="prev" class="pre_d"></a><a href="javascript:void(0);" node-type="next" action-type="next" class="next"></a></span><em node-type="categorys"></em><div class="detail"><ul class="faces_list faces_list_hot clearfix" node-type="hotFace"></ul><ul class="faces_list" node-type="inner"></ul><div class="W_pages_minibtn" node-type="page"></div></div></div></div>';var j='<a href="javascript:void(0);" onclick="return false;" action-type="category" action-data="category=#{item}">#{item}</a>';var s='<a href="javascript:void(0);" onclick="return false;" action-type="category" action-data="category=#{item}" class="current W_texta">#{item}</a>';var p='<li action-type="insert" action-data="text=#{phrase}"><img src="#{icon}" alt="#{phrase}" /></li>';var w=F('<li><a action-type="insert" action-data="text=#{value}" class="img" href="javascript:void(0);"><img src="#{icon}" alt="#{phrase}" /></a><a title="#L{}" class="play" href="javascript:void(0);" action-type="play" action-data="swf=#{swf}"></a><span>#{phrase}</span></li>');var C='<a action-type="page" action-data="num=#{number}" href="javascript:void(0);" onclick="return false;">#{label}</a>';var b='<a action-type="page" action-data="num=#{number}" href="javascript:void(0);" class="current" onclick="return false;">#{label}</a>';var g=F('<div style="text-align:center"><i class="W_loading S_loading"></i><span>#L{}...</span></div>');var r='<li class="clear"></li>';var t='<em class="W_vline">|</em>';var A=5;var q=F("#L{}");var f,x,B,z,d,n;n={};var y=function(H){var K=H.cPoniter;var G=H.categorys;var J=H.currentCategory;var I=G.slice(K,K+A);I=h.foreach(I,function(M,L){if(J===M){return h.templet(s,{item:M})}else{return h.templet(j,{item:M})}});x.categorys.innerHTML=I.join(t);if(K+A>=G.length){x.next.className="next_d"}else{x.next.className="next"}if(K<=0){x.prev.className="pre_d"}else{x.prev.className="pre"}};var a=function(H){var K=H.page;var J=H.cache[H.currentCategory];var I=J.length/H.itemNumber;var L=[];for(var G=0;G<I;G+=1){if(K==G){L.push(h.templet(b,{number:G,label:G+1}))}else{L.push(h.templet(C,{number:G,label:G+1}))}}x.page.innerHTML=L.join("");if(K===0&&H===o&&H.currentCategory===q){x.hotFace.style.display=""}else{x.hotFace.style.display="none"}};var u={general:function(G){d=o;d.init();x.general.className="current W_texta";x.magic.className="";x.inner.className="faces_list clearfix"},magic:function(G){d=m;d.init();x.general.className="";x.magic.className="current W_texta";x.inner.className="faces_magic_list"}};var E={category:function(G){d.page=0;d.currentCategory=G.data.category;d.rend();setTimeout(function(){y(d);a(d)},0)},prev:function(H){var I=d.cPoniter;var G=d.categorys;if(I<=0){return false}d.cPoniter-=A;y(d)},next:function(H){var I=d.cPoniter;var G=d.categorys;if(I>=G.length-A){return false}d.cPoniter+=A;y(d)},play:function(G){h.common.magic(G.data.swf)},insert:function(G){h.custEvent.fire(n,"insert",{value:G.data.text})},page:function(G){d.page=parseInt(G.data.num,10);d.rend();setTimeout(function(){a(d)},0)}};var v=function(G){B=h.ui.bubble();c();D();u[G]();h.custEvent.add(B,"hide",(function(H){return function(){h.custEvent.remove(H,"hide",arguments.callee);h.custEvent.fire(n,"hide",{})}})(B))};var c=function(){f=h.module.layer(F(e));x={};var H=f.getDomList();for(var G in H){x[G]=H[G][0]}c=function(){B.setContent(x.outer)};c()};var D=function(){h.custEvent.define(n,"insert");h.custEvent.define(n,"hide");h.addEvent(x.general,"click",u.general);h.addEvent(x.magic,"click",u.magic);delegate=h.core.evt.delegatedEvent(x.outer);delegate.add("category","click",E.category);delegate.add("prev","click",E.prev);delegate.add("next","click",E.next);delegate.add("insert","click",E.insert);delegate.add("play","click",E.play);delegate.add("page","click",E.page);D=function(){}};var o={init:function(){x.inner.innerHTML=g;var G=h.common.trans.publisher.getTrans("face",{onSuccess:function(I,K){o.cache=I.data.more||{};try{o.hotList=I.data.usual.hot.slice(0,10);x.hotFace.innerHTML=h.foreach(o.hotList,function(M,L){return h.templet(p,M)}).join("")}catch(J){}o.categorys=[q];for(var H in o.cache){o.categorys.push(H)}o.cache[q]=I.data.usual.norm;o.init=function(){o.page=0;o.cPoniter=0;o.currentCategory=q;o.rend();y(o);a(o)};o.init()},onError:function(H,I){}});G.request({})},rend:function(){var J=o.currentCategory;var I=o.cache[J];var H=o.page;var G=o.itemNumber;I=I.slice(H*G,H*G+G);I=h.foreach(I,function(L,K){return h.templet(p,L)});x.inner.innerHTML=I.join("")},page:0,cache:null,hotList:null,cPoniter:0,categorys:[],currentCategory:q,itemNumber:40};var m={init:function(){x.inner.innerHTML=g;x.hotFace.style.display="none";h.common.trans.publisher.getTrans("magicFace",{onSuccess:function(H,I){m.cache=H.data.more||{};m.categorys=[q];for(var G in m.cache){m.categorys.push(G)}m.cache[q]=H.data.usual.norm;m.init=function(){m.page=0;m.cPoniter=0;m.currentCategory=q;m.rend();y(m);a(m)};m.init()},onError:function(G,H){}}).request({})},rend:function(I,H){var L=m.currentCategory;var K=m.cache[L];var J=m.page;var G=m.itemNumber;K=K.slice(J*G,J*G+G);K=h.foreach(K,function(N,M){N.swf=N.icon.slice(0,-4)+".swf";return h.templet(w,N)});K.push(r);x.inner.innerHTML=K.join("")},page:0,cache:null,cPoniter:0,categorys:[],currentCategory:q,itemNumber:10};n.getBub=function(){return B};return function(H,I){if(!h.isNode(H)){throw"common.bubble.face need el as first parameter!"}var G=h.parseParam({l:0},I);v("general");B.setLayout(H,{offsetX:-15});B.show();return n}});STK.register("common.editor.widget.face",function(a){return function(c){var f={};var e,h,j,d;d=a.parseParam({t:0,l:-15},c);var g=function(m,n){e.API.insertText(n.value);h.getBub().hide()};var b=function(){a.core.evt.preventDefault();h=a.common.bubble.face(e.nodeList[j],d);a.custEvent.add(h,"insert",g);a.custEvent.add(h,"hide",function(){a.custEvent.remove(h,"hide",arguments.callee);a.custEvent.remove(h,"insert",g)})};f.init=function(m,n,o){e=m;j=n;a.addEvent(m.nodeList[j],"click",b)};f.clear=function(){};f.show=function(){};f.hide=function(){};f.destroy=function(){e=null};return f}});STK.register("kit.extra.crc32",function(a){return function(f,d){function j(p){p=p.replace(/\r\n/g,"\n");var o="";for(var r=0;r<p.length;r++){var q=p.charCodeAt(r);if(q<128){o+=String.fromCharCode(q)}else{if((q>127)&&(q<2048)){o+=String.fromCharCode((q>>6)|192);o+=String.fromCharCode((q&63)|128)}else{o+=String.fromCharCode((q>>12)|224);o+=String.fromCharCode(((q>>6)&63)|128);o+=String.fromCharCode((q&63)|128)}}}return o}f=j(f);var m="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";var d;if(typeof(d)=="undefined"){d=0}var h=0;var g=0;d=d^(-1);for(var c=0,b=f.length;c<b;c++){g=(d^f.charCodeAt(c))&255;h="0x"+m.substr(g*9,8);d=(d>>>8)^h}var e=d^(-1);if(e<0){e=4294967296+e}return e}});STK.register("common.extra.imageURL",function(a){return function(e,c){var j={size:"small"};j=a.core.obj.parseParam(j,c);var n=j.size;function f(o){o=(o+"").replace(/[^a-f0-9]/gi,"");return parseInt(o,16)}var h={ss:{middle:"&690",bmiddle:"&690",small:"&690",thumbnail:"&690",square:"&690",orignal:"&690"},ww:{middle:"bmiddle",large:"large",bmiddle:"bmiddle",small:"small",thumbnail:"thumbnail",square:"square",orignal:"large"}};if(e.indexOf("https")!=-1||e.indexOf("http")!=-1){return e}var b=(e.charAt(9)=="w"||e.charAt(9)=="y");var g=e.charAt(21)=="g"?".gif":".jpg";var m=b?(a.kit.extra.crc32(e)%4+1):(f(e.substr(19,2))%16+1);var d="//"+(b?"ww":"ss")+m+".sinaimg.cn/"+(b?h.ww[n]:n)+"/"+e+(b?g:"")+(b?"":h.ss[n]);return d}});STK.register("module.editorPlugin.tab",function(a){return function(r,m){var s=a.core.evt.addEvent,h=a.core.dom.addClassName,n=a.core.dom.removeClassName,g=a.core.arr.isArray,j=a.core.evt.preventDefault,e=a.core.dom.setStyle,d,c,q,u,b,t,o;function p(A){var z=(g(q))?q[A]:q,x=d[A],y=g(c)?c[A]:null;otNode=d[o],odNode=g(c)?c[o]:null;if(y){e(c[o],"display","none");e(c[A],"display","")}n(d[o],b);h(d[A],b);if(A==o){return}z({idx:A,node:y});o=A}function w(){if(!g(d)){throw"module.editorPlugin.tab needs tNodes as Array!"}if(!g(c)){throw"module.editorPlugin.tab needs tNodes as Array!"}if(d.length!=c.length){throw"module.editorPlugin.tab needs tNodes'length equal to dNodes'length!"}}function v(z,y){var A={evtType:"click",tNodes:"",dNodes:"",className:"cur",cb:function(){},defaultIdx:0};A=a.core.obj.parseParam(A,y);q=A.cb;b=A.className;o=A.defaultIdx;u=A.evtType;d=(typeof A.tNodes=="string")?a.sizzle(A.tNodes,z):A.tNodes;t=d.length;if(A.dNodes!==""){c=(typeof A.dNodes=="string")?a.sizzle(A.dNodes,z):A.dNodes;w()}for(var x=0;x<t;x++){s(d[x],u,function(B){return function(){j();p(B)}}(x))}}var f={};f.initView=function(z){z=z||m.defaultIdx;e(c[z],"display","");h(d[z],b);var y=(g(q))?q[z]:q,x=g(c)?c[z]:null;y({idx:z,node:x});o=z};f.refresh=function(x){d[x]&&a.fireEvent(d[x],"click")};v(r,m);return f}});STK.register("kit.extra.swfobject",function(b){var a=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var c=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,g=aB.userAgent.toLowerCase(),e=aB.platform.toLowerCase(),m=e?/win/.test(e):/win/.test(g),o=e?/mac/.test(e):/mac/.test(g),j=/webkit/.test(g)?parseFloat(g.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,f=!+"\v1",h=[0,0,0],p=null;if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){p=aB.plugins[ab].description;if(p&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;f=false;p=p.replace(/^.*\s+(\S+\s+\S+$)/,"$1");h[0]=parseInt(p.replace(/^(.*)\..*$/,"$1"),10);h[1]=parseInt(p.replace(/^.*\.(.*)\s.*$/,"$1"),10);h[2]=/[a-zA-Z]/.test(p)?parseInt(p.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof af.ActiveXObject!=aq){try{var n=new ActiveXObject(X);if(n){p=n.GetVariable("$version");if(p){f=true;p=p.split(" ")[1].split(",");h=[parseInt(p[0],10),parseInt(p[1],10),parseInt(p[2],10)]}}}catch(d){}}}return{w3:c,pv:h,wk:j,ie:f,win:m,mac:o}}(),aK=function(){if(!ah.w3){return}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP()}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false)}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);aP()}});if(af==top){(function(){if(ak){return}try{aL.documentElement.doScroll("left")}catch(c){setTimeout(arguments.callee,0);return}aP()})()}}if(ah.wk){(function(){if(ak){return}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);return}aP()})()}aC(aP)}}();function aP(){if(ak){return}try{var d=aL.getElementsByTagName("body")[0].appendChild(ar("span"));d.parentNode.removeChild(d)}catch(c){return}ak=true;var f=Z.length;for(var e=0;e<f;e++){Z[e]()}}function aj(c){if(ak){c()}else{Z[Z.length]=c}}function aC(c){if(typeof af.addEventListener!=aq){af.addEventListener("load",c,false)}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",c,false)}else{if(typeof af.attachEvent!=aq){aM(af,"onload",c)}else{if(typeof af.onload=="function"){var d=af.onload;af.onload=function(){d();c()}}else{af.onload=c}}}}}function aN(){if(aa){Y()}else{am()}}function Y(){var f=aL.getElementsByTagName("body")[0];var d=ar(aD);d.setAttribute("type",aE);var c=f.appendChild(d);if(c){var e=0;(function(){if(typeof c.GetVariable!=aq){var g=c.GetVariable("$version");if(g){g=g.split(" ")[1].split(",");ah.pv=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]}}else{if(e<10){e++;setTimeout(arguments.callee,10);return}}f.removeChild(d);c=null;am()})()}else{am()}}function am(){var j=aG.length;if(j>0){for(var m=0;m<j;m++){var e=aG[m].id;var q=aG[m].callbackFn;var c={success:false,id:e};if(ah.pv[0]>0){var n=aS(e);if(n){if(ao(aG[m].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(e,true);if(q){c.success=true;c.ref=av(e);q(c)}}else{if(aG[m].expressInstall&&au()){var g={};g.data=aG[m].expressInstall;g.width=n.getAttribute("width")||"0";g.height=n.getAttribute("height")||"0";if(n.getAttribute("class")){g.styleclass=n.getAttribute("class")}if(n.getAttribute("align")){g.align=n.getAttribute("align")}var h={};var f=n.getElementsByTagName("param");var p=f.length;for(var o=0;o<p;o++){if(f[o].getAttribute("name").toLowerCase()!="movie"){h[f[o].getAttribute("name")]=f[o].getAttribute("value")}}ae(g,h,e,q)}else{aF(n);if(q){q(c)}}}}}else{ay(e,true);if(q){var d=av(e);if(d&&typeof d.SetVariable!=aq){c.success=true;c.ref=d}q(c)}}}}}function av(d){var f=null;var e=aS(d);if(e&&e.nodeName=="OBJECT"){if(typeof e.SetVariable!=aq){f=e}else{var c=e.getElementsByTagName(aD)[0];if(c){f=c}}}return f}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312)}function ae(h,f,m,g){aU=true;ap=g||null;at={success:false,id:m};var c=aS(m);if(c){if(c.nodeName=="OBJECT"){aJ=aO(c);ad=null}else{aJ=c;ad=m}h.id=ac;if(typeof h.width==aq||(!/%$/.test(h.width)&&parseInt(h.width,10)<310)){h.width="310"}if(typeof h.height==aq||(!/%$/.test(h.height)&&parseInt(h.height,10)<137)){h.height="137"}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";var d=ah.ie&&ah.win?"ActiveX":"PlugIn",e="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+d+"&MMdoctitle="+aL.title;if(typeof f.flashvars!=aq){f.flashvars+="&"+e}else{f.flashvars=e}if(ah.ie&&ah.win&&c.readyState!=4){var j=ar("div");m+="SWFObjectNew";j.setAttribute("id",m);c.parentNode.insertBefore(j,c);c.style.display="none";(function(){if(c.readyState==4){c.parentNode.removeChild(c)}else{setTimeout(arguments.callee,10)}})()}aA(h,f,m)}}function aF(c){if(ah.ie&&ah.win&&c.readyState!=4){var d=ar("div");c.parentNode.insertBefore(d,c);d.parentNode.replaceChild(aO(c),d);c.style.display="none";(function(){if(c.readyState==4){c.parentNode.removeChild(c)}else{setTimeout(arguments.callee,10)}})()}else{c.parentNode.replaceChild(aO(c),c)}}function aO(d){var f=ar("div");if(ah.win&&ah.ie){f.innerHTML=d.innerHTML}else{var g=d.getElementsByTagName(aD)[0];if(g){var c=g.childNodes;if(c){var h=c.length;for(var e=0;e<h;e++){if(!(c[e].nodeType==1&&c[e].nodeName=="PARAM")&&!(c[e].nodeType==8)){f.appendChild(c[e].cloneNode(true))}}}}}return f}function aA(g,j,e){var f,c=aS(e);if(ah.wk&&ah.wk<312){return f}if(c){if(typeof g.id==aq){g.id=e}if(ah.ie&&ah.win){var h="";for(var n in g){if(g[n]!=Object.prototype[n]){if(n.toLowerCase()=="data"){j.movie=g[n]}else{if(n.toLowerCase()=="styleclass"){h+=' class="'+g[n]+'"'}else{if(n.toLowerCase()!="classid"){h+=" "+n+'="'+g[n]+'"'}}}}}var m="";for(var o in j){if(j[o]!=Object.prototype[o]){m+='<param name="'+o+'" value="'+j[o]+'" />'}}c.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+h+">"+m+"</object>";ag[ag.length]=g.id;f=aS(g.id)}else{var d=ar(aD);d.setAttribute("type",aE);for(var p in g){if(g[p]!=Object.prototype[p]){if(p.toLowerCase()=="styleclass"){d.setAttribute("class",g[p])}else{if(p.toLowerCase()!="classid"){d.setAttribute(p,g[p])}}}}for(var q in j){if(j[q]!=Object.prototype[q]&&q.toLowerCase()!="movie"){aQ(d,q,j[q])}}c.parentNode.replaceChild(d,c);f=d}}return f}function aQ(d,f,e){var c=ar("param");c.setAttribute("name",f);c.setAttribute("value",e);d.appendChild(c)}function aw(c){var d=aS(c);if(d&&d.nodeName=="OBJECT"){if(ah.ie&&ah.win){d.style.display="none";(function(){if(d.readyState==4){aT(c)}else{setTimeout(arguments.callee,10)}})()}else{d.parentNode.removeChild(d)}}}function aT(c){var d=aS(c);if(d){for(var e in d){if(typeof d[e]=="function"){d[e]=null}}d.parentNode.removeChild(d)}}function aS(c){var e=null;try{e=aL.getElementById(c)}catch(d){}return e}function ar(c){return aL.createElement(c)}function aM(c,e,d){c.attachEvent(e,d);al[al.length]=[c,e,d]}function ao(c){var d=ah.pv,e=c.split(".");e[0]=parseInt(e[0],10);e[1]=parseInt(e[1],10)||0;e[2]=parseInt(e[2],10)||0;return(d[0]>e[0]||(d[0]==e[0]&&d[1]>e[1])||(d[0]==e[0]&&d[1]==e[1]&&d[2]>=e[2]))?true:false}function az(d,h,c,e){if(ah.ie&&ah.mac){return}var g=aL.getElementsByTagName("head")[0];if(!g){return}var j=(c&&typeof c=="string")?c:"screen";if(e){aH=null;an=null}if(!aH||an!=j){var f=ar("style");f.setAttribute("type","text/css");f.setAttribute("media",j);aH=g.appendChild(f);if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1]}an=j}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(d,h)}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(d+" {"+h+"}"))}}}function ay(c,e){if(!aI){return}var d=e?"visible":"hidden";if(ak&&aS(c)){aS(c).style.visibility=d}else{az("#"+c,"visibility:"+d)}}function ai(d){var c=/[\\\"<>\.;]/;var e=c.exec(d)!=null;return e&&typeof encodeURIComponent!=aq?encodeURIComponent(d):d}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var c=al.length;for(var d=0;d<c;d++){al[d][0].detachEvent(al[d][1],al[d][2])}var f=ag.length;for(var e=0;e<f;e++){aw(ag[e])}for(var g in ah){ah[g]=null}ah=null;for(var h in a){a[h]=null}a=null})}}();return{registerObject:function(c,g,e,d){if(ah.w3&&c&&g){var f={};f.id=c;f.swfVersion=g;f.expressInstall=e;f.callbackFn=d;aG[aG.length]=f;ay(c,false)}else{if(d){d({success:false,id:c})}}},getObjectById:function(c){if(ah.w3){return av(c)}},embedSWF:function(p,g,m,h,e,c,d,n,j,o){var f={success:false,id:g};if(ah.w3&&!(ah.wk&&ah.wk<312)&&p&&g&&m&&h&&e){ay(g,false);aj(function(){m+="";h+="";var v={};if(j&&typeof j===aD){for(var t in j){v[t]=j[t]}}v.data=p;v.width=m;v.height=h;var s={};if(n&&typeof n===aD){for(var u in n){s[u]=n[u]}}if(d&&typeof d===aD){for(var q in d){if(typeof s.flashvars!=aq){s.flashvars+="&"+q+"="+d[q]}else{s.flashvars=q+"="+d[q]}}}if(ao(e)){var r=aA(v,s,g);if(v.id==g){ay(g,true)}f.success=true;f.ref=r}else{if(c&&au()){v.data=c;ae(v,s,g,o);return}else{ay(g,true)}}if(o){o(f)}})}else{if(o){o(f)}}},switchOffAutoHideShow:function(){aI=false},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]}},hasFlashPlayerVersion:ao,createSWF:function(c,d,e){if(ah.w3){return aA(c,d,e)}else{return undefined}},showExpressInstall:function(d,c,f,e){if(ah.w3&&au()){ae(d,c,f,e)}},removeSWF:function(c){if(ah.w3){aw(c)}},createCSS:function(d,c,e,f){if(ah.w3){az(d,c,e,f)}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(d){var c=aL.location.search||aL.location.hash;if(c){if(/\?/.test(c)){c=c.split("?")[1]}if(d==null){return ai(c)}var e=c.split("&");for(var f=0;f<e.length;f++){if(e[f].substring(0,e[f].indexOf("="))==d){return ai(e[f].substring((e[f].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(aU){var c=aS(ac);if(c&&aJ){c.parentNode.replaceChild(aJ,c);if(ad){ay(ad,true);if(ah.ie&&ah.win){aJ.style.display="block"}}if(ap){ap(at)}}aU=false}}}}();return a});STK.register("common.flash.imgUpload",function(c){var e=document.documentElement,a=document.body;var d={getScroll:function(){var j,g,f,m;if(e&&e.scrollTop){j=e.scrollTop;g=e.scrollLeft;f=e.scrollWidth;m=e.scrollHeight}else{if(a){j=a.scrollTop;g=a.scrollLeft;f=a.scrollWidth;m=a.scrollHeight}}return{t:j,l:g,w:f,h:m}},getScreen:function(){var f={};if(c.IE){f.w=e.clientWidth;f.h=e.clientHeight}else{f.w=window.innerWidth;f.h=window.innerHeight}return f}};var b=function(f){var g={cn:"zh_CN",tw:"zh_TW"};f=f.toLowerCase();f=f.replace(/zh-/g,"");return g[f]};return function(g,p){var m={version:$CONFIG.version,swf_path:$CONFIG.jsPath+"home/static/swf/img/",service:g.service,ed_swf:g.swf||"PhotoEditor.swf",exp_swf:"expressInstall.swf",h:g.h||385,w:g.w||528,f_version:"10.0.0",channel:g.id+"_channel",id_panel:g.id+"_panel",id_swf:g.id+"_swf"};var j={},q,f;var o={init:function(){p.init&&p.init(j,g)},setHeight:function(r){if(!c.IE){n.getFlash(m.id_swf).height=r}},upComplate:function(r){g.sucess&&g.sucess(r);q.style.display="none";j.destory()},closeEditor:function(){q.style.display="none";j.destory();p.close&&p.close(j,g)},suda:function(r){SUDA&&SUDA.uaTrack&&SUDA.uaTrack("meitu","v4||"+r)}};var h={version:m.version,language:b($CONFIG.lang),channel:m.channel,JSHandler:"STK.core.util.listener.fire",initFun:"init",changeFlashHeightFun:"setHeight",uploadCompleteFun:"upComplate",closePhotoEditorFun:"closeEditor",suda:"suda"};var n={init:function(){if(!g.id){return}q=c.E(m.id_panel);f=c.E(m.id_swf);if(!q){q=c.C("div");q.id=m.id_panel;a.appendChild(q)}if(!f){f=c.C("div");f.id=m.id_swf;q.appendChild(f)}q.style.display="none";if(!n.getFlash(m.id_swf)){n.build()}},checkAction:function(s,r){var t=STK.core.util.listener.list;return !!(t[s]&&t[s][r])},bindEvt:function(r){for(key in r){o[r[key]]&&!n.checkAction(m.channel,r[key])&&STK.core.util.listener.register(m.channel,r[key],o[r[key]])}},build:function(){var s={menu:"true",scale:"noScale",allowFullscreen:"true",allowScriptAccess:"always",bgcolor:"#FFFFFF",wmode:c.IE?"window":"transparent",base:m.swf_path};var r={id:g.id};n.bindEvt(h);c.kit.extra.swfobject.embedSWF(m.swf_path+m.ed_swf+"?version="+m.version,m.id_swf,m.w,m.h,m.f_version,m.swf_path+m.exp_swf,h,s,r)},getFlash:function(){if(navigator.appName.indexOf("Microsoft")!=-1){return window[g.id]}else{return document[g.id]}},setPos:function(){var u,r,v,s,x=d.getScroll(),w=d.getScreen();v=Math.round(m.h>w.h?(w.h/5+x.t):((w.h-m.h)/2+x.t));s=Math.round(m.w>w.w?(w.w/5+x.l):((w.w-m.w)/2+x.l));u=(g.pos.t-1)||v;r=g.pos.l||s;q.style.zIndex=g.zIndex||20000;c.setStyle(q,"position","absolute");c.setStyle(q,"left",r+"px");c.setStyle(q,"top",u+"px");n.autoScroll(x.t,x.t+(u-v))},autoScroll:function(t,r,s){var y,x,u,v=8,w;v=s||v;w=t-r;x=[w];x[v]=0;u=1;for(u;u<v;u++){x[u]=(w=w/2)}clearInterval(y);y=setInterval(function(){if(x.length){window.scrollTo(0,r+x.shift());return}clearInterval(y)},30)}};j.show=function(r){r&&(g.id=r);q&&(q.style.display="");n.setPos();return this};j.hide=function(){q&&(q.style.display="");return this};j.setPars=function(s){var r={imageURL:s||"",uploadURL:m.service};n.getFlash(m.id_swf).editPhoto(r);return this};j.getSwf=n.getFlash;j.destory=function(){if(c.IE){for(key in h){o[h[key]]&&STK.core.util.listener.remove(m.channel,h[key],o[h[key]])}q.innerHTML=""}};n.init();return j}});STK.register("common.trans.editor",function(c){var a=c.kit.io.inter();var b=a.register;b("face",{url:"/aj/mblog/face?type=face"});b("magicFace",{url:"/ajax/mblog/face?type=ani"});b("getTopic",{url:"/aj/mblog/trend"});b("cartoon",{url:"/ajax/mblog/face?type=cartoon"});b("suggestMusic",{url:"/aj/mblog/music/suggest",requestMode:"jsonp"});b("searchMusic",{url:"/aj/mblog/music/search",requestMode:"jsonp"});b("addMusic",{url:"/aj/mblog/music/submit",requestMode:"jsonp"});b("parseMusic",{url:"/aj/mblog/music/parse",requestMode:"jsonp"});b("parseVideo",{url:"/aj/mblog/video"});b("waterMark",{url:"/ajax/account/watermark"});b("publishToWeiqun",{url:"/aj/weiqun/add",method:"post"});b("rectopic",{url:"/aj/mblog/rectopic"});b("interactive",{url:"/aj/mblog/interactive",method:"post"});b("plugin",{url:"/aj/publishplug/plug",method:"post"});b("favSongSearch",{url:"//music.weibo.com/yueku/port/sina_t_getcollect.php",method:"get",requestMode:"jsonp"});b("getOutlinkInfo",{url:"//api.weibo.com/widget/info.json",varkey:"callback",method:"get",requestMode:"jsonp"});b("tabLog",{url:"//music.weibo.com/t/port/ajax_log_action.php",method:"get",requestMode:"jsonp"});return a});STK.register("common.bubble.image",function(E){var g=window.$CONFIG;var O='<div node-type="outer"><div class="layer_send_pic" node-type="wrap"><div node-type="inner"><div class="tab W_textb"><p><a class="current" href="javascript:void(0);" node-type="tab">#L{}</a><a href="javascript:void(0);" node-type="tab">#L{}</a></p></div><div node-type="content"></div></div><div node-type="uploaded" style="display:none"><div class="laPic_tit"><span node-type="pName"></span><span class="right"></span></div><div node-type="picWrap" class="laPic_Pic"></div><div class="lapic_edit"><a class="beautify" href="javascript:void(0);" node-type="beautify" action-type="beautify" suda-data="key=meitu&value=v4||publish||editor">#L{}</a><a class="delete" href="javascript:void(0);" action-type="delete">#L{}</a></div></div></div><div node-type="flashPanel"></div>';var e='<div node-type="uppic">	<div class="laPic_btnBox clearfix">		<div class="laPic_btnmore">			<a href="javascript:void(0);" class="S_btn_b choose_pic" node-type="inputCover">				<span><em class="ico_one"></em>#L{}</span>				<form node-type="form" action-type="form" id="pic_upload" name="pic_upload" target="upload_target" enctype="multipart/form-data" method="POST" action="">					<input class="input_f" type="file" hidefoucs="true" style="" node-type="fileBtn" name="pic1"/>				</form></a>		</div>		<div class="laPic_btnmore">			<a href="javascript:void(0);" class="S_btn_b choose_pic" node-type="inputCover">				<span action-type="more" suda-data="key=meitu&value=v4||publish||more"><em class="ico_ones"></em>#L{}</span>			</a>		</div>	</div>	<div class="laPic_con W_textb"  node-type="info">#L{5Mgifjpgpng}</div></div><div node-type="loading"  style="width:230px;display:none"><div class="laPic_con"><div><i class="W_loading S_loading"></i><span>#L{}...</span></div></div><div class="laPic_btn"><a href="javascript:void(0);" class="Sbtn_a" action-type="cancel"><span>#L{}</span></a></div></div>';var c='<p class="tab_kind W_linkb"><span class="right"><a class="pre_d" action-type="prev" node-type="prev" href="javascript:void(0);"></a><a class="next" action-type="next" node-type="next" href="javascript:void(0);"></a></span><em node-type="categorys"></em></p><div node-type="loading"></div><div class="detail"><ul node-type="list" class="faces_magic_list clearfix"></ul><div node-type="page" class="W_pages_minibtn"></div></div>';var R='<div><i class="W_loading S_loading"></i><span>...</span></div>';var b='<a href="javascript:void(0);" onclick="return false;" action-type="category" action-data="category=#{item}">#{item}</a>';var n='<a href="javascript:void(0);"  onclick="return false;" action-type="category" action-data="category=#{item}" class="current W_texta">#{item}</a>';var A='<li><a action-type="insertSmiley" action-data="url=#{thumb}&pid=#{picid}&value=#{value}" class="img" href="javascript:void(0);"><img src="#{thumb}" original="#{original}" title="#{value}" alt="#{phrase}" /></a><span title="#{value}"  action-type="insertSmiley" action-data="url=#{thumb}&pid=#{picid}&value=#{value}">#{phrase}</span></li>';var x='<a action-type="page" action-data="num=#{number}" href="javascript:void(0);" >#{label}</a>';var N='<a action-type="page" action-data="num=#{number}" href="javascript:void(0);"  class="current"  onclick="return false;">#{label}</a>';var q='<em class="W_vline">|</em>';var H="";var o="#L{}";var w=5;var I="weibo.com/";var v,a,B,m,f,F,D,G;var y,P,s;var J={};var z={page:0,cache:null,cPoniter:0,categorys:[],currentCategory:H,itemNumber:10};var K,r;var M=E.core.dom.position;var h=E.core.evt.addEvent;var p=E.core.evt.removeEvent;var j=E.kit.extra.language;var d=function(){E.custEvent.define(J,"uploaded");E.custEvent.define(J,"hide");E.custEvent.define(J,"insert");E.custEvent.define(J,"deletePIC");E.custEvent.define(J,"picLoad");E.custEvent.add(v,"hide",(function(L){return function(){E.custEvent.remove(L,"hide",arguments.callee);E.custEvent.fire(J,"hide",{})}})(v));E.module.editorPlugin.tab(a,{evtType:"click",tNodes:'[node-type="tab"]',className:"current",cb:[t.init,C.init]});s=E.core.evt.delegatedEvent(a);t.bind()};var t={init:function(){t.initDom();t.bind()},initDom:function(){var L;F=t;K.wrap.className="layer_send_pic";K.content.innerHTML=j(e);K.close=(v.getDomList().close)[0];L=E.kit.dom.parseDOM(E.core.dom.builder(a).list);K=E.kit.extra.merge(K,L);t.exchangeInput()},bind:function(){h(K.inputCover,"mousemove",t.ajust);h(K.fileBtn,"change",Q.upload);s.add("delete","click",t.deletePic);s.add("cancel","click",t.cancelUpload);s.add("more","click",t.morePic);s.add("beautify","click",t.beautify)},destroy:function(){p(K.inputCover,"mousemove",t.ajust);p(K.fileBtn,"change",Q.upload)},handle:function(L){if(!L||L.ret<0){var S="";switch(Math.abs(L.ret)){case 1:S="#L{}";break;case 4:S="#L{5MJPGGIFPNG}";break;default:S="#L{}"}L?t.sendError({ret:L.ret}):t.sendError({ret:"none"});E.ui.alert(j(S),{OK:function(){if(L.ret==-1){window.location.reload()}v.hide()}})}else{t.stopUpload();if(f){K.uppic.style.display="";f=false}else{t.rendSucc(L)}}},sendError:function(U){var L=new Image(),T=encodeURIComponent(window.navigator.userAgent);var S=E.kit.extra.merge(U,{ua:T,rnd:(new Date()).getTime(),uid:$CONFIG?$CONFIG.uid:0,referer:encodeURIComponent(r)});S=E.core.json.jsonToQuery(S);S="//ww1.sinaimg.cn/do_not_delete/fc.html?"+S;L.setAttribute("src",S)},rendLoad:function(){v.stopBoxClose();K.uppic.style.display="none";K.loading.style.display=""},ajust:function(Y){var ac=E.fixEvent(Y);var L=K.inputCover;var T=K.fileBtn;var Z=M(L);var aa=E.scrollPos();var U=aa.top+ac.clientY;var V=aa.left+ac.clientX;var X=parseInt(T.offsetWidth/2),W=parseInt(T.offsetHeight/2);var ab=U-Z.t;var ad=V-Z.l;var S=[];S.push("left:"+(ad-X)+"px");S.push("top:"+(ab-W)+"px");T.style.cssText=S.join(";")},rendSucc:function(U){var T=E.common.extra.imageURL(U.pid);var L=[],S,V;y=y||U.pid;L=y.split(/\/|\\/);S=L[L.length-1];L=S.split(".");if(L.length>1&&E.bLength(L[0])>20){L[0]=E.leftB(L[0],20);V=[L[0],"...",L[1]].join("")}else{V=S}G=U.pid;Q.loadPic({url:T,value:V,pid:U.pid});K.beautify&&(K.beautify.style.display="")},deletePic:function(){K.close.style.display="";K.inner.style.display="";K.wrap.style.width="";K.uploaded.style.display="none";K.picWrap.innerHTML="";K.fileBtn.value="";F.destroy();F.init();v.startBoxClose();E.custEvent.fire(J,"deletePIC",{text:j(o)})},stopUpload:function(){K.loading.style.display="none";K.uppic.style.display=""},cancelUpload:function(){f=true;v.startBoxClose();t.stopUpload()},exchangeInput:function(){var V=K.fileBtn;var U=V.parentNode;var L=V.className;var S=V.name;var T=E.C("input");T.className=L;T.name=S;T.type="file";T.hidefocus="true";K.fileBtn=T;U.removeChild(V);U.appendChild(T)},beautifySucess:function(L){y=L;t.handle({pid:L})},morePic:function(){v.stopBoxClose();var L=function(W){var U=W.nickname!="0"||W.logo!="0"||W.domain!="0";var S=g&&g.nick||"";var V="//picupload.service.weibo.com/interface/pic_upload.php?app=miniblog&marks="+(U?"1":"0")+(W.logo=="1"?"&logo=1":"")+(W.nickname=="1"?("&nick="+(S?encodeURIComponent("@"+S):"")):"")+(W.domain=="1"?("&url="+I+(g&&g.watermark||g.domain)):"")+(W.position?"&markpos="+W.position:"")+"&s=xml&cb=http://weibo.com/upimgback.html&rq=http%3A%2F%2Fphoto.i.weibo.com%2Fpic%2Fadd.php%3Fapp%3D1";var T={id:"photo_merge",pos:v.getPosition(),service:V,sucess:t.beautifySucess,h:470,w:528,swf:"SinaCollage.swf"};E.common.flash.imgUpload(T,{init:function(Y,X){Y.setPars()},close:function(Y,X){setTimeout(function(){v.startBoxClose()},100)}}).show()};D?L(D):Q.getWaterMark(L)},beautify:function(){var L={id:"photo_editor",pos:v.getPosition(),service:"//picupload.service.weibo.com/interface/pic_upload.php?app=miniblog&s=xml&cb=http://weibo.com/upimgback.html&rq=http%3A%2F%2Fphoto.i.weibo.com%2Fpic%2Fadd.php%3Fapp%3D1",sucess:t.beautifySucess,h:385,w:528,swf:"PhotoEditor.swf"};E.common.flash.imgUpload(L,{init:function(T,S){T.setPars(E.common.extra.imageURL(G,{size:"large"}))},close:function(T,S){}}).show()}};var C={init:function(){var L;K.wrap.className="content layer_faces";F=C;t.destroy();K.content.innerHTML=j(c);L=E.kit.dom.parseDOM(E.core.dom.builder(a).list);K=E.kit.extra.merge(K,L);if(!P){K.loading.innerHTML=j(R)}C.cartoonStart();C.bind()},bind:function(){s.add("insertSmiley","click",function(L){STK.core.evt.preventDefault();K.beautify&&(K.beautify.style.display="none");var S=L.data.url;var U=L.data.pid;var T=L.data.value;Q.loadPic({url:S,value:T,pid:U})});s.add("category","click",function(L){z.page=0;z.currentCategory=L.data.category;C.rend();setTimeout(function(){C.rendCategory(z);C.rendPage(z)},0)});s.add("prev","click",function(L){var S=z.cPoniter;if(S<=0){return false}z.cPoniter-=w;C.rendCategory(z)});s.add("next","click",function(S){var T=z.cPoniter;var L=z.categorys;if(T>=L.length-w){return false}z.cPoniter+=w;C.rendCategory(z)});s.add("page","click",function(L){z.page=parseInt(L.data.num,10);C.rend();setTimeout(function(){C.rendPage(z)},0);return STK.preventDefault(L.evt)})},cartoonStart:function(){E.common.trans.editor.getTrans("cartoon",{onSuccess:function(S,T){z.cache=S.data.more||{};z.categorys=[H];for(var L in z.cache){z.categorys.push(L)}z.cache[H]=S.data.usual.norm;C.cartoonStart=function(){z.page=0;z.cPoniter=0;z.currentCategory=H;C.rend();C.rendCategory(z);C.rendPage(z)};C.cartoonStart()}}).request({})},rend:function(T,S){var W=z.currentCategory;var V=z.cache[W];var U=z.page;var L=z.itemNumber;V=V.slice(U*L,U*L+L);V=E.foreach(V,function(Y,X){if(E.bLength(Y.phrase)>8){Y.phrase=[E.leftB(Y.phrase,6),"..."].join("")}return E.templet(j(A),Y)});K.loading.innerHTML="";K.list.innerHTML=V.join("")},rendCategory:function(S){var V=S.cPoniter;var L=S.categorys;var U=S.currentCategory;var T=L.slice(V,V+w);T=E.foreach(T,function(X,W){if(U===X){return E.templet(j(n),{item:X})}else{return E.templet(j(b),{item:X})}});K.categorys.innerHTML=T.join(q);if(V+6>=L.length){["next"].className="next_d"}else{K.next.className="next"}if(V<=0){K.prev.className="pre_d"}else{K.prev.className="pre"}},rendPage:function(S){var V=S.page;var U=S.cache[S.currentCategory];var T=U.length/S.itemNumber;var W=[];for(var L=0;L<T;L+=1){if(V==L){W.push(E.templet(j(N),{number:L,label:L+1}))}else{W.push(E.templet(j(x),{number:L,label:L+1}))}}K.page.innerHTML=W.join("")},destroy:function(){}};var Q={trans:function(L){E.core.io.ijax({url:"//picupload.service.weibo.com/interface/pic_upload.php",form:STK.E("pic_upload"),abaurl:"//"+document.domain+"/static/upimgback.html",abakey:"cb",timeout:1800*1000,onComplete:t.handle,onTimeout:t.handle,args:{marks:1,app:"miniblog",s:"rdxt",url:(L.domain=="1")?I+(g&&g.watermark||g.domain):0,markpos:L.position||"",logo:L.logo||"",nick:(L.nickname=="1")?"@"+(g&&g.nick):0}})},getWaterMark:function(L){E.common.trans.editor.getTrans("waterMark",{onSuccess:function(S,T){D=S.data;L&&L(D)}}).request()},upload:function(){y=K.fileBtn.value;if(E.core.str.trim(y)===""){return}t.rendLoad();D?Q.trans(D):Q.getWaterMark(Q.trans)},loadPic:function(T){K.picWrap.innerHTML="";var S=T.url;var U=K.close;var L=E.C("img");if(T.value){K.pName.innerHTML=T.value}L.src=S;v.stopBoxClose();E.core.evt.custEvent.fire(J,"uploaded",{text:j(o),pid:T.pid});K.wrap.style.display="";K.wrap.className="layer_send_pic";K.wrap.style.width="240px";K.inner.style.display="none";K.uploaded.style.display="";U.style.display="none";K.picWrap.appendChild(L)}};var u={};(function(){if(g&&g.bigpipe==="true"){E.historyM.onpopstate(function(L,S){if(S){v.stopBoxClose();v.hide()}})}})();J.getBub=function(){return v};return function(S,T){if(!E.isNode(S)){throw"common.bubble.image need el as first parameter!"}r=window.location.href;K=E.kit.dom.parseDOM(E.core.dom.builder(j(O)).list);a=K.outer;v=E.ui.bubble();t.initDom();if(T&&T.pid){var L=E.common.extra.imageURL(T.pid);Q.loadPic({url:L,pid:T.pid})}d();v.setContent(a);v.setLayout(S,{offsetX:-29,offsetY:5});J.bubble=v;J.setPic=function(U){t.rendSucc({pid:U})};v.show();return J}});STK.register("common.editor.widget.image",function(a){return function(e){a.log(e);var f={};var g,d,m,n,c;var o=function(p,q){g.API.insertText(q.value);d.getBub().hide()};var b=function(p,q){a.log("upload");var r=g.API.getWords();if(r.length==0){g.API.insertText(q.text)}g.API.addExtraInfo(q.pid);n=true};var h=function(p,q){g.API.delWords(q.text);g.API.addExtraInfo("");clearInterval(c)};var j=function(p){if(n){return}d=a.common.bubble.image(g.nodeList[m]);a.custEvent.add(d,"uploaded",b);a.log(2222);a.custEvent.add(d,"insert",o);a.custEvent.add(d,"deletePIC",h);a.custEvent.add(d,"hide",function(){a.custEvent.remove(d,"hide",arguments.callee);a.custEvent.remove(d,"uploaded",b);a.custEvent.remove(d,"insert",o);a.custEvent.remove(d,"deletePIC",h);a.custEvent.remove(d,"changeType");n=false});if(typeof p=="string"){d.setPic(p)}};f.init=function(p,q,r){g=p;m=q;a.addEvent(p.nodeList[m],"click",j);if(r&&r.pid){j(r.pid)}};f.clear=function(){};f.show=function(){};f.hide=function(){if(d){d.getBub().hide()}};f.resetBubble=function(p){if(d){d.bubble.setLayout(p,{offsetX:-29,offsetY:5})}};f.destroy=function(){g=null};return f}});STK.register("common.channel.feed",function(b){var a=["forward","publish","comment","delete","refresh","reply","feedTagUpdate"];return b.common.listener.define("common.channel.feed",a)});STK.register("common.channel.dialog",function(b){var a=["submit","close"];return b.common.listener.define("common.channel.dialog",a)});STK.register("common.trans.validateCode",function(d){var b=d.kit.io.inter();var a="/ajax/";var c=b.register;c("checkAnswer",{url:a+"pincode/verified?",method:"post"});return b});STK.register("kit.io.cssLoader",function(d){var b="";var a="//img.t.sinajs.cn/t4/";var e="//timg.sjs.sinajs.cn/t4/";if(typeof $CONFIG!="undefined"){a=$CONFIG.cssPath||a;b=$CONFIG.version||""}var c={};return function(g,o,j,m,s){m=m||b;j=j||function(){};var r=function(w,u){var v=c[w]||(c[w]={loaded:false,list:[]});if(v.loaded){u(w);return false}v.list.push(u);if(v.list.length>1){return false}return true};var n=function(v){var u=c[v].list;for(var w=0;w<u.length;w++){u[w](v)}c[v].loaded=true;delete c[v].list};if(!r(g,j)){return}var q;if(s){q=e+g}else{q=a+g+"?version="+m}var p=d.C("link");p.setAttribute("rel","Stylesheet");p.setAttribute("type","text/css");p.setAttribute("charset","utf-8");p.setAttribute("href",q);document.getElementsByTagName("head")[0].appendChild(p);var f=d.C("div");f.id=o;d.core.util.hideContainer.appendChild(f);var t=3000;var h=function(){if(parseInt(d.core.dom.getStyle(f,"height"))==42){d.core.util.hideContainer.removeChild(f);n(g);return}if(--t>0){setTimeout(h,10)}else{d.log(g+"timeout!");d.core.util.hideContainer.removeChild(f);delete c[g]}};setTimeout(h,50)}});STK.register("common.dialog.authentication",function(a){return function(d){var b=a.kit.extra.language,g=a.core.util.browser;d=a.parseParam({src:"//weibo.com/a/verify/realname?stage=home_verification&from=search",icon:"warn",isHold:true,width:"380px",height:"240px",title:b("#L{}")},d||{});var f={},h,c,j=false;var e="tblog_checkfailed_reform";var m={init:function(){!(g.IE6||g.IE7)&&(window.document.domain="weibo.com");h=a.ui.dialog(d);var p=[];p.push('<iframe id="account_authentication" name="account_authentication" node-type="frame" width="'+d.width+'" height="'+d.height+'" allowtransparency="true" scrolling="no" frameborder="0" src=""></iframe>');var o=a.builder(p.join(""));h.setTitle(d.title);h.setContent(o.box);var n=h.getDomList();a.addEvent(n.close[0],"click",function(){history.go(0)})},show:function(){try{SUDA.uaTrack&&SUDA.uaTrack(e,"checkfailed_box")}catch(o){}if(!j){a.kit.io.cssLoader("style/css/module/layer/layer_check_identity.css","js_style_css_module_layer_check_identity",function(){j=true})}h.show().setMiddle();c=a.E("account_authentication");var n=decodeURIComponent(d.src)+"&rnd=";if(c.attachEvent){c.attachEvent("onload",function(){c.height=d.height;h.setMiddle()})}else{c.onload=function(){c.height=d.height;h.setMiddle()}}c.src=n+a.core.util.getUniqueKey()},destroy:function(){},hook:function(n,p){try{if(n=="100000"){m.verifySucc()}else{m.verifyFail()}}catch(o){}},verifySucc:function(){SUDA.uaTrack&&SUDA.uaTrack(e,"checkfailed_success");h.hide();var n={title:b("#L{}"),icon:"success",OK:function(){SUDA.uaTrack&&SUDA.uaTrack(e,"checkfailed_play");history.go(0)},OKText:b("#L{}"),msg:b("#L{}")};var o=a.ui.alert(n.msg,n);a.custEvent.add(o,"hide",function(){history.go(0)})},verifyFail:function(){SUDA.uaTrack&&SUDA.uaTrack(e,"checkfailed_twotimes");h.hide();var n={title:b("#L{}"),icon:"warn",OK:function(){SUDA.uaTrack&&SUDA.uaTrack(e,"checkfailed_triple");m.show()},OKText:b("#L{}"),msg:b("#L{<br/>}")+'<a class="W_spetxt" suda-data="key=tblog_checkfailed_reform&value=checkfailed_havealook" href="//weibo.com">'+b("#L{>>}")+"</a>"};var o=a.ui.alert(n.msg,n);a.custEvent.add(o,"hide",function(){history.go(0)})}};m.init();f.destroy=m.destroy;f.show=m.show;window.App=window.App||{};window.App["checkRealName"]=m.hook;return f}});STK.register("common.layer.ioError",function(b){var c=b.kit.extra.language;var a;return function(h,e,g){g=g||function(){};var f={100001:function(){b.ui.alert(e.msg)},100002:function(){window.location.reload()},100003:function(){var j=b.parseParam({location:"",icon:"warn",title:c("#L{}"),OKText:c("#L{}"),cancelText:c("#L{}"),suda:""},e.data);j.OK=function(){b.preventDefault();var m=b.queryToJson(e.data.OKSuda||"");SUDA.uaTrack&&m.key&&SUDA.uaTrack(m.key,m.value);e.ok&&e.ok();window.location.href=j.location};j.cancel=function(){b.preventDefault();var m=b.queryToJson(e.data.cancelSuda||"");SUDA.uaTrack&&m.key&&SUDA.uaTrack(m.key,m.value);e.cancel&&e.cancel()};b.ui.confirm(e.msg,j)},100004:function(){if(!a){a=b.common.dialog.authentication({})}a.show()}};var d=f[h]||f["100001"];return d()||g(h)}});STK.register("common.dialog.validateCode",function(d){var b=d.kit.extra.language;var e="/ajax/pincode/pin?type=rule&lang=zh-cn&ts=";var a={dialog_html:'<div class="layer_veriyfycode"><div class="v_image"><img height="50" width="450" class="yzm_img" /></div><p class="v_chng"><a href="#" onclick="return false;" class="yzm_change" action-type="yzm_change">#L{}</a></p><p class="v_ans_t">#L{}</p><p class="v_ans_i"><input type="text" class="W_inputStp v_inp yzm_input ontext" action-type="yzm_input"/><div class="M_notice_del yzm_error" style="display:none;"><span class="icon_del"></span><span class="txt"></span></div></p><p class="v_btn"><a class="S_btn_b yzm_submit" href="#" action-type="yzm_submit"><span>#L{}</span></a><a class="Sbtn_a yzm_cancel" href="#" action-type="yzm_cancel" action-data="value=frombtn"><span>#L{}</span></a></p></div>'};var c;return function(){if(c){return c}var q={};var t={};var w;var h;var v;var s;var p=function(){t.yzm_error.innerHTML="";t.yzm_error.parentNode.style.display="none"};var j=function(A){t.yzm_error.innerHTML=A;t.yzm_error.parentNode.style.display=""};var o=function(){if(!w){x()}p();t.input_text.value="";w.show();f.changesrc();w.setMiddle();d.hotKey.add(document.documentElement,["esc"],f.closeDialog,{type:"keyup",disableInInput:true})};var x=function(){w=d.ui.dialog({isHold:true});w.setTitle(b("#L{}"));w.setContent(b(a.dialog_html));var A=w.getOuter();g(A);m()};var n=d.common.trans.validateCode.getTrans("checkAnswer",{onSuccess:function(C,D){var A=C.data.retcode;p();t.input_text.value="";w.hide();var B=h.requestAjax;var E=d.kit.extra.merge(h.param,{retcode:A});B.request(E);v=false},onError:function(){j(b("#L{}"));f.changesrc();v=false},onFail:function(){j(b("#L{}"));f.changesrc();v=false}});var y=function(){};var u=function(){};var g=function(A){t.vImg=d.core.dom.sizzle("img.yzm_img",A)[0];t.yzm_change=d.core.dom.sizzle("a.yzm_change",A)[0];t.yzm_submit=d.core.dom.sizzle("a.yzm_submit",A)[0];t.yzm_cancel=d.core.dom.sizzle("a.yzm_cancel",A)[0];t.input_text=d.core.dom.sizzle("input.yzm_input",A)[0];t.yzm_error=d.core.dom.sizzle("div.yzm_error span.txt",A)[0];t.close_icon=w.getDom("close")};var f={changesrc:function(){var B=e+d.getUniqueKey();t.vImg.setAttribute("src",B);try{t.yzm_change.blur()}catch(A){}},checkValidateCode:function(){p();var A=d.core.str.trim(t.input_text.value);if(!A){j(b("#L{}"))}else{if(!v){v=true;n.request({secode:A,type:"rule"})}}try{t.yzm_submit.blur()}catch(B){}},closeDialog:function(B){if(typeof B=="object"&&B.el){w.hide()}if(typeof h=="object"&&h.onRelease&&typeof h.onRelease=="function"){h.onRelease()}d.hotKey.remove(document.documentElement,["esc"],f.closeDialog,{type:"keyup"});try{d.preventDefault()}catch(A){}},onFocus:function(B){B=d.core.evt.getEvent();var A=B.target||B.srcElement;var C=A.value;if(!C){p()}}};var m=function(){var A=w.getOuter();s=d.core.evt.delegatedEvent(A);s.add("yzm_change","click",function(){f.changesrc();d.preventDefault()});s.add("yzm_submit","click",function(){f.checkValidateCode();d.preventDefault()});s.add("yzm_cancel","click",f.closeDialog);d.core.evt.addEvent(t.close_icon,"click",f.closeDialog);d.core.evt.addEvent(t.input_text,"focus",f.onFocus);d.core.evt.addEvent(t.input_text,"blur",f.onFocus)};var z=function(){if(w){s.destroy();d.core.evt.removeEvent(t.close_icon,"click",f.closeDialog);d.core.evt.removeEvent(t.input_text,"focus",f.onFocus);d.core.evt.removeEvent(t.input_text,"blur",f.onFocus);w&&w.destroy&&w.destroy()}w=c=null};var r=function(B,C,A){d.kit.io.cssLoader("style/css/module/layer/layer_verifycode.css","js_style_css_module_layer_layer_verifycode",function(){if(B.code=="100027"){h=A;o()}else{if(B.code=="100000"){var D=A.onSuccess;D&&D(B,C)}else{if(B.code=="100002"){window.location.href=B.data;return}else{if(B.code=="100050"){A.onError(B,C)}else{if(B.code=="100004"){d.common.layer.ioError(B.code,C)}else{if(B.code==20000000){var E=JSON.parse(B.msg)||{};d.ui.alert(E.msg,{OK:function(){window.location.href=B.data;return}},C.dom).dia.setTitle(E.title)}else{d.ui.alert(B.msg)}}}}}}})};u();u=null;q.destroy=z;q.validateIntercept=r;q.addUnloadEvent=function(){if(w){d.core.evt.addEvent(window,"unload",z)}};c=q;return q}});STK.register("common.dialog.publish",function(d){var c='<div class="detail" node-type="outer"><div class="send_weibo" node-type="wrap"><div class="title no_title" node-type="info"></div><div class="num" node-type="num"></div><div class="input"><div class="top_border"><div class="bottom_border"><textarea name="" class="W_no_outline" node-type="textEl"></textarea><div class="send_succpic" style="display:none" node-type="successTip"></div></div></div></div><div class="btn"><a href="javascript:void(0);" node-type="submit"></a></div><div class="kind" node-type="widget"><a href="javascript:void(0);" class="face" node-type="smileyBtn">#L{}</a><a href="javascript:void(0);" class="img"  node-type="picBtn" >#L{}</a><input node-type="follow" checked="checked" type="checkbox" id="01"><label for="01">#L{@}</label></div></div></div>';var b={title:"#L{}"};var e=d.kit.extra.language;var a={limitNum:140};return function(s){var u={};var x,H,v,E,J,n,m,g,C,z;x=d.parseParam({styleId:"1"},s);g=d.custEvent.define(u,"publish");d.custEvent.define(u,"hide");var I=function(){if(H){if(v==="error"){d.common.extra.shine(J.textEl)}return}d.common.channel.dialog.fire("submit",["submit"]);var K=n.API.getWords();H=true;v="loading";if(C){if(K.indexOf(C)===-1){K=K+C}}var L={};L.style_type=x.styleId;L.text=K;L.follow=J.follow.checked?"1":"0";if(n.API.getExtra()){L.pic_id=n.API.getExtra()||""}m.request(L)};var B=function(K){if((K.keyCode===13||K.keyCode===10)&&K.ctrlKey){I();n.API.blur()}};var t=function(K,M){var L=M.isOver;if(!L){H=false;v="";J.submit.className="";J.num.innerHTML=e("#L{}<span>"+(140-M.count)+"</span>#L{}")}else{H=true;v="error";J.submit.className="disable"}};var q=function(K,L){J.submit.className="disable";H=true;v="";J.successTip.style.display="";J.textEl.value="";setTimeout(function(){J.successTip.style.display="none";E.hide()},2*1000);d.custEvent.fire(g,"publish",[K.data,L]);d.common.channel.feed.fire("publish",[K.data,L])};var D=function(L,M){H=false;var K=d.common.dialog.validateCode();K.validateIntercept(L,M,{requestAjax:m,param:M});return;v=""};var o=function(K,L){H=false;v="";d.ui.alert()};var h=function(K){J.textEl.value="";n.API.insertText(K.content);J.info.innerHTML=K.info;if(K.content){H=false;v="";J.submit.className=""}else{H=true;v="error";J.submit.className="disable"}};var w=function(){H=false};var f=function(){n=d.common.editor.base(J.outer,a);n.widget(d.common.editor.widget.face(),"smileyBtn");n.widget(d.common.editor.widget.image(),"picBtn",{pid:z});if($CONFIG.lang=="en-us"){d.addClassName(J.wrap,"send_weibo_en")}};var j=function(){d.addEvent(J.submit,"click",I);d.addEvent(J.textEl,"keypress",B)};var r=function(){d.custEvent.add(n,"textNum",t)};var A=function(){m=d.common.trans.publisher.getTrans("publish",{onSuccess:q,onError:D,onFail:o})};var p=function(){f();j();r();A()};var G=function(M){var L=d.parseParam({content:"",defaultValue:"",info:"",title:e(b.title),pid:"",suda:"key=tblog_search_v4.1&value=direct_rel_pub"},M);z=L.pid;E=d.ui.dialog();E.setTitle(L.title);var K=d.builder(d.kit.extra.language(c));J=d.kit.dom.parseDOM(K.list);E.appendChild(J.outer);E.show();L.suda&&J.submit.setAttribute("suda-data",L.suda);E.setMiddle();if(!n){p()}h(L);n.API.focus();d.custEvent.add(E,"hide",function(){d.custEvent.remove(E,"hide",arguments.callee);n.closeWidget();w();E=null;d.custEvent.fire(g,"hide");d.common.channel.dialog.fire("close",["close"])});C=L.defaultValue};var y=function(){E.hide()};var F=function(){if(E){E.hide()}d.removeEvent(J.submit,"click",I);d.removeEvent(J.textEl,"keypress",B);d.custEvent.remove(n,"textNum",t);d.custEvent.undefine(g,"publish");J=null;m=null;H=false;for(k in u){delete u[k]}u=null};u.show=G;u.hide=y;u.destroy=F;return u}});STK.register("comp.content.scrollToTop",function(a){return function(g,b){if(g==null){a.log("[comp.content.scrollToTop]: scrollToTop need a node[id=base_scrollToTop] in BODY.");return{destroy:a.funcEmpty}}var j,m,r=a.sizzle('[node-type="scrollToTop"]',g)[0],e;var h=(a.getStyle(g,"position")!="fixed");var o={share:function(t){var s=t.el.getAttribute("param");if(s){if(e){return}e=true;s=a.queryToJson(s);a.common.trans.global.getTrans("share",{onSuccess:function(u){a.common.dialog.publish().show(u.data);e=false},onError:function(u){a.ui.alert(u.msg);e=false},onFail:function(){a.ui.alert("");e=false}}).request(s)}else{a.common.dialog.publish().show(t.data)}}};function n(){var w=a.scrollPos();var t=w.top;var s,v,u;if(t>0){!!r&&a.setStyle(r,"display","");if(h){s=a.winSize().height;v=t+s-250;!!g&&a.setStyle(g,"top",v)}}else{!!r&&a.setStyle(r,"display","none")}}function d(){if(j!=null){if(new Date().getTime()-j<500){clearTimeout(m);m=null}}j=new Date().getTime();m=setTimeout(n,100)}function f(){if(h){var s=a.winSize().height-250;!!g&&a.setStyle(g,"top",s)}}function c(){f();document.body.scrollIntoView();return false}f();a.addEvent(window,"scroll",d);a.addEvent(r,"click",c);d();var q=a.core.evt.delegatedEvent(g);q.add("share","click",o.share);var p={destroy:function(){a.removeEvent(window,"scroll",d);a.removeEvent(c,"click",c);a.removeEvent("share","click",o.share)}};return p}});STK.register("common.dialog.loginLayer",function(c){var a;var b="//tjs.sjs.sinajs.cn/t5/register/js/page/remote/loginLayer.js";return function(d){d=c.core.obj.parseParam({lang:"zh-cn",loginSuccessUrl:d.url?d.url:encodeURIComponent(window.location.href),suda:{submitBtn:d.from?"key=tblog_search_v4&value=weibo_nologin2_landing1":"key=tblog_search_v4&value=weibo_nologin2_landing2",registUrl:d.from?"key=tblog_search_v4&value=weibo_nologin2_register1":"key=tblog_search_v4&value=weibo_nologin2_register2"}},d||{});if(window.WBtopGlobal_loginLayer){WBtopGlobal_loginLayer(d)}else{if(a){return}else{a=true;c.core.io.scriptLoader({url:b,onComplete:function(){a=false;window.WBtopGlobal_loginLayer(d)},timeout:10000,onTimeout:function(){a=false}})}}}});STK.register("kit.dom.parentAttr",function(a){return function(e,c,d){var b;if(e&&c){d=d||document.body;while(e&&(e!=d)&&!(b=e.getAttribute(c))){e=e.parentNode}}return b}});STK.register("kit.dom.firstChild",function(b){var a=b.core.dom.next;return function(c){var d=c.firstChild;if(d&&d.nodeType!=1){d=a(d)}return d}});STK.register("kit.dom.rotateImage",function(e){var b={},j=function(o){var p=e.core.dom.uniqueID(o);return b[p]||(b[p]={})};var g={0:0,90:1,180:2,270:3};var a=function(s,q){s=((q||0)+s)%360;s<0&&(s=360+s);var p=Math.PI*s/180,r=Math.round(Math.cos(p)*Math.pow(10,15))/Math.pow(10,15),o=Math.round(Math.sin(p)*Math.pow(10,15))/Math.pow(10,15);return{sin:o,cos:r,M11:r,M12:-o,M21:o,M22:r,angle:s,rotation:p}};var f=function(o,s,q,r){q=q||440;var p=a(s,r.oldAngle);s=r.oldAngle=p.angle;o.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+p.M11+",M12="+p.M12+",M21="+p.M21+",M22="+p.M22+",SizingMethod='auto expand')";e.setStyle(o.parentNode,"position","relative");if(g[s]%2==0){o.width=r.originalWidth;o.height=r.originalHeight;e.setStyle(o.parentNode,"height",o.height+"px");e.setStyle(o,"position","static")}else{if(g[s]%2==1){o.height=r.originalHeight>q?q:r.originalHeight;o.width=o.height*r.originalWidth/r.originalHeight;e.setStyle(o.parentNode,"height",o.width+"px");e.setStyle(o,"position","absolute");e.setStyle(o,"left",Math.abs((o.parentNode.offsetWidth-o.height)/2)+"px");e.setStyle(o,"top","0")}}};var n=function(v,t,x,q){var r=v;q.oldAngle=r.angle=((r.angle==undefined?0:r.angle)+t)%360;if(r.angle>=0){var y=Math.PI*r.angle/180}else{var y=Math.PI*(360+r.angle)/180}var w=Math.cos(y);var u=Math.sin(y);var s=document.createElement("canvas");if(!r.oImage){s.oImage=r}else{s.oImage=r.oImage}var o=new Image();o.onload=function(){s.style.width=s.width=Math.abs(w*o.width)+Math.abs(u*o.height);s.style.height=s.height=Math.abs(w*o.height)+Math.abs(u*o.width);if(s.width>x){s.style.width=x+"px";s.style.height=(x*o.width/o.height)+"px"}var p=s.getContext("2d");p.save();if(y<=Math.PI/2){p.translate(u*o.height,0)}else{if(y<=Math.PI){p.translate(s.width,-w*o.height)}else{if(y<=1.5*Math.PI){p.translate(-w*o.width,s.height)}else{p.translate(0,-u*o.width)}}}p.rotate(y);try{p.drawImage(o,0,0,o.width,o.height)}catch(z){}p.restore();s.angle=r.angle;r.parentNode.replaceChild(s,r);s.id=r.id;o.onload=null};o.src=s.oImage.src;return s};var h=(function(){var q=["transform","MozTransform","webkitTransform","OTransform"];var o=0,p=document.createElement("div").style;while(q[o]&&!(q[o] in p)){++o}return q[o]})();var m=function(r,v,t,u){var s=a(v,u.oldAngle),q;v=u.oldAngle=s.angle;if(!u.rotated){u.rotated=true;q=e.C("div");q.style.position="relative";u.textAlign=q.style.textAlign=e.getStyle(r.parentNode,"textAlign");r.parentNode.insertBefore(q,r);q.appendChild(r);r.style.position="absolute"}else{q=r.parentNode}if(g[v]%2==0){if(u.originalWidth>t){u.imgViewWidth=r.width=t}else{u.imgViewWidth=r.width=u.originalWidth}u.imgViewHeight=r.height=u.originalHeight}else{if(g[v]%2==1){if(u.originalHeight>t){u.imgViewWidth=r.height=t}else{u.imgViewWidth=r.height=u.originalHeight}u.imgViewHeight=r.width=r.height*u.originalWidth/u.originalHeight}}q.style.height=u.imgViewHeight+"px";if(t>q.offsetWidth){q.style.width=t+"px"}r.style[h]="matrix("+s.M11+","+s.M21+","+s.M12+","+s.M22+", 0, 0)";var o=(u.imgViewHeight-u.imgViewWidth)/2;var p=(u.imgViewWidth-u.imgViewHeight)/2;if(g[v]%2==0){r.style.top="0px";if(u.textAlign=="center"){r.style.left=((q.offsetWidth-u.imgViewWidth)/2)+"px"}else{r.style[u.textAlign=="right"?"right":"left"]="0px"}}else{r.style.top=o+"px";if(u.textAlign=="center"){r.style.left=(p+(q.offsetWidth-u.imgViewWidth)/2)+"px"}else{r.style[u.textAlign=="right"?"right":"left"]=p+"px"}}};var c=function(o,r,p){var q=j(o);if(!("originalWidth" in q)){q.originalWidth=o.width;q.originalHeight=o.height}p||(p=q.originalWidth);if(h){m(o,r,p,q)}else{if("getContext" in e.C("canvas")){n(o.canvas?o.canvas:o,r,p,q)}else{if("filters" in e.C("div")){f(o,r,p,q)}}}};var d={rotateRight:function(o,q,p){c(o,q==undefined?90:q,p)},rotateLeft:function(o,q,p){c(o,q==undefined?-90:-q,p)},rotateDefault:function(o){var p=j(o);if(p.oldAngle){c(o,360-p.oldAngle,p.originalWidth)}},removeDataCache:function(p){var q=e.uniqueID(p),o;if(h){if(o=p.parentNode&&p.parentNode.parentNode){p.parentNode.parentNode.insertBefore(p,o);e.removeNode(o)}}b[q]&&delete b[q]},destroy:function(){b={}}};return d});STK.register("common.trans.weiboDetail",function(c){var a=c.kit.io.inter();var b=a.register;b("delete",{url:"/ajax/comment/del",method:"post"});b("deleteWeibo",{url:"/aj/mblog/del",method:"post"});b("delmblog",{url:"/ajax/mblog/del",method:"post"});b("feedlist",{url:"/ajax/comment/big",method:"get"});b("forward",{url:"/ajax/mblog/info/big",method:"get"});b("mediaShow",{url:"//api.weibo.com/widget/show.jsonp",varkey:"jsonp",method:"get",requestMode:"jsonp"});b("qingShow",{url:"//api.t.sina.com.cn/widget/show.json?source=3818214747",varkey:"callback",method:"get",requestMode:"jsonp"});b("widget",{url:"/ajax/mblog/showinfo",method:"post"});b("third_rend",{url:"/ajax/mblog/renderfeed",method:"post"});return a});STK.register("kit.extra.toFeedText",function(a){return function(e){if(typeof e!=="string"){throw"[kit.extra.toFeedText]:need string as first parameter"}var f=a.core.str.parseHTML(e);var c=[];for(var d=0,b=f.length;d<b;d+=1){if(!f[d][2]){c.push(f[d][0])}else{if(f[d][2].toLowerCase()==="img"){var g=f[d][3].match(/(?:alt\s*=\s*["|']?([^"|'|\s]+)["|']?)/);if(g){c.push(g[1])}}}}return c.join("")}});STK.register("kit.extra.parseURL",function(a){return function(){return(STK.historyM&&STK.historyM.parseURL)?STK.historyM.parseURL():a.core.str.parseURL(location.href)}});STK.register("widget.module.component",function(a){return function(){var b={};b.initParam=a.core.func.empty;b.initEvent=a.core.func.empty;b.destroyParam=a.core.func.empty;b.destroyEvent=a.core.func.empty;b.init=function(){b.initParam();b.initEvent()};b.destroy=function(){b.destroyEvent();b.destroyParam()};return b}});STK.register("widget.parse",function(e){var d="//js.t.sinajs.cn/t4/apps/search/js/",c="STK.",b=["destroy","part_destroy","part_flush"],f=1,a=(typeof $CONFIG=="undefined")?f:$CONFIG.version;return function(j,o){var n=e.widget.module.component(),h=e.core.obj.sup(n,["init","destroy"]),p={},m,g;n.handler={getMethod:function(s){s=s.split(".");var r,q=e;while(r=s.shift()){if(!(q=q[r])){break}}return q},extract:function(q){var r=n.handler.getMethod(q.ns);if(r){p[q.uniqueID]={info:q,entity:r(q)};p[q.uniqueID].entity.init()}},getDomInfo:function(q){return{dom:q,top:n.entity.dom,ns:q.getAttribute("component"),uniqueID:e.core.dom.uniqueID(q),data:e.queryToJson(q.getAttribute("component-data")||""),param:e.queryToJson(q.getAttribute("component-param")||"")}},loadComponent:function(s){var r=n.handler.getDomInfo(s);var q=[{url:[m.baseURL,r.ns.replace(/\./g,"/"),".js?version=",a].join(""),NS:m.baseNS+r.ns}];e.core.io.require(q,n.handler.extract,r)}};n.accept={partDestroy:function(r,t){var s=t.dom;for(var q in p){if(e.contains(s,p[q].info.dom)){p[q].entity.destroy();delete p[q].info;delete p[q].entity;delete p[q]}}},partFlush:function(q,r){e.foreach(e.sizzle("[component]",r.dom),n.handler.loadComponent)}};n.initParam=function(){n.entity={dom:j};g=e.custEvent.define(n.entity.dom,b);m=e.parseParam({baseURL:d,baseNS:c},o);p={}};n.destroyParam=function(){m=null;p=null};n.initEvent=function(){e.custEvent.add(g,"part_destroy",n.accept.partDestroy);e.custEvent.add(g,"part_flush",n.accept.partFlush)};n.destroyEvent=function(){e.custEvent.remove(g,"part_destroy",n.accept.partDestroy);e.custEvent.remove(g,"part_flush",n.accept.partFlush)};n.destroy=function(){for(var q in p){p[q].entity.destroy();delete p[q].info;delete p[q].entity;delete p[q]}h.destroy()};n.init=function(){h.init();e.foreach(e.sizzle("[component]",n.entity.dom),n.handler.loadComponent)};return n}});STK.register("common.feed.widget",function(b){var a={};return{add:function(d,c){if(!a[d]){a[d]=b.widget.parse(c);a[d].init()}},clear:function(c){if(a[c]){a[c].destroy();delete a[c]}},destroy:function(){for(var c in a){a[c].destroy();delete a[id]}}}});STK.register("common.content.weiboDetail.utils",function(a){return function(){var E=a.core.evt.preventDefault,F=a.kit.extra.language,v=a.kit.dom.firstChild,B=a.kit.dom.parentAttr,s=a.core.util.getUniqueKey,p=a.core.dom.uniqueID,g=a.core.dom.sizzle,A=a.core.dom.next,x=40,q=450,z=F("#L{}!"),t=F("#L{}"),d,r,D=a.kit.dom.fix,h=a.core.util.easyTemplate,m=a.common.feed.feedList.feedTemps,o=a.core.dom.hasClassName,c=a.core.dom.addClassName,n=a.core.dom.removeClassName,w=a.common.trans.weiboDetail.getTrans,C=a.module.rotateImage,f=a.kit.extra.toFeedText,u=a.kit.extra.parseURL().url,y=$CONFIG.imgPath+"/style/images/common/loading.gif",j,e={mediaVideoMusicTEMP:F('<#et temp data><#if (data.notForward)><dd class="expand"></#if><p class="W_no_border"><a href="${data.short_url}" title="${data.short_url}" class="show_big" target="_blank">${data.title}</a></p><div node-type="feed_list_media_big${data.type}Div" style="text-align:center;min-height:18px;"><img class="loading_gif" src="'+y+'"/></div><#if (data.notForward)></dd></#if></#et>'),widgetTEMP:F('<#et temp data><#if (data.notForward)><dd class="expand"></#if><p class="W_no_border"><#if (!data.notForward)><a href="javascript:void(0);" action-type="feed_list_media_toSmall" class="retract">#L{}</a><i class="W_vline">|</i></#if><a <#if (data.suda)>suda-data="${data.suda}"</#if> href="${data.full_url}" title="${data.full_url}" class="show_big" target="_blank">${data.title}</a></p><div node-type="feed_list_media_widgetDiv"><img class="loading_gif" src="'+y+'"/></div><#if (data.notForward)></dd></#if></#et>'),qingTEMP:F('<#et temp data><#if (data.notForward)><dd class="expand"></#if><p class="W_no_border"><#if (!data.notForward)><a href="javascript:void(0);" action-type="feed_list_media_toSmall" class="retract">#L{}</a><i class="W_vline">|</i></#if><a <#if (data.suda)>suda-data="${data.suda}"</#if> href="${data.full_url}" title="${data.full_url}" class="show_big" target="_blank">${data.title}</a></p><div node-type="feed_list_media_qingDiv"><img class="loading_gif" src="'+y+'"/></div><#if (data.notForward)></dd></#if></#et>')};var b={getMid:function(G,H){return G.mid||(G.mid=B(G,"mid",H))},getFeedNode:function(G){while(G.tagName.toLowerCase()!="dl"){G=G.parentNode}return G},preventDefault:function(G){E(G);return false},tabSwitch:function(J,M,P,H){var I=J.parentNode,O=false,L=P.split(" "),G;if(H){var K=J.getAttribute("action-type"),Q=J.getAttribute("action-data");var R=(K==="forword_tab_click"&&(Q==="privatemsg"||Q==="microgroup"));H.feed_list.style.display=R?"none":"";H.feed_cate.style.display=R?"none":""}if(!o(J,M)){G=g("."+M,I)[0];for(var N=0;N<L.length;N++){n(G,L[N])}c(J,P);O=true}J.blur();return O},getMediaPDNodes:function(G,H){return{prev:a.sizzle("[node-type=feed_list_media_prev]",G)[0],disp:a.sizzle((H?"dd":"dl")+'[node-type="feed_list_media_disp"]',G)[0]}},smallImgFun:function(L){var H=L.el;var R=b.preventDefault(L.evt);if(H.loading){return R}if(H.tagName.toLowerCase()!=="img"){H=a.sizzle("img",H)[0]}H.loading=1;var P=H.src.replace("/thumbnail/","/bmiddle/");var K=H.src.replace("/thumbnail/","/large/");var J=b.getFeedNode(H);var S=J.getAttribute("isForward")?1:"";var I,O;if(!J){a.log("parents attribute mid node is undefined!");return R}J.isForward=S;var M=b.getMediaPDNodes(J,S);if(!M||!M.prev||!M.disp){a.log('node-type="feed_list_media_prev" or node-type="feed_list_media_disp" in a feed\'s node is undefined!');return R}var N=function(){H.loading=0;if(I){H.bigImgWidth=I.width;I.onload=null}O&&(O.style.display="none");M.prev.style.display="none";M.disp.innerHTML="";M.disp.appendChild(a.builder(h(m.mediaIMGTEMP,{notForward:!S,uniqueId:s(),bigSrc:P,largeSrc:K,bigWidth:H.bigImgWidth>q?q:H.bigImgWidth,suda:{retract:"key=feed_image_click&value=image_zoomout",showBig:"key=feed_image_click&value=image_open",left:"key=feed_image_click&value=image_turnlift",right:"key=feed_image_click&value=image_turnright",big:"key=feed_image_click&value=image_zoomout"}}).toString()).box);M.disp.style.display=""};if(H.bigImgWidth){N()}else{var Q=H.offsetWidth;var G=parseInt(H.offsetHeight/2-8);(O=a.core.dom.next(H)).style.cssText="margin:"+G+"px "+parseInt(Q/2-8)+"px "+G+"px -"+parseInt(Q/2+8)+"px;";O.style.display="";(I=new Image()).onload=N;I.src=P}return R},bigImgFun:function(N,L,M){var K=N.el;var I=b.preventDefault(N.evt);if(!M&&!/(img)|(canvas)/.test(N.evt.target.tagName.toLowerCase())){return I}var G=b.getFeedNode(K);if(!G){a.log("parents attribute mid is undefined!");return}G.disp="";var J=b.getMediaPDNodes(G,G.isForward);if(!J.prev){a.log('media: node-type="feed_list_media_prev" is not be found in feed item');return}if(!J.disp){a.log('media: node-type="feed_list_media_disp" is not be found in feed item');return}if(a.position(J.disp).t<a.scrollPos().top){G.scrollIntoView()}J.prev.style.display="";J.disp.style.display="none";J.disp.innerHTML="";var H=G.getAttribute("mid");H&&a.common.feed.widget.clear(H);return I},toFloatFun:function(N,K,J){r&&a.fireEvent(r,"click");var I=N.el;var O=decodeURIComponent(N.data.title);var P=b.getMid(I,K);var Q=J.dispContentNode[P];var H=Q.mediaData;var M=a.builder(h(m.mediaVideoMusicFloatTEMP,{title:decodeURIComponent(O)}).toString());var G=M.list.outer[0],L=M.list.mediaContent[0];r=M.list.close[0];document.body.appendChild(G);d=D(G,"rb");if(H){L.innerHTML="";L.appendChild(a.builder(H).box);d.setFixed(true)}else{J.dispContentNode[P]=L}a.addEvent(r,"click",function(){a.removeEvent(r,"click",arguments.callee);d&&d.destroy();a.removeNode(G);d=M=G=r=null});return b.bigImgFun(N,K,true)},newsFeed:function(J,G){var I=J.el;for(;!a.hasClassName(I,"feed_list");I=I.parentNode){}var H=a.sizzle("[node-type=feed_list_news]",I)[0];H&&(H.style.display=G?"":"none")},smallVideoMusicClickFun:function(N,K,S,J){try{var I=N.el;var O=N.data;var L=b.getFeedNode(I);var W=L.getAttribute("isForward")?1:"";var T=b.getMid(I,K);var P=b.getMediaPDNodes(L,W);if(!P.prev){a.log('media: node-type="feed_list_media_prev" is not be found in feed item');return}if(L.disp==O.short_url){return}L.disp=O.short_url;L.isForward=W;P.prev.style.display="none";var U=decodeURIComponent(O.title);var M=a.bLength(U)>71?a.leftB(U,70)+"...":U;U=a.bLength(U)>24?a.leftB(U,23)+"...":U;P.disp.innerHTML="";P.disp.appendChild(a.builder(h(W?m.mediaVideoMusicTEMP:e.mediaVideoMusicTEMP,{notForward:!W,short_url:decodeURIComponent(O.short_url),full_url:decodeURIComponent(O.full_url),title:U,fTitle:M,type:S}).toString()).box);if(!P.disp){a.log('media: node-type="feed_list_media_disp" is not be found in feed item');return}P.disp.style.display="";var V=a.sizzle('div[node-type="feed_list_media_big'+S+'Div"]',P.disp)[0];if(!V){a.log('media: note-type="feed_list_media_big'+S+'Div" is not be found in feed_list_media_disp node!');return}J.dispContentNode[T]=V;var H="default";try{if(IE){H="object"}else{if(navigator.plugins["Shockwave Flash"]){H="embed"}else{H="html5"}}}catch(Q){}var G=function(){V.innerHTML=z};var R=function(Y){if(!Y.result||Y.error_code||Y.error){G();return}var X=J.dispContentNode[T];X.mediaData=Y.result;X.innerHTML="";X.appendChild(a.builder(X.mediaData).box);d&&d.setFixed(true)};w("mediaShow",{onComplete:R,onFail:G}).request({vers:3,lang:$CONFIG.lang,mid:T,short_url:O.short_url.replace(/(https|http)\:\/\/(t|sinaurl)\.cn\//,""),template_name:H,source:"3818214747"});a.scrollTo(P.disp,{step:1})}catch(Q){a.log("video err : ",Q.message)}},rotateImg:function(L,H){var K=L.el;var I=b.getFeedNode(K);if(!K.parentNode.uid){var G=a.sizzle('img[action-type="feed_list_media_bigimg"]',I)[0];K.parentNode.uid=p(G)+"_"+s();G.setAttribute("id",K.parentNode.uid)}var J=H==="right"?"rotateRight":"rotateLeft";C[J](K.parentNode.uid,90,function(){},q)},getForwardOptions:function(J){var P=v(J);var K=b.getFeedNode(P);var Q=K.getAttribute("mid");var M=g(">dl >dd",J)[0];var R=g('[node-type="feed_list_forwardContent"]',K)[0];var L=g('[action-type="feed_list_media_img"]',J)[0]||g('[action-type="feed_list_media_bigimg"]',J)[0];var I=L&&L.src&&L.src.replace(/^.*?\/([^\/]+).gif$/,"$1");M=g("em",M)[0];var O=f(M.innerHTML);var H=M.getAttribute("nick-name");var N=null;var G=null;if(R){N=O;G=H;O=f(g(">em",R)[0].innerHTML);H=v(R).getAttribute("nick-name")}return{mid:Q,appkey:"",url:u,originNick:H,reason:N,origin:O,forwardNick:G,pid:I,styleId:2}},getCount:function(H){var G=H.match(/\(([\d]*)\)/);G=!G?0:parseInt(G[1]);return G},qingExpand:function(L,J,I){var H=L.el;var P=b.getMid(H,J);var M=L.data;var K=b.getFeedNode(H,J);var S=K.getAttribute("isForward")?"1":"";var N=b.getMediaPDNodes(K,S);if(K.disp==M.short_url){return}K.isForward=S;a.common.feed.widget.clear(P);N.disp.innerHTML="";N.disp.appendChild(a.builder(h(e.qingTEMP,{notForward:!S,short_url:decodeURIComponent(M.short_url),full_url:decodeURIComponent(M.full_url),title:decodeURIComponent(M.title),suda:decodeURIComponent(M.suda||"")}).toString()).box);N.prev.style.display="none";N.disp.style.display="";var R=a.sizzle('div[node-type="feed_list_media_qingDiv"]',N.disp)[0];var Q=function(U){var T=U.code;if((T+"")=="1"){U=U.data;if(!U.result){return}R.innerHTML=U.result;a.common.feed.widget.add(P,N.disp)}else{O(U)}};var O=function(T){R.innerHTML=t};var G=M.template_name;if(!G){G=""}else{if(G=="video"){if(a.IE){G="object"}else{if(navigator.plugins&&navigator.plugins["Shockwave Flash"]){G="embed"}else{G="html5"}}}}w("qingShow",{onComplete:Q,onFail:O}).request({short_url:M.short_url,lang:window.$CONFIG&&window.$CONFIG.lang||"zh-cn",mid:P,vers:3,template_name:G});a.scrollTo(N.disp,{step:1,top:x})},thirdExpand:function(K,I,H){var G=K.el;var N=b.getMid(G,I);var L=K.data;var J=b.getFeedNode(G,I);var P=J.getAttribute("isForward")?"1":"";var M=b.getMediaPDNodes(J,P);if(J.disp==L.short_url){return}J.disp=L.short_url;J.isForward=P;a.common.feed.widget.clear(N);M.disp.innerHTML="";M.disp.appendChild(a.builder(h(e.widgetTEMP,{notForward:!P,short_url:decodeURIComponent(L.short_url),full_url:decodeURIComponent(L.full_url),title:decodeURIComponent(L.title),suda:decodeURIComponent(L.suda||"")}).toString()).box);M.prev.style.display="none";M.disp.style.display="";var O=a.sizzle('div[node-type="feed_list_media_widgetDiv"]',M.disp)[0];w("third_rend",{onSuccess:function(Q){Q=Q.data;if(!Q.html){return}O.innerHTML=Q.html;a.scrollTo(M.disp,{step:1});a.common.feed.widget.add(N,M.disp)},onFail:function(Q){O.innerHTML=(Q&&Q.msg)||z},onError:function(Q){O.innerHTML=(Q&&Q.msg)||z}}).request(a.kit.extra.merge({isforward:P,mid:N},L))},widgetExpand:function(K,I,H){var G=K.el;var N=b.getMid(G,I);var L=K.data;var J=b.getFeedNode(G,I);var P=J.getAttribute("isForward")?"1":"";var M=b.getMediaPDNodes(J,P);if(J.disp==L.short_url){return}J.disp=L.short_url;J.isForward=P;a.common.feed.widget.clear(N);M.disp.innerHTML="";M.disp.appendChild(a.builder(h(e.widgetTEMP,{notForward:!P,short_url:decodeURIComponent(L.short_url),full_url:decodeURIComponent(L.full_url),title:decodeURIComponent(L.title),suda:decodeURIComponent(L.suda||"")}).toString()).box);M.prev.style.display="none";M.disp.style.display="";var O=a.sizzle('div[node-type="feed_list_media_widgetDiv"]',M.disp)[0];w("widget",{onSuccess:function(Q){Q=Q.data;if(!Q.html){return}O.innerHTML=Q.html;a.scrollTo(M.disp,{step:1});a.common.feed.widget.add(N,M.disp)},onFail:function(Q){O.innerHTML=(Q&&Q.msg)||z},onError:function(Q){O.innerHTML=(Q&&Q.msg)||z}}).request({short_url:decodeURIComponent(L.short_url),isforward:P,mid:N})}};return b}});STK.register("common.feed.feedList.feedTemps",function(c){var b=c.kit.extra.language;var a=$CONFIG.imgPath+"/style/images/common/loading.gif";return{loadingIMG:b('<div style="text-align:center;"><span><i node-type="loading" style="margin:12px 10px 17px" class="W_loading S_loading"></i>#L{}...</span></div>'),newFeedTipHTML:b('<a action-type="feed_list_newBar" class="notes" href="">#L{} [n] #L{}#L{}</a>'),loadingHTML:b('<div requestType="[n]"><i style="margin:12px 10px 17px" class="W_loading S_loading"></i><span>#L{}...</span></div>'),loadErrorRetryHTML:b('<div class="zero_tips W_textb"><span>#L{}<a action-type="feed_list_retry" requestType="[n]" href="javascript:void(0)">#L{}</a></span></div>'),loadErrorEndHTML:b('<div class="zero_tips W_textb" requestType="[n]"><span>#L{}</span></div>'),mediaIMGTEMP:b('<#et temp data><#if (data.notForward)><dd class="expand"></#if><div class="WB_expand_media S_bg1"><div class="tab_feed_a clearfix"><div class="tab"><ul class="clearfix"><li><span class="line S_line1"><a action-type="feed_list_media_toSmall"  href="javascript:void(0);" class="W_texta" <#if (data.suda && data.suda.retract)>suda-data="${data.suda.retract}"</#if>><i class="W_ficon ficon_arrow_fold S_ficon">k</i>#L{}</a></span></li><li><span class="line S_line1"><a href="${data.largeSrc}" target="_blank" class="W_texta" <#if (data.suda && data.suda.showBig)>suda-data="${data.suda.showBig}"</#if>><i class="W_ficon ficon_search S_ficon">f</i>#L{}</a></span></li><li><span class="line S_line1"><a action-type="feed_list_media_toLeft" href="javascript:void(0);" class="W_texta" <#if (data.suda && data.suda.left)>suda-data="${data.suda.left}"</#if>><i class="W_ficon ficon_turnleft S_ficon">m</i>#L{}</a></span></li><li><span class="line S_line1"><a action-type="feed_list_media_toRight" <#if (data.suda && data.suda.right)>suda-data="${data.suda.right}"</#if> href="javascript:void(0);" class="W_texta"><i class="W_ficon ficon_turnright S_ficon">n</i>#L{}</a></span></li></ul></div></div><div class="WB_media_view"><div class="smallcursor" style="position:relative; width:440px; margin:0 auto;"  action-type="feed_list_media_bigimgDiv" <#if (data.suda && data.suda.big)>suda-data="${data.suda.big}"</#if>><div class="WB_pic_vip" <#if (data.ispay)>style="display: none;"</#if>><p style="border-width:0">TaTa</p><a href="https://vipclub.weibo.com/vmember/opendetail?vuid=${data.uid[0]}" action-type="feed_list_media_bigimgDiv_link" ></a></div><img dynamic-id="${data.uniqueId}"   action-type="feed_list_media_bigimg" src="${data.bigSrc}" width="${data.bigWidth}" <#if (!data.ispay)>style="width:440px;height:280px;"</#if> /><#if (data.tags != null)><#list data.tags as tags><a title="${tags.tag_name}" node-type="tag" action-type="tag" <#if (tags.url.length != 0)>href="${tags.url}" target="_blank"<#else>href="javascript:void(0);"</#if> class="tag_showpicL" style="left: ${tags.pos_x*100}%; top: ${tags.pos_y*100}%; white-space: nowrap; display:none;" tag-id="3"><span class="inner"><#if (tags.tag_type === "user")><em class="W_autocut">@${tags.tag_name}</em><#elseif (tags.tag_type === "topic")><em class="W_autocut">#${tags.tag_name}#</em><#elseif (tags.tag_type === "place")><em class="W_autocut">${tags.tag_name}</em><#else><em class="W_autocut">${tags.tag_name}</em></#if></span></a></#list></#if></div></div><#if (data.notForward)></dd></#if></div></#et>'),mediaVideoMusicTEMP:b('<#et temp data><#if (data.notForward)><dd class="expand"></#if><p class="W_no_border"><a href="javascript:void(0);" action-type="feed_list_media_toSmall" class="retract">#L{}</a><i class="W_vline">|</i><a href="${data.short_url}" title="${data.short_url}" class="show_big" target="_blank">${data.title}</a><i class="W_vline">|</i><a action-type="feed_list_media_toFloat" action-data="title=${data.fTitle}" href="javascript:void(0);" class="turn_right">#L{}</a></p><div node-type="feed_list_media_big${data.type}Div" style="text-align:center;min-height:18px;"><img class="loading_gif" src="'+a+'"/></div><#if (data.notForward)></dd></#if></#et>'),mediaVideoMusicTEMP_HotRecommend:b('<#et temp data><#if (data.notForward)><dd class="expand"></#if><div class="W_bgcolor_arrow" node-type="arrow"><em class="W_arrline_mini"></em></div><dl class="comment"><dd class="expand"><p class="W_no_border"><a href="javascript:void(0);" action-type="feed_list_media_toSmall" class="retract">#L{}</a><i class="W_vline">|</i><a href="${data.short_url}" title="${data.short_url}" class="show_big" target="_blank">${data.title}</a><i class="W_vline">|</i></p><div node-type="feed_list_media_big${data.type}Div" style="text-align:center;min-height:18px;"><img class="loading_gif" src="'+a+'"/></div></dd></dl><#if (data.notForward)></dd></#if></#et>'),feedListThirdVideo:b('<#et temp data><#if (data.notForward)><dd class=""></#if><dl class=""><dd class="expand"><p class="W_no_border"><a href="javascript:void(0);" action-type="feed_list_media_toSmall" class="retract">#L{}</a><i class="W_vline">|</i><a href="${data.short_url}" title="${data.short_url}" class="show_big" target="_blank">${data.title}</a><i class="W_vline">|</i></p><div node-type="feed_list_media_big${data.type}Div" style="text-align:center;min-height:18px;" class="feed_list_media_bigvideoDiv"><img class="video_pre" src="${data.img}"/><span class="loading_big_gif"></span></div></dd></dl><#if (data.notForward)></dd></#if></#et>'),feedListPromotionVideo:b('<#et temp data><#if (data.notForward)><dd class=""></#if><dl class=""><dd class="expand"><p class="W_no_border" style="display:none;"><a href="javascript:void(0);" action-type="feed_list_media_toSmall" class="retract">#L{}</a><i class="W_vline">|</i><a href="${data.short_url}" title="${data.short_url}" class="show_big" target="_blank">${data.title}</a><i class="W_vline">|</i></p><div node-type="feed_list_media_big${data.type}Div" style="text-align:center;min-height:18px;width: 690px;" class="feed_list_media_bigvideoDiv"><img class="video_pre" src="${data.img}"/><span class="loading_big_gif"></span></div></dd></dl><#if (data.notForward)></dd></#if></#et>'),mediaVideoMusicFloatTEMP:b('<#et temp data><div node-type="outer" class="W_layer" style="top:50px;left:50px;"><div class="bg"><table border="0" cellspacing="0" cellpadding="0"><tr><td><div class="content"><div class="title"><h3>${data.title}</h3></div><a href="####" onclick="return false;" node-type="close" class="W_close"></a><div node-type="mediaContent" style="text-align:center;width:440px;"><img style="margin:10px;" class="loading_gif" src="'+a+'"/></div></div></td></tr></table></div></div></#et>'),widgetTEMP:b('<#et temp data><#if (data.notForward)><dd class="expand"></#if><p class="W_no_border"><a href="javascript:void(0);" action-type="feed_list_media_toSmall" class="retract">#L{}</a><i class="W_vline">|</i><a <#if (data.suda)>suda-data="${data.suda}"</#if> href="${data.full_url}" title="${data.full_url}" class="show_big" target="_blank">${data.title}</a></p><div node-type="feed_list_media_widgetDiv"><img class="loading_gif" src="'+a+'"/></div><#if (data.notForward)></dd></#if></#et>'),qingTEMP:b('<#et temp data><#if (data.notForward)><dd class="expand"></#if><p class="W_no_border"><a href="javascript:void(0);" action-type="feed_list_media_toSmall" class="retract">#L{}</a><i class="W_vline">|</i><a <#if (data.suda)>suda-data="${data.suda}"</#if> href="${data.full_url}" title="${data.full_url}" class="show_big" target="_blank">${data.title}</a></p><div node-type="feed_list_media_qingDiv"><img class="loading_gif" src="'+a+'"/></div><#if (data.notForward)></dd></#if></#et>')}});STK.register("module.imgResize",function(a){return function(d,m,e){var b=d.width,g=d.height;var c=b/g;m=m||b;e=e||g;if(b>m&&g>e){var f=m/b,j=e/g;if(f>j){g=e;b=g*c}else{b=m;g=b/c}}else{if(b>m){b=m;g=b/c}else{if(g>e){g=e;b=g*c}else{return{w:b,h:g}}}}d.width=b;d.height=g;return{w:b,h:g}}});STK.register("module.ieImgRote",function(a){var b={0:0,90:1,180:2,270:3};return function(c,h,j){j=j||440;var f=c.getAttribute("pos");f=!f?h:((f*1+h)%360);f<0&&(f=(360+f));c.setAttribute("pos",f);var e=c.parentNode;if(!c.dw){c.dw=c.width;c.dh=c.height;c.cs=c.style.cssText;c.pcs=e.style.cssText}var d=Math.sin(Math.PI*f/180);var g=Math.cos(Math.PI*f/180);if(b[f]==0||b[f]==2){c.style.cssText=c.cs;e.style.cssText=c.pcs;c.width=c.dw;c.height=c.dh}else{a.module.imgResize(c,j,c.dw);a.setStyle(e,"height",c.width);a.setStyle(e,"position","relative");a.setStyle(c,"position","absolute");a.setStyle(c,"left",Math.abs((j-c.height)/2));a.setStyle(c,"top",0)}c.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+g+",M12="+(-d)+",M21="+d+",M22="+g+",SizingMethod='auto expand')"}});STK.register("module.rotateImage",function(b){var a={rotateRight:function(c,e,f,d){this._img[c]=this._img[c]||{};this._img[c]._right=this._img[c]._right||0;this._img[c]._right++;this._rotate(c,e==undefined?90:e,f,d)},rotateLeft:function(c,e,f,d){this._img[c]=this._img[c]||{};this._img[c]._left=this._img[c]._left||0;this._img[c]._left++;this._rotate(c,e==undefined?-90:-e,f,d)},_img:{},_rotate:function(j,g,q,o){var d=b.E(j);if(document.all&&!window.opera){b.module.ieImgRote(d,g,o)}else{d.angle=((d.angle==undefined?0:d.angle)+g)%360;if(d.angle>=0){var r=Math.PI*d.angle/180}else{var r=Math.PI*(360+d.angle)/180}var n=Math.cos(r);var h=Math.sin(r);var f=document.createElement("canvas");if(!d.oImage){f.oImage=d}else{f.oImage=d.oImage}f.style.width=f.width=Math.abs(n*f.oImage.width)+Math.abs(h*f.oImage.height);f.style.height=f.height=Math.abs(n*f.oImage.height)+Math.abs(h*f.oImage.width);if(f.width>o){f.style.width=o+"px"}var c=f.getContext("2d");c.save();if(r<=Math.PI/2){c.translate(h*f.oImage.height,0)}else{if(r<=Math.PI){c.translate(f.width,-n*f.oImage.height)}else{if(r<=1.5*Math.PI){c.translate(-n*f.oImage.width,f.height)}else{c.translate(0,-h*f.oImage.width)}}}c.rotate(r);try{c.drawImage(f.oImage,0,0,f.oImage.width,f.oImage.height)}catch(m){}c.restore();f.id=d.id;f.angle=d.angle;d.parentNode.replaceChild(f,d)}if(q&&typeof q==="function"){q(f)}}};return a});STK.register("comp.content.unLogin",function(a){return function(g,c){var p={},e,r,s=a.common.dialog.loginLayer,f=window.$CONFIG&&window.$CONFIG.lang||"zh-cn",d,m=a.common.content.weiboDetail.utils();var j=a.sizzle('[node-type="havaNotLogin"]',g);var b=a.sizzle('[node-type="haveBeenLogin"]',g);var h="small";var q=function(){var v=a.E("base_scrollToTop");e=a.comp.content.scrollToTop(v)};var n={login:function(w){a.preventDefault();var v={lang:f};var x=w.data;v=a.core.json.merge(v,x);s(v)},rotateImageLeft:function(v){m.rotateImg(v,"left");return m.preventDefault(v.evt)},rotateImageRight:function(v){m.rotateImg(v,"right");return m.preventDefault(v.evt)},loginByOtherCount:function(){for(var v=0;v<j.length;v++){j[v].style.display="none";b[v].style.display=""}window.open("//weibo.com/bind/index.php","_blank")},loginWeiboBtn:function(){for(var v=0;v<j.length;v++){j[v].style.display="none";b[v].style.display=""}window.open("//weibo.com/signup/signup.php","_blank")},refresh:function(){setTimeout(function(){window.location.href=window.location.href},0)}};var o=function(){r=a.delegatedEvent(g);r.add("login","click",n.login);r.add("loginWeiboBtn","click",n.loginWeiboBtn);r.add("otherCount","click",n.loginByOtherCount);r.add("refresh","click",n.refresh);d=a.E("pl_content_changeLanguage");if(d){a.addEvent(d,"change",n.login)}};var u=function(){q();o()};u();var t=function(){e&&e.destroy&&e.destroy();r.remove("login","click",n.login);a.removeEvent(d,"change",n.login);a.removeEvent(otherCountBtn,"click",n.loginByOtherCount);r.remove("feed_list_media_toLeft","click",n.rotateImageLeft);r.remove("feed_list_media_toRight","click",n.rotateImageRight)};p.destroy=t;return p}});STK.pageletM.register("pl.common.unLogin",function(c){var b=c.E("pl_common_unLogin");if(!b){return}var a=c.comp.content.unLogin(b);return a});STK.register("common.login.marquee",function(a){return function(f,b){var p={},f;b=a.parseParam({type:"roll",speed:20,timeout:2000,fix:0,waiting:false},b);var h=f.parentNode;var d,e;var n=false;var g=false;var s=function(){if(b.type=="slide"){var w=f.childNodes;var x=0;for(var v=0,u=w.length;v<u;v++){if(w[v].offsetWidth){x+=w[v].offsetWidth;if(w[v]["style"]["marginLeft"]){x+=parseInt(w[v]["style"]["marginLeft"],10)}if(w[v]["style"]["marginRight"]){x+=parseInt(w[v]["style"]["marginRight"],10)}}}f.style.width=x+200+"px"}};var q=function(v,u){f.style[v]=(parseInt(f.style[v])||0)+u+"px"};var c=function(u,v,x,w){a.core.dom.trimNode(f);if(v){q(w,u);clearInterval(d);e=setTimeout(function(){if(!n){d=setInterval(j,b.speed)}else{g=true}},b.timeout)}else{q(w,x)}};var j=function(){if(b.type=="roll"){var y=f.childNodes;var w=y[y.length-1];if(!w){return false}var v=parseInt(f.style.top)>=0;if(v){f.insertBefore(w,y[0])}var u=-w.offsetHeight;c(u,v,1,"top")}else{if(b.type=="slide"){var x=f.childNodes[0];if(!x){return false}var v=-parseInt(f.style.left)-x.offsetWidth>0;if(v){f.appendChild(x)}var u=x.offsetWidth+b.fix;c(u,v,-1,"left")}}};var m={isMouseLeaveOrEnter:function(w,v){if(w&&w.type!="mouseout"&&w.type!="mouseover"){return false}var u=w.relatedTarget?w.relatedTarget:(w.type=="mouseout"?w.toElement:w.fromElement);while(u&&u!=v){u=u.parentNode}return(u!=v)},onMouseover:function(u){if(m.isMouseLeaveOrEnter(u,f)){if(b.waiting==false){clearInterval(d);clearTimeout(e)}else{n=true}}},onMouseout:function(u){if(m.isMouseLeaveOrEnter(u,f)){if(b.waiting==false){clearInterval(d);d=setInterval(j,b.speed)}else{n=false;if(g){clearInterval(d);d=setInterval(j,b.speed);g=false}}}}};var o=function(){a.addEvent(f,"mouseover",m.onMouseover);a.addEvent(f,"mouseout",m.onMouseout)};var t=function(){s();o();d=setInterval(j,b.speed)};var r=function(){clearInterval(d);a.removeEvent(f,"mouseover",m.onMouseover);a.removeEvent(f,"mouseout",m.onMouseout);m=nodes=null};f&&t();p.destroy=r;return p}});STK.register("common.login.connectMSN",function(a){return function(d){var h={};var e=window.App={};var j=null;var f={url:"//oauth.live.com/authorize",wrap_client_id:"000000004C03D438",wrap_callback:"//weibo.com/msn/msnLoginCallBack.php",wrap_scope:"wl.signin wl.basic wl.offline_access wl.share wl.emails",response_type:"code",name:"neww",params:"height=500,width=500"};var c=function(o){var r=f;var q=$CONFIG.lang==="zh-tw"?"zh-tw":"zh-cn";var p=["client_id="+r.wrap_client_id,"scope="+encodeURIComponent(r.wrap_scope),"response_type="+r.response_type,"redirect_uri="+encodeURIComponent(r.wrap_callback)].join("&");p=p+(q?"&locale="+q:"");p=r.url+"?"+p;j=window.open(p,r.name,r.params)};var g=function(o){a.ui.alert(o,{zIndex:2000})};var b=function(o){if(j){j=null}if(o){top.location.href=o}};var n=function(){a.addEvent(d,"click",c)};var m=function(){a.removeEvent(d,"click",c)};d&&n();e.showBindMsnMsg=g;e.sendRedirect=b;h.destroy=m;return h}});STK.register("common.login.plugin",function(a){return function(h){h=a.parseParam({id:"login_form",page:"index"},h);var g={},c={};var f=a.kit.extra.language;var b=function(){var p=h.page==="login"?'suda-data="key=weibo_login&value=err_help"':"";var r=f("#L{}")+'<a target="_blank" href="//help.weibo.com/faq/q/85/12606#12606" '+p+">"+f("#L{}")+"</a>";var n=f("#L{}")+'<a target="_blank" href="//help.weibo.com/faq/q/85/12699#12699" '+p+" >"+f("#L{}")+"</a>";var t=f("#L{}");var q=f("#L{}");var m=f("#L{}")+'<br /><span style="color:#333">'+f("#L{}")+'<a href="javascript:void(0)" target="_blank" id="login-unconfirm">'+f("#L{}")+"</a></span>";var s=f("#L{}")+'<a href="javascript:;" onclick="try{SINA_LOGIN_PLUGIN.plugin.door.playVoice();}catch(e){}return false;">'+f("#L{}")+"</a>";var o=f("#L{JS1069 019555605.}")+'<a href="javascript:void(0)" target="_blank" id="login-locked">'+f("#L{>>}")+"</a>";c.set("sso",{entry:"weibo",domain:"weibo.com",service:"miniblog"}).set("language",{"5":r,"101":r,"4038":n,"4049":t,"5024":q,"5025":q,"4010":m,"2070":s,"4047":o,"4049":f("#L{}"),E010001:f("#L{}"),E010002:f("#L{}"),E010003:f("#L{}"),E010004:f("#L{}"),T010000:f("#L{}"),T010001:f("#L{}"),T010002:f("#L{}"),T010003:f("#L{}"),T010004:f("#L{}"),T010005:f("#L{}"),T010006:f("#L{//}"),T010007:f("#L{}"),T010008:f("#L{}"),T010009:f("#L{}"),T010010:f("#L{}"),T010012:f("#L{?}"),T010011:f("#L{}"),T010014:f("#L{}")}).set("css",{href:""}).init(h.id)};var e=function(){if(c){c.listener.register("login_success",function(m){var n;if($CONFIG&&$CONFIG.redirect){n=a.trim($CONFIG.redirect);n=decodeURIComponent(n)}else{if(m.userinfo&&m.userinfo["userdomain"]){n="/"+a.trim(m.userinfo["userdomain"])}else{n="/"}}window.location.replace(n)});c.listener.register("login_failure",function(p){var o=a.sizzle("input[node-type=loginname]",a.E(h.id))[0];var m=a.E("login-unconfirm");var n=a.E("login-locked");o&&m&&m.setAttribute("href","//weibo.com/signup/resend.php?user="+o.value);o&&n&&n.setAttribute("href","//help.weibo.com/appeal/frozen?loginname="+o.value)})}};var j=function(){b();e()};var d=function(){c&&c.destroy&&c.destroy()};j();g.destroy=d;return g}});STK.register("comp.common.login",function(a){return function(e){var j={},c,g,d,h;var f=function(){if(c.slide){g=a.common.login.marquee(c.slide,{type:"slide",speed:35,timeout:0,waiting:false,fix:8})}if(c.roll){d=a.common.login.marquee(c.roll,{type:"roll",waiting:false})}a.common.login.connectMSN(c.msn)};var m=function(){a.comp.content.unLogin(e)};var p=function(){n();m();b();f()};var n=function(){if(!a.core.dom.isNode(e)){throw"[STK.comp.login.index]:node is not a Node!"}};var b=function(){var q=a.core.dom.builder(e);c=a.kit.dom.parseDOM(q.list);c.door_change&&(c.door_change["style"]["display"]="none")};var o=function(){g&&g.destroy();d&&d.destroy();h&&h.destroy();c=null};e&&p();j.destroy=o;return j}});STK.pageletM.register("pl.common.loginBox",function(b){var a=b.E("pl_common_loginBox");return b.comp.common.login(a)});STK.register("ui.bubbleLayer",function(b){var a='<div class="W_layer" node-type="outer" style="display:none;"><div class="bg"><div class="effect"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><div class="content clearfix" node-type="inner"></div></td></tr></tbody></table><div node-type="arrow" class="#{arrow_type}"></div></div></div></div>';return function(c,p){var g,f,j,h,r,s;var o=function(u){u=u?"arrow arrow_"+u:"";return u};var n=function(u){f.style.top=u.t+"px";f.style.left=u.l+"px";return h};var m=function(){var u=b.core.util.winSize();var v=g.getSize(true);f.style.top=b.core.util.scrollPos()["top"]+(u.height-v.h)/2+"px";f.style.left=(u.width-v.w)/2+"px";return h};var d=function(u){if(typeof u==="string"){j.innerHTML=u}else{j.appendChild(u)}return h};var e=function(v,w){var u="";if((v==="t"||v==="b")){if(w==="right"){u="left:auto;right:30px;"}else{if(w==="center"){u="left:auto;right:"+(f.offsetWidth/2-8)+"px;"}}}else{if((v==="l"||v==="r")&&w==="bottom"){u="top:auto;bottom:20px;"}}r.className=o(v);r.style.cssText=u;return h};var q=function(u){u=o(u);r.className=u;return h};var t=function(){p=o(p);s=a.replace(/\#\{arrow_type\}/g,p);g=b.module.layer(s);f=g.getOuter();j=g.getDom("inner");r=g.getDom("arrow");h=g;c&&d(c);document.body.appendChild(f)};t();h.setPostion=n;h.setMiddle=m;h.setContent=d;h.setArrow=e;return h}});STK.register("ui.popCard",function(f){var e=5,a=28,g=38,h=200,n=200;var j=function(q,s,C){var u,o,B,z,A,v;var p=f.core.util.scrollPos(),y=f.core.dom.position(q),x=f.core.util.winSize();A=q.offsetWidth;v=q.offsetHeight;B=y.t-p.top;u=y.l-p.left;o=x.width-u-A;z=x.height-B-v;return{t:B,l:u,r:o,b:z,w:A,h:v,x:y.l,y:y.t}};var b=function(y){var o=y.nodeW,z=y.nodeH,p=y.dis,v=y.cardWidth,r=y.cardHeight,w=y.arrow,q=y.node,s=y.offsetH,x=y.offsetW,t=y.arPos,u={};switch(w){case"t":u.l=p.x-x+o/2;u.t=p.y-e-r;break;case"r":u.l=p.x+o+e;u.t=p.y-s+z/2;break;case"b":u.l=p.x-x+o/2;u.t=p.y+z+e;break;case"l":default:u.l=p.x-v-e;u.t=p.y-s+z/2;break}return u};var d=function(v){var B=v.node,F=v.cardWidth,p=v.cardHeight,w=v.arrowPos||"auto",C=(v.order||"b,r,t,l").split(","),A=C[0],r=Math.max(p,n),o={l:F,b:r,t:r,r:F},J={l:"r",b:"t",t:"b",r:"l"},z=j(B),s=z.w,y=z.h,q=a,I=g,u=B.getClientRects?B.getClientRects():null,K=parseInt(f.getStyle(B,"lineHeight"),10),x=f.fixEvent(v.event);if(u&&u.length>1){var H;if(x.pageX-z.x>s/2){H=u[0];z.x=H.left;z.l+=H.left-u[1]["left"];y=H.bottom-H.top;s=H.right-H.left}else{H=u[1];z.y+=H.top-u[0]["top"];z.r+=u[0]["right"]-H.right;y=H.bottom-H.top;s=H.right-H.left}}for(var D=0,E=C.length;D<E;D++){var G=C[D];if(z[G]>o[G]){A=G;break}}if(w==="auto"){if((A==="t"||A==="b")&&s/2+z.r<F-g){w="right"}else{if(y/2+z.b<p-a){w="bottom"}}}if(w==="right"){I=F-g}else{if(w==="bottom"){q=p-a}else{if(w==="center"){I=F/2}}}var t=b({nodeW:s,nodeH:y,dis:z,cardWidth:F,cardHeight:p,arrow:A,node:B,offsetH:q,offsetW:I});return{dire:J[A],pos:t,arPos:w}};var c=function(o,p){return function(){return o.apply(p,arguments)}};var m=function(){this.bubLayer=f.ui.bubbleLayer();this.cardPanel=this.bubLayer.getOuter();this.initBind()};m.prototype={initBind:function(){var o=c(this.stopHide,this);var p=c(this.hideCard,this);f.addEvent(this.cardPanel,"mouseover",o);f.addEvent(this.cardPanel,"mouseout",p);this.dEvent=f.core.evt.delegatedEvent(this.cardPanel)},stopShow:function(){this.showTimer&&clearTimeout(this.showTimer)},stopHide:function(){this.hideTimer&&clearTimeout(this.hideTimer)},showCard:function(o){var p=o.zIndex||9999;this.cardPanel.style.zIndex=p;this.bubLayer.setContent(o.content).show();this.node=o.node;this.arrowPos=o.arrowPos;this.order=o.order;this.direPos=d({node:this.node,cardWidth:this.cardPanel.offsetWidth,cardHeight:this.cardPanel.offsetHeight,arrowPos:this.arrowPos,order:this.order,event:o.event});this.bubLayer.setPostion(this.direPos.pos).setArrow(this.direPos.dire,this.direPos.arPos)},setContent:function(p){var q=this.cardPanel.offsetHeight;this.bubLayer.setContent(p);if(this.direPos.dire==="b"){var o=this.cardPanel.offsetHeight-q;this.bubLayer.setPostion({l:this.direPos.pos.l,t:this.direPos.pos.t-o})}},hideCard:function(){var o=this;this.hideTimer=setTimeout(function(){o.bubLayer.hide()},h)}};return function(){return new m()}});STK.register("common.trans.content",function(d){var b=d.kit.io.inter();var c=b.register;var e="/ajax/jsProxy.php?interurl=http://new.weibo.com";var a="/ajax/";c("language",{url:e+"/aj/settings/lang&method=post",method:"post"});c("at",{url:a+"atUserSuggest.php?method=get"});c("simple",{url:a+"user/lang?",method:"get"});c("relaexpand",{url:"/ajax/mblog/relaexpand",method:"get"});c("mblogshow",{url:"/ajax/mblog/show",method:"get"});c("topicStatus",{url:"/ajax/direct/status",method:"get"});return b});STK.register("kit.dom.dir",function(a){return function(e,d){d=a.parseParam({dir:"parentNode",expr:undefined,endpoint:document,maxLength:1},d);var c=d.dir,g=d.expr,j=d.endpoint,b=d.maxLength;if(!e||!g){a.log("kit dir: node or opts.expr is undefined.");return}var f=[],h=e[c];while(h){if(h.nodeType==1&&a.sizzle(g,null,null,[h]).length>0){f.push(h);if(f.length==b){break}}if(h==j){break}h=h[c]}return f}});STK.register("kit.dom.parents",function(a){return function(c,b){b=a.parseParam({expr:undefined,endpoint:document,maxLength:1},b);var d=b.expr;if(!c||!d){a.log("kit parents: node or opts.expr is undefined.");return}return a.kit.dom.dir(c,b)}});STK.register("comp.content.searchCard",function(e){var c=300000,d=500;var b,g,a;var f='<div style="width:168px;padding-top:15px;padding-bottom:15px;text-align:center"><span>#{msg}</span></div>';return function(m,w){var p={},j=e.kit.extra.language,v=e.templet;var r=e.parseParam({order:"b,t,l,r",zIndex:9999,type:0,variety:"relaexpand",arrowPos:"auto",loadTemp:j('<div style="width:168px;padding-top:15px;padding-bottom:15px;text-align:center"><i class="W_loading S_loading"></i><span>#L{}...</span></div>')},w||{});var h={data:[],getCache:function(B){var z=this.data[B],A="";if(z){var y=new Date();if(y-z.date<c){A=z.html}else{delete this.data[B]}}return A},setCache:function(z,y){this.data[z]={date:new Date(),html:y}},rmCache:function(y){delete this.data[y]}};var n={showCardMouseover:function(A){var z=e.fixEvent(A),y=z.target,B;if(!y.getAttribute("searchcard")){y=e.kit.dom.parents(y,{expr:"[searchcard]"})[0]}B=y&&y.getAttribute("searchcard");if(B){b.stopHide();b.showTimer=setTimeout(function(){var E=e.queryToJson(B);var D=E.key;var C=h.getCache(D);b.showCard({content:C||r.loadTemp,node:y,order:r.order,arrowPos:r.arrowPos,zIndex:r.zIndex,event:A});C||e.common.trans.content.getTrans(y.getAttribute("trans")||r.variety,{onComplete:function(F,H){if(F.code=="100000"){var G=H.key;h.setCache(G,F.data);b.setContent(F.data)}else{if(!F||!F.msg||typeof F.msg!=="string"){F={msg:j("#L{}")}}b.setContent(v(f,F))}}}).request(E)},d)}},showCardMouseout:function(B){var A=e.fixEvent(B),z=A.target,y=z.getAttribute("searchcard");if(!y){z=e.kit.dom.parents(z,{expr:"[searchcard]"})[0];if(z){y=z.getAttribute("searchcard")}}if(y){b.stopShow();b.hideCard()}}};var q={rmCache:function(y){h.rmCache(y.key)}};var x=function(){if(!b){b=e.ui.popCard()}s();o();t()};var s=function(){if(!e.core.dom.isNode(m)){throw"[STK.comp.content.searchCard]: node is not a Node!"}};var o=function(){e.addEvent(m,"mouseover",n.showCardMouseover);e.addEvent(m,"mouseout",n.showCardMouseout)};var t=function(){};var u=function(){e.removeEvent(m,"mouseover",n.showCardMouseover);e.removeEvent(m,"mouseout",n.showCardMouseout);h.data.length=0;n=null;h=null};x();p.destroy=u;p.searchCard=b;return p}});STK.register("common.trans.index",function(c){var a=c.kit.io.inter();var b=a.register;b("setting",{url:"/ajax/preferences",method:"post"});b("topic",{url:"/ajax/mblog/topic/subscribe",method:"post"});b("list",{url:"/ajax/mblog/topic/list",method:"get"});b("getNum",{url:"/ajax/mblog/topic/getnum",method:"get"});b("change",{url:"/ajax/pcguess",method:"post"});return a});STK.register("kit.dom.mouseDelegate",function(b){var a={mouseover:b.core.func.empty,mouseout:b.core.func.empty,delay:200,extra:[],actionType:"hover"};return function(f,q){if(!f){b.log("kit.dom.mouseDelegate need a document node as first param");return}var o={},j,e,p,g;var c=b.parseParam(a,q);var m={mouseover:function(r){if(r.el!=g){g=r.el;j&&clearTimeout(j);j=setTimeout(function(){c.mouseover(r)},c.delay)}else{e&&clearTimeout(e);e=null}},mouseout:function(r){e=setTimeout(function(){c.mouseout(r);g=null;notFirstIn=false},c.delay)}};p=b.core.evt.delegatedEvent(f);p.add(c.actionType,"mouseover",m.mouseover);p.add(c.actionType,"mouseout",m.mouseout);var d=c.extra||[];for(var h=0,n=d.length;h<n;h+=1){b.core.evt.addEvent(d[h],"mouseover",m.mouseover);b.core.evt.addEvent(d[h],"mouseout",m.mouseout)}o.destroy=function(){p.remove(c.actionType,"mouseover",m.mouseover);p.remove(c.actionType,"mouseout",m.mouseout);p=null};return o}});STK.register("ui.tipPrototype",function(a){var b=10003;return function(d){var e,j,h,g,c;var f='<div node-type="outer" style="position: absolute; clear: both; display:none;overflow:hidden;z-index:10003;" ><div node-type="inner" ></div></div>';e=a.parseParam({direct:"up",showCallback:a.core.func.empty,hideCallback:a.core.func.empty},d);j=a.module.layer(f,e);h=j.getOuter();g=j.getInner();j.setTipWH=function(){c=this.getSize(true);this.tipWidth=c.w;this.tipHeight=c.h;return this};j.setTipWH();j.setContent=function(m){if(typeof m=="string"){g.innerHTML=m}else{g.appendChild(m)}this.setTipWH();return this};j.setLayerXY=function(s){if(!s){throw"ui.tipPrototype need pNode as first parameter to set tip position"}var t=STK.core.dom.position(s);var o=t.l;var r=s.offsetWidth;var n=s.offsetHeight;var q=Math.min(Math.max((o+(r-this.tipWidth)/2),a.scrollPos().left),(a.scrollPos().left+STK.winSize().width)-this.tipWidth);var p=t.t;if(e.direct==="down"){p+=n}var m=[";"];m.push("z-index:",(b++),";");m.push("width:",this.tipWidth,"px;");m.push("height:",this.tipHeight,"px;");m.push("top:",p,"px;");m.push("left:",q,"px;");h.style.cssText+=m.join("")};j.aniShow=function(){var n=this.getOuter();n.style.height="0px";n.style.display="";var m=a.core.ani.tween(n,{end:e.showCallback,duration:250,animationType:"easeoutcubic"});if(e.direct==="down"){m.play({height:this.tipHeight},{staticStyle:"overflow:hidden;position:absolute;"})}else{var o=(parseInt(n.style.top,10)-this.tipHeight);m.play({height:this.tipHeight,top:Math.max(o,a.scrollPos().top)},{staticStyle:"overflow:hidden;position:absolute;"})}};j.anihide=function(){var n=this.getOuter();var p=this;var m=a.core.ani.tween(n,{end:function(){n.style.display="none";n.style.height=p.tipHeight+"px";e.hideCallback()},duration:300,animationType:"easeoutcubic"});if(e.direct==="down"){m.play({height:0},{staticStyle:"overflow:hidden;position:absolute;"})}else{var o=(parseInt(n.style.top,10)+this.tipHeight);m.play({height:0,top:o},{staticStyle:"overflow:hidden;position:absolute;"})}};document.body.appendChild(h);j.destroy=function(){document.body.removeChild(h);j=null};return j}});STK.register("ui.tipConfirm",function(a){return function(n){n=n||{};var b=a.kit.extra.language;var h=a.ui.tipPrototype(n);var f=h.getInner();var p=h.getOuter();p.className="W_layer";f.className="bg";n.info=n.info||b("#L{}");n.icon=n.icon||"icon_ask";var m=n.template||b('<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td><div class="content layer_mini_info"><p class="clearfix" node-type="info"><span node-type="icon" class="'+n.icon+'"></span>'+n.info+'</p><p class="btn"><a node-type="ok" class="S_btn_b" href="javascript:void(0)"><span>#L{}</span></a><a class="Sbtn_a" node-type="cancel" href="javascript:void(0)"><span>#L{}</span></a></p></div></td></tr></tbody></table>');var d=a.builder(m);h.setContent(d.box);if(!d.list.ok){return h}var j=d.list.ok[0];var o=d.list.cancel[0];h.setIcon=function(q){d.list.info.className=q;h.setTipWH()};h.setInfo=function(q){d.list.info[0].innerHTML='<span node-type="icon" class="'+n.icon+'"></span>'+q;h.setTipWH()};h.cancelCallback=function(){if(a.getType(n.cancelCallback)=="function"){n.cancelCallback()}};h.okCallback=function(){if(a.getType(n.okCallback)=="function"){n.okCallback()}};var g=function(){h.anihide();h.cancelCallback()};var c=function(){h.anihide();h.okCallback()};a.addEvent(o,"click",g);a.addEvent(j,"click",c);var e=h.destroy;h.destroy=function(){a.removeEvent(o,"click",g);a.removeEvent(j,"click",c);e();h=null};return h}});STK.register("comp.recomWords",function(c){var a=c.common.trans.index;var b=c.kit.extra.language;return function(B,x){var u={},F,I,n,p,q=1,G,g,o,r,s;var y="settingTips"+$CONFIG.uid,j;var A;var h={getListLen:function(){return A.keywordList.getElementsByTagName("li").length},getLastKeyword:function(){var K=c.sizzle("[action-type=del]:last",A.keywordList)[0];var J=c.queryToJson(K.getAttribute("action-data")).keyword;return J},getChecked:function(){var J=c.sizzle(":checkbox:checked",A.recomList);return J},deleteLi:function(K){var J=c.kit.dom.parents(K,{expr:"li"})[0];c.removeNode(J)},error:function(J){c.ui.alert(J.msg,{icon:"error"})},fail:function(){c.ui.alert("",{icon:"error"})},selectAll:function(){var K=c.sizzle(":checkbox",A.recommend);for(var L=0,J=K.length;L<J;L++){K[L].checked=true}},unSelectAll:function(){var K=c.sizzle(":checkbox",A.recommend);for(var L=0,J=K.length;L<J;L++){K[L].checked=false}},scrollHot:function(){var K=o.scrollLeft+2;var J=(K>G)?(K-G):K;o.scrollLeft=J},autoScroll:function(){r=setInterval(h.scrollHot,80)},getNum:function(){setTimeout(function(){a.getTrans("topic",{onSuccess:function(L){for(var K in L.data){var M=c.sizzle("[recommkey="+K+"]")[0];var J=L.data[K]!=0?"("+L.data[K]+")":"";M&&(M.innerHTML=J)}h.getNum()},onError:h.error,onFail:h.fail}).request({action:"update"})},5*60*1000)},tipsBubble:function(){var J=c.core.util.storage.get(y);var K=A.settingTips;var L=c.core.dom.position(K);if(!J||J=="null"){if(!j){j=c.ui.tipsBubble().setContent("",true);c.core.evt.custEvent.add(j,"hide",function(){c.core.util.storage.set(y,"1")});c.addEvent(j.getDom("closeBtn"),"click",function(){j.hide()})}j.setArrow({className:"arrow_down"});j.setPosition({t:L.t+K.offsetHeight-94,l:L.l})}}};var e={toggle:function(J){if(A.searchInput.style.display=="none"){A.searchInput.style.display="";c.addClassName(A.toggle,"add_icon_off");c.removeClassName(A.toggle,"add_icon_on");A.text.focus()}else{A.searchInput.style.display="none";c.addClassName(A.toggle,"add_icon_on");c.removeClassName(A.toggle,"add_icon_off")}},addTopic:function(J){if(I){return}I=true;a.getTrans("topic",{onSuccess:function(K){if(A.keywordList.style.display=="none"){A.keywordList.style.display="";A.emptyKeyword.style.display="none"}c.insertHTML(A.keywordList,K.data,"AfterBegin");I=false;A.text.value="";A.text.focus()},onError:function(K){I=false;h.error(K)},onFail:function(){I=false;h.fail()}}).request({action:"add",keyword:J.value})},delTopic:function(J){if(n){return}n=true;a.getTrans("topic",{onSuccess:function(K){h.deleteLi(J.el);if(K.data.is_end==1){A.more&&(A.more.style.display="none");if(h.getListLen()==0){A.emptyKeyword.style.display="";A.keywordList.style.display="none"}}else{c.insertHTML(A.keywordList,K.data.html)}n=false},onError:function(K){n=false;h.error(K)},onFail:function(){n=false;h.fail()}}).request({action:"delete",keyword:J.data.keyword,lastkeyword:h.getLastKeyword()})},more:function(J){if(p){return}p=true;a.getTrans("list",{onSuccess:function(K){p=false;c.insertHTML(A.keywordList,K.data.html);if(K.data.is_end==1){A.more.style.display="none"}A.hide.style.display=""},onError:function(K){p=false;h.error(K)},onFail:function(){p=false;h.fail()}}).request({keyword:h.getLastKeyword()})},hide:function(K){A.hide.style.display="none";var M=c.sizzle("[action-type=del]",A.keywordList);if(M.length){for(var L=0,J=M.length;L<J;L+=1){if(L>11){h.deleteLi(M[L])}}A.more.style.display=""}},book:function(){var J=c.htmlToJson(A.recomList);if(I){return}I=true;a.getTrans("topic",{onSuccess:function(N){if(A.keywordList.style.display=="none"){A.keywordList.style.display="";A.emptyKeyword.style.display="none"}c.insertHTML(A.keywordList,N.data,"AfterBegin");var L=h.getChecked();for(var M=0,K=L.length;M<K;M++){h.deleteLi(L[M])}I=false},onError:function(K){I=false;h.error(K)},onFail:function(){I=false;h.fail()}}).request({action:"add",keyword:c.isArray(J.keyword)?J.keyword.join(","):J.keyword})},delRecomWords:function(J){tipDel=c.ui.tipConfirm({info:""});tipDel.setLayerXY(J.el);tipDel.aniShow();tipDel.okCallback=function(){a.getTrans("setting",{onSuccess:function(K){h.deleteLi(J.el)},onError:function(K){I=false;h.error(K)},onFail:function(){I=false;h.fail()}}).request({action:"del",query:J.data.words})}},checkAll:function(J){J.el.checked?h.selectAll():h.unSelectAll()},uncheckedAll:function(){c.sizzle("[action-type=checkAll]",B)[0].checked=false},startScroll:h.autoScroll,pauseScroll:function(){clearInterval(r)},clearNum:function(J){c.sizzle("[recommkey]",J.el)[0].innerHTML=""},showRecomm:function(J){if(s){return}s=true;a.getTrans("topic",{onSuccess:function(){s=false;A.recommArea.style.display="";J.el.setAttribute("action-type","hideRecomm");J.el.title="";J.el.className="W_Titarr_on"},onError:function(){s=false},onFail:function(){s=false}}).request({action:"showOn"})},hideRecomm:function(J){if(s){return}s=true;a.getTrans("topic",{onSuccess:function(){s=false;A.recommArea.style.display="none";J.el.setAttribute("action-type","showRecomm");J.el.title="";J.el.className="W_Titarr_off"},onError:function(){s=false},onFail:function(){s=false}}).request({action:"showOff"})},showHelp:function(){var J=c.core.dom.position(A.help);A.helpLayerIdx.style.left=J.l-22+"px";A.helpLayerIdx.style.top=J.t+A.help.offsetHeight+10+"px";A.helpLayerIdx.style.display=""},hideHelp:function(){A.helpLayerIdx.style.display="none"}};var D={};var w={};var C=function(){z();f();E();d();m();t();v()};var z=function(){if(!B){c.log("[comp.recomWords] : missing  -> path : comp.recomWords");return}x=c.core.obj.parseParam({html:""},x)};var f=function(){if(x.html){B.innerHTML=x.html}A=c.kit.dom.parseDOM(c.builder(B).list)};var E=function(){c.comp.content.searchCard(B,{variety:"mblogshow",loadTemp:b('<div style="width:300px;padding-top:15px;padding-bottom:15px;text-align:center"><i class="W_loading S_loading"></i><span>#L{}...</span></div>')});g=A.listCon;o=A.keyList;var L=c.sizzle("li",g);G=0;for(var K=0,J=L.length;K<J;K++){G+=(c.core.dom.getSize(L[K]).width+10)}g.innerHTML+=g.innerHTML;h.autoScroll();c.comp.content.unLogin(B);h.tipsBubble()};var d=function(){};var m=function(){c.addEvent(g,"mouseover",e.pauseScroll);c.addEvent(g,"mouseout",e.startScroll);c.addEvent(window,"resize",h.tipsBubble);F=c.core.evt.delegatedEvent(B);F.add("toggle","click",e.toggle);F.add("del","click",e.delTopic);F.add("more","click",e.more);F.add("hide","click",e.hide);F.add("book","click",e.book);F.add("delRecomWords","click",e.delRecomWords);F.add("checkAll","click",e.checkAll);F.add("check","click",e.uncheckedAll);F.add("clearNum","click",e.clearNum);F.add("showRecomm","click",e.showRecomm);F.add("hideRecomm","click",e.hideRecomm);F.add("showHelp","mouseover",e.showHelp);F.add("showHelp","mouseout",e.hideHelp);if(c.core.util.browser.IE6){c.kit.dom.mouseDelegate(B,{mouseover:function(J){c.addClassName(J.el,"search_ctips3_hover")},mouseout:function(J){c.removeClassName(J.el,"search_ctips3_hover")}});c.kit.dom.mouseDelegate(B,{actionType:"check",mouseover:function(J){c.addClassName(J.el,"li_hover")},mouseout:function(J){c.removeClassName(J.el,"li_hover")}})}};var t=function(){};var v=function(){};var H=function(){};C();u.destroy=H;return u}});STK.pageletM.register("pl.recomWords",function(e){var a="pl.recomWords";var d={};var c=e.E("pl_recomWords");var b=e.comp.recomWords(c,d);return b});STK.register("kit.extra.require",function(f){var c=window.$CONFIG||{};var g="loaded",r="waiting",t="loading";var a={},h={},s=[],p=[],m=false;var n={maxLine:4,maxRetryTimes:1,baseURL:c.jsPath,version:c.version,timeout:30000,urlRule:null};var q=function(y){var z={},B;for(var A=y.length;A--;){B=y[A];if(z[B]){return false}z[B]=1}return true};var e=function(y){var z=/^http[s]?:\/\//ig;return z.test(y)};var d=function(z){var y=f.core.arr.indexOf(z,p);if(y!==-1){return p.splice(y,1)}return false};var w=function(y){if(typeof n.urlRule==="function"){return n.urlRule(n.baseURL,y,n.version)}else{y=y.replace(/\./ig,"/");return n.baseURL+"apps/search/js/"+y+".js?version="+n.version}};var o=function(y){p.push(y);h[y].state=t;var z=function(){var F=h[y].depeKeys,E,D,B;d(y);h[y].state=g;m&&u();for(var C=F.length;C--;){D=F[C];E=a[D];E.unReadyNum-=1;if(E.unReadyNum){return}while(a[D].bindFuns.length){B=E.bindFuns.shift();B.func.apply({},[].concat(B.data))}}};var A=function(){var B=h[y],G,F,E,D;d(y);B.state=r;if(B.retry<n.maxRetryTimes){B.retry+=1;return o(y)}m&&u();F=B.depeKeys;for(var C=F.length;C--;){E=F[C];G=a[E];while(G.timeoutFuns.length){D=G.timeoutFuns.shift();D.call({},E)}}};f.core.io.scriptLoader({url:e(y)?y:w(y),timeout:n.timeout,onComplete:z,onTimeout:A})};var j=function(z,B,C,y){var D=a[z];if(!D){f.log("[STK.kit.extra.require]: The depend "+z+" is undefined!")}if(!D.unReadyNum){f.log(""+z);return B.apply({},[].concat(C))}D.bindFuns.push({func:B,data:C});if(y&&typeof y.onTimeout==="function"){D.timeoutFuns.push(y.onTimeout)}for(var A=D.urlList.length;A--;){aUrl=D.urlList[A];if(h[aUrl].state===r){h[aUrl].retry=0;o(aUrl)}}};var b=function(A,y,z){(function(){if(f.requirePathMapping){var H=[];for(var G=0,F=y.length;G<F;G++){if(f.requirePathMapping[y[G]]){var E=y[G].split(".");E[E.length-1]=E[E.length-1]+"_"+f.requirePathMapping[y[G]];y[G]=E.join(".");E=null}}}})();if(a[A]!==undefined){f.log("[STK.kit.extra.require]: "+A+" has been registered!")}if(!q(y)){f.log("[STK.kit.extra.require]: The depend URLs is not unique! The depes is ["+y+"]")}var C,D=0;z=f.parseParam({activeLoad:false},z||{});for(var B=y.length;B--;){C=y[B];if(!h[C]){h[C]={depeKeys:[A],state:r,retry:0};z.activeLoad&&s.push(C)}else{h[C].depeKeys.push(A);if(h[C].state===g){D+=1}}}a[A]={urlList:y,bindFuns:[],timeoutFuns:[],unReadyNum:y.length-D};return a[A]};var u=function(){if(!s.length){m=false;return}m=true;var z=n.maxLine-1-p.length,y;while(z>0&&s.length){y=s.shift();if(h[y].state===r){o(y);z-=1}}};var v=function(y){n=f.core.json.merge(n,y)};var x=function(z,A,y){if(typeof A!=="function"){throw'[STK.kit.extra.require]: The "func" musts be a Function!'}return function(B){j(z,A,[].slice.call(arguments),y)}};j.bind=x;j.config=v;j.register=b;j.activeLoad=u;return j});STK.register("common.depand.asynUserCard",function(a){var b=a.kit.extra.require;b.register("asyn_userCard",["common.layer.userCard"],{activeLoad:true});b.register("asyn_smartSort",["common.layer.smartSortCard"],{activeLoad:true});b.register("asyn_followingListCard",["common.layer.followingListCard"],{activeLoad:true});return b});STK.register("comp.content.asynUserCard",function(a){return function(b,o){var g={},c=a.common.depand.asynUserCard,q;var h="asyn_userCard";var n=c.bind(h,function(s,t,r){q||(q=a.common.layer.userCard(s,o));q.showCard(s,t,r)});var e=c.bind(h,function(s,t,r){q||(q=a.common.layer.userCard(s,o));q.hideCard(s,t,r)});var d={mouseover:function(r){var t=a.fixEvent(r),s=t.target,u=s.getAttribute("usercard");if(!u){return}n(s,u,t)},mouseout:function(r){var t=a.fixEvent(r),s=t.target,u=s.getAttribute("usercard");if(!u){return}e(s,u,t)}};var p=function(){j();f()};var j=function(){if(!a.core.dom.isNode(b)){throw"[STK.comp.content.seedUserCard]: node is not a Node!"}};var f=function(){a.addEvent(b,"mouseover",d.mouseover);a.addEvent(b,"mouseout",d.mouseout)};var m=function(){a.removeEvent(b,"mouseover",d.mouseover);a.removeEvent(b,"mouseout",d.mouseout)};p();g.destroy=m;g.userCard=q;return g}});STK.register("comp.content.suda",function(a){window.SUDA=window.SUDA||[];if(Math.ceil(Math.random()*10000)==1){SUDA.push(["setPerformance",15])}return function(){var b=false,d=document,c=d.createElement("script"),e=d.getElementsByTagName("script")[0];c.type="text/javascript";c.charset="utf-8";c.async=true;c.src=("https:"==d.location.protocol?"https://":"http://")+"js.t.sinajs.cn/open/analytics/js/suda.js?version="+$CONFIG.version;e.parentNode.insertBefore(c,e)}});STK.register("comp.content.webim",function(a){return function(){if(a.E("wbim_box")||navigator.platform.indexOf("iPad")!==-1||(window.$CONFIG&&window.$CONFIG.pageid==="content_sorry")){return}if(window.$CONFIG&&(window.$CONFIG.$webim==1||window.$CONFIG.$webim==true)){var b=window.$CONFIG.version||(new Date()).getTime();STK.core.io.scriptLoader({url:"//js.t.sinajs.cn/t6/webim/js/loader.js?v=VER".replace("VER",b),onComplete:function(){}})}}});STK.register("module.getDiss",function(a){return function(){var c={},b=0,d={location:$CONFIG.location};if(arguments[0]&&!a.core.dom.isNode(arguments[0])){c=arguments[b++]}c=a.kit.extra.merge(c,d);if(!arguments[b]){return c}c=a.kit.extra.merge(c,a.core.json.queryToJson(a.kit.dom.parentAttr(arguments[b++],"diss-data",arguments[b])||""));return c}});STK.register("common.trans.relation",function(c){var a=c.kit.io.inter();var b=a.register;b("newuserguide",{url:"/ajax/user/interest/newuserguide",method:"get"});b("mayinterested",{url:"/ajax/user/interest/list",method:"get"});b("uninterested",{url:"/ajax/user/interest/uninterested",method:"post"});b("userCard",{url:"/ajax/user/card",method:"get"});b("follow",{url:"/ajax/user/follow",method:"post"});b("unFollow",{url:"/ajax/user/follow",method:"post"});b("block",{url:"/aj/f/addblack",method:"post"});b("unBlock",{url:"/aj3/blacklist/delblacklist_v4.php",method:"post"});b("removeFans",{url:"/aj/f/remove",method:"post"});b("requestFollow",{url:"/ajax/relation/requestfollow",method:"post"});b("questions",{url:"/ajax/user/invitelimit",method:"get"});b("answer",{url:"/ajax/user/invite",method:"post"});b("setRemark",{url:"/aj3/attention/aj_remarkname_v4.php",method:"post"});b("smart_sort",{url:"/ajax/mblog/single?from=hotmblog_repost_user",method:"get"});b("followingListCard",{url:"/ajax/mblog/repostusers",method:"get"});b("recommendusers",{url:"/aj/f/recommendusers",method:"get"});b("recommendAttUsers",{url:"/aj/f/worthfollowusers",method:"get"});b("recommendPopularUsers",{url:"/aj/user/interest/recommendpopularusers",method:"get"});b("mayinterestedweiqun",{url:"/aj/weiqun/getinterestedlist",method:"get"});b("moreData",{url:"/aj/f/listuserdetail",method:"get"});b("getInvite",{url:"/aj/invite/unread",method:"get"});b("quiet_addUser",{url:"/aj/f/addwhisper",method:"post"});b("quiet_removeUser",{url:"/aj/f/delwhisper",method:"post"});b("quiet_know",{url:"/aj/tipsbar/closetipsbar",method:"post"});b("groupUserList",{url:"/aj/f/group/getgroupmembers",method:"get"});b("groupSubmit",{url:"/ajax/user/GroupList",method:"get"});b("wqList",{url:"/aj/proxy?api=http://recom.i.t.sina.com.cn/1/weiqun/weiqun_may_interest.php",method:"get"});b("uninterestedWq",{url:"/aj/proxy?api=http://recom.i.t.sina.com.cn/1/weiqun/weiqun_uninterest.php",method:"get"});b("inviteNeglect",{url:"/aj/invite/handleinvite",method:"post"});b("checkNeglect",{url:"/aj/invite/shieldedlist",method:"post"});b("inviteLift",{url:"/aj/invite/lift",method:"post"});b("inviteAccept",{url:"/aj/invite/handleinvite",method:"post"});b("inviteCloseTips",{url:"/aj/invite/closetips",method:"post"});return a});STK.register("common.channel.relation",function(b){var a=["follow","unFollow","removeFans","block","unBlock","addFriends","removeFriends","updateRemark"];return b.common.listener.define("common.channel.relation",a)});STK.register("common.relation.followPrototype",function(j){var m={},a=j.common.trans.relation,p=j.common.channel.relation,n=j.kit.extra.merge,d=j.kit.extra.language;var o=j.common.dialog.validateCode();var f=function(r,s){j.ui.alert(r.msg)};var h=function(v,s){var u=j.kit.extra.merge({uid:"",f:0,extra:"",oid:$CONFIG.oid,wforce:s.wforce},s||{});if(v==="follow"){var r=a.getTrans(v,{onComplete:function(x,y){var w={onSuccess:function(A,C){var B=n(s,A.data);p.fire(v,B);var z=s.onSuccessCb;typeof z==="function"&&z(B)},onError:function(z,A){j.ui.confirm(d(z.msg),{OK:function(){r.request({type:u.type,uid:u.uid,wforce:0})}})},requestAjax:r,param:y,type:x.type,onRelease:function(){}};o.validateIntercept(x,y,w)}});r.request({type:u.type,uid:u.uid,wforce:u.wforce})}else{var t=a.getTrans(v,{onComplete:function(w,y){var x={onSuccess:function(A,C){var B=n(s,A.data);p.fire(v,B);var z=s.onSuccessCb;typeof z==="function"&&z(B)},onError:function(z,A){j.common.layer.ioError(z.code,z)},type:w.type,uid:w.uid};data=n(s,w.data);p.fire(v,data)}});t.request({type:u.type,uid:u.uid})}};var c=function(r){h("follow",r)};var q=function(r){h("unFollow",r)};var g=function(r){h("block",r)};var e=function(r){h("unBlock",r)};var b=function(r){h("removeFans",r)};m.follow=c;m.unFollow=q;m.block=g;m.unBlock=e;m.removeFans=b;return m});STK.register("common.trans.group",function(c){var a=c.kit.io.inter();var b=a.register;b("add",{url:"/ajax/user/addgroup",method:"post"});b("modify",{url:"/aj/relation/rename",method:"post"});b("del",{url:"/aj/relation/delete",method:"post"});b("info",{url:"/aj/f/group/getgroupinfo",method:"get"});b("set",{url:"/ajax/user/addUserToGroup",method:"post"});b("batchSet",{url:"/aj/user/addUserToGroup",method:"post"});b("list",{url:"/ajax/user/GroupList",method:"get"});b("order",{url:"/aj/f/group/order",method:"post"});b("listbygroup",{url:"/aj/f/attchoose",method:"post"});b("infolist",{url:"/aj/f/attfilterlist",method:"get"});b("recommendfollow",{url:"/aj3/recommend/aj_addrecommend.php",method:"post"});b("groupupdate",{url:"/aj/relation/groupupdate",method:"post"});b("editdesc",{url:"/aj/f/group/editdesc",method:"post"});b("update",{url:"/aj/f/group/update",method:"post"});b("followgroup",{url:"/aj/f/group/followgroup",method:"post"});b("getGroupDesc",{url:"/aj/f/group/getdesc",method:"get"});b("closebubble",{url:"/aj/bubble/closebubble",method:"get"});return a});STK.register("common.dialog.setGroup",function(b){var a=16;return function(){var s={},B=b.kit.extra.language,H=b.ui.dialog({isHold:true}),g=b.ui.alert,J={groupBox:'<div class="layer_setup_group" node-type="group_panel" ><input type="hidden" node-type="uid" name="touid"><div class="lsg_Tit form_table_single" node-type="remarkPanel">#L{}<input node-type="remarkInput" type="text" value="#L{}" class="W_input" name="remark"></div><div class="lsg_glist"><div class="lsg_gTit clearFix"><span class="left" node-type="message"></span><span class="right W_textb" action-type="tipsLayer"><span class="icon_askS"></span>#L{}</span><div class="layer_tips" node-type="groupTips" style="display: none;"><ul><li>#L{} </li><li>#L{}</li><li>#L{}</li></ul><span style="left:180px" class="arrow_up"></span></div></div><div class="lsg_glistBox clearfix"><div node-type="loading"><i class="W_loading S_loading"></i><span>#L{...}</span></div><ul class="clearfix" node-type="groupList"></ul><div node-type="addGroupPanel"><div class="lsg_addNew" node-type="showBtnBox"><a class="addnew" href="javascript:;" action-type="showBtn"><span class="ico_addinv"></span><span class="txt">#L{}</span></a></div><div class="lsg_creaNew form_table_single" node-type="addGroupBox" style="display:none;"><input node-type="groupInput" type="text" value="#L{}" class="W_input"><div style="display:none;" node-type="errorTips" class="M_notice_del"><span class="icon_del"></span></div><a href="javascript:;" class="S_btn_a" action-type="addGroup"><span>#L{}</span></a><a href="javascript:;" action-type="hideBtn">#L{}</a></div></div></div></div><div class="btn"><a href="javascript:;" class="S_btn_b" action-type="submit"><span>#L{}</span></a><a href="javascript:;" class="Sbtn_a" action-type="cancel"><span>#L{}</span></a></div></div>',checkBox:'<input type="checkbox" value="{value}" name="gid" class="W_checkbox" {checked} id="group_{groupId}"><label for="group_{groupId}">{name}</label>'},o={title:"#L{}",gEmpty:"#L{}",rEmpty:"#L{}",gMaxLen:"#L{16}",gDefVal:"#L{}",okLabel:"#L{}",rDefVal:"#L{}",message:"#L{}+#{nickName}+#L{}",repeat:"#L{}"},D=false,t=[],C,m,f,p,e,j,E,I;var M=function(){C.remarkInput.value=B(o.rDefVal);C.groupInput.value=B(o.gDefVal);C.loading.style.display="";C.groupList.innerHTML="";C.showBtnBox.style.display="";C.addGroupBox.style.display="none"};var L=function(O){M();var N=b.parseParam({uid:"",fnick:"",hasRemark:true,groupList:[],title:B(o.title),successCb:function(){},cancelCb:function(){}},O);E=N.successCb;I=N.cancelCb;C.uid.value=N.uid;if(N.hasRemark){C.remarkInput.removeAttribute("disabled");C.remarkPanel.style.display=""}else{C.remarkInput.setAttribute("disabled","disabled");C.remarkPanel.style.display="none"}N.groupList.length?A(N.groupList):q.request({uid:N.uid});C.message.innerHTML=B("#L{}"+N.fnick+"#L{}");H.setTitle(N.title);H.appendChild(C.group_panel);H.show().setMiddle()};var y=function(){H.hide()};var r={defVal:B(o.gDefVal),check:function(O){var N="";if(O===""||O===this.defVal){N=o.gEmpty}else{if(b.core.str.bLength(O)>16){N=o.gMaxLen}}return B(N)},checkRepeat:function(O){var N="";for(var P=t.length;P--;){if(O===t[P]["gname"]){N=o.repeat;break}}return B(N)},showError:function(N){C.errorTips.innerHTML='<span class="icon_del"></span>'+N;C.errorTips.style.display=""},hideError:function(){C.errorTips.style.display="none"}};var d={defVal:B(o.rDefVal),check:function(O){var N="";if(O===""){N=o.rEmpty}else{if(b.core.str.bLength(O)>16){N=o.gMaxLen}}return B(N)},showError:function(N){},hideError:function(){}};var G=function(P){var N=b.C("li");var O=J.checkBox.replace(/\{value\}/g,P.gid).replace(/\{groupId\}/g,P.gid).replace(/\{name\}/g,P.gname).replace(/\{checked\}/g,P.belong?"checked":"");N.innerHTML=O;return N};var A=function(R){t=R;C.addGroupPanel.style.display=(R.length>=20)?"none":"";var P=document.createDocumentFragment();for(var Q=0,O=R.length;Q<O;Q++){var N=G(R[Q]);P.appendChild(N)}C.groupList.appendChild(P);C.loading.style.display="none"};var z={errorCd:function(N,O){b.ui.alert("")},getGroupSuccess:function(N,P){var O=N.data||[];A(O)},setGroupSuccess:function(N,O){y();g(B(o.okLabel),{icon:"success",timeout:1000});E(N,O)},setGroupError:function(N,O){r.showError(N.msg)},addGroupSuccess:function(O,S){var Q=O.data,R;C.addGroupPanel.style.display=(Q.length>=20)?"none":"";for(var P=Q.length;P--;){if(Q[P].belong===1){R=Q[P];break}}R&&t.push(R);var N=G(R);C.groupList.appendChild(N);c.hideAddPanel();C.groupInput.value=B(o.gDefVal)}};var q=b.common.trans.group.getTrans("list",{onSuccess:z.getGroupSuccess,onError:z.errorCd});var x=b.common.trans.group.getTrans("set",{onSuccess:z.setGroupSuccess,onError:z.errorCd});var w=b.common.trans.group.getTrans("batchSet",{onSuccess:z.setGroupSuccess,onError:z.errorCd});var h=b.common.trans.group.getTrans("add",{onSuccess:z.addGroupSuccess,onError:z.errorCd});var c={showAddPanel:function(){C.showBtnBox.style.display="none";C.addGroupBox.style.display="";C.groupInput.focus()},hideAddPanel:function(){C.showBtnBox.style.display="";C.addGroupBox.style.display="none";r.hideError();C.groupInput.value=r.defVal},addGroup:function(){var N=b.trim(C.groupInput.value),O=r.check(N)||r.checkRepeat(N);if(O){r.showError(O)}else{r.hideError();h.request({name:N})}},submit:function(){var P=b.trim(C.groupInput.value),Q=r.checkRepeat(P);if(Q){r.showError(Q);return}D=true;r.hideError();var O=b.htmlToJson(C.group_panel);var N=[];O.gid=N.concat(O.gid).join(",");r.check(P)||(O.newgroup=P);if(O.remark===B(o.rDefVal)){O.remark=""}x.request(O)},cancel:function(){D=false;y()},inputFocus:function(N){return function(O){var O=b.fixEvent(O),P=O.target,Q=P.value;N.hideError();(Q===N.defVal)&&(P.value="")}},inputBlur:function(N){return function(O){var O=b.fixEvent(O),P=O.target,Q=b.trim(P.value);Q||(P.value=N.defVal)}},inputMaxLen:function(O){var O=b.fixEvent(O),P=O.target,Q=P.value,N=b.core.str.bLength(Q);(N>16)&&(P.value=b.core.str.leftB(Q,a))},showGroupTips:function(){C.groupTips.style.display=""},hideGroupTips:function(){C.groupTips.style.display="none"}};var F=function(){n();u();v()};var u=function(){m=b.core.evt.delegatedEvent(C.group_panel);f=c.inputFocus(r);p=c.inputBlur(r);e=c.inputFocus(d);j=c.inputBlur(d);b.addEvent(C.remarkInput,"focus",e);b.addEvent(C.remarkInput,"blur",j);b.addEvent(C.groupInput,"focus",f);b.addEvent(C.groupInput,"blur",p);b.addEvent(C.remarkInput,"keyup",c.inputMaxLen);b.addEvent(C.groupInput,"keyup",c.inputMaxLen);m.add("showBtn","click",c.showAddPanel);m.add("hideBtn","click",c.hideAddPanel);m.add("addGroup","click",c.addGroup);m.add("submit","click",c.submit);m.add("cancel","click",c.cancel);m.add("tipsLayer","mouseover",c.showGroupTips);m.add("tipsLayer","mouseout",c.hideGroupTips)};var v=function(){b.custEvent.add(H,"hide",function(){D||I()})};var n=function(){var N=b.core.dom.builder(B(J.groupBox));C=b.kit.dom.parseDOM(N.list)};var K=function(){b.removeEvent(C.remarkInput,"focus",e);b.removeEvent(C.remarkInput,"blur",j);b.removeEvent(C.groupInput,"focus",f);b.removeEvent(C.groupInput,"blur",p);b.removeEvent(C.remarkInput,"keyup",c.inputMaxLen);b.removeEvent(C.groupInput,"keyup",c.inputMaxLen);f=null;p=null;e=null;j=null;m&&m.destroy()};F();s.show=L;s.hide=y;s.destroy=K;return s}});STK.register("comp.content.wbad",function(a){return function(){var b=a.sizzle("[ad-data]",document.body);if(b.length==0){return}var g=function(){window.WBAD={uid:$CONFIG.uid||scope.$uid};for(var j=0,h=b.length;j<h;j++){var m=b[j];var n=a.delegatedEvent(m);n.add("followBtn","click",function(o){a.preventDefault();var q=o.el,p=o.data;p.onSuccessCb=function(v){var u=a.sizzle("a",q.parentNode);for(var t=0,r=u.length;t<r;t++){var s=u[t];s.style.display=(s==q)?"none":""}a.common.dialog.setGroup().show({uid:v.uid,fnick:v.fnick,groupList:v.group,hasRemark:true})};a.common.relation.followPrototype.follow(p)});n.add("hover","mouseover",function(o){var p=o.el;var q=o.data.onOverCls;p.className=q});n.add("hover","mouseout",function(o){var p=o.el;var q=o.data.onOutCls;p.className=q})}};g();var c=false,e=document,d=e.createElement("script"),f=e.getElementsByTagName("script")[0];d.type="text/javascript";d.charset="utf-8";d.async=true;d.src=("https:"==e.location.protocol?"https://":"http://")+"js.t.sinajs.cn/t4/home/static/wbad.js?version="+$CONFIG.version;f.parentNode.insertBefore(d,f)}});STK.register("comp.content.asynSmartSort",function(a){return function(b,p){var h={},c=a.common.depand.asynUserCard,d;var j="asyn_smartSort";var o=c.bind(j,function(s,t,r){d||(d=a.common.layer.smartSortCard(s,p));d.showCard(s,t,r)});var f=c.bind(j,function(s,t,r){d||(d=a.common.layer.smartSortCard(s,p));d.hideCard(s,t,r)});var e={mouseover:function(r){var s=a.fixEvent(r),t=s.target,u=t.getAttribute("smartcard");if(!u){return}o(t,u,s)},mouseout:function(r){var s=a.fixEvent(r),t=s.target,u=t.getAttribute("smartcard");if(!u){return}f(t,u,s)}};var q=function(){m();g()};var m=function(){if(!a.core.dom.isNode(b)){throw"[STK.comp.content.seedUserCard]: node is not a Node!"}};var g=function(){a.addEvent(b,"mouseover",e.mouseover);a.addEvent(b,"mouseout",e.mouseout)};var n=function(){a.removeEvent(b,"mouseover",e.mouseover);a.removeEvent(b,"mouseout",e.mouseout)};q();h.destroy=n;h.smartCard=d;return h}});STK.register("comp.content.asynFollowingListCard",function(a){return function(b,p){var h={},c=a.common.depand.asynUserCard,d;var j="asyn_followingListCard";var o=c.bind(j,function(s,t,r){d||(d=a.common.layer.followingListCard(s,p));d.showCard(s,t,r)});var f=c.bind(j,function(s,t,r){d||(d=a.common.layer.followingListCard(s,p));d.hideCard(s,t,r)});var e={mouseover:function(r){var s=a.fixEvent(r),u=s.target,t=u.getAttribute("action-type"),v=u.getAttribute("action-data");if(!t||t!="followingList"){return}o(u,v,s)},mouseout:function(r){var s=a.fixEvent(r),u=s.target,t=u.getAttribute("action-type"),v=u.getAttribute("action-data");if(!t||t!="followingList"){return}f(u,v,s)}};var q=function(){m();g()};var m=function(){if(!a.core.dom.isNode(b)){throw"[STK.comp.content.seedUserCard]: node is not a Node!"}};var g=function(){a.addEvent(b,"mouseover",e.mouseover);a.addEvent(b,"mouseout",e.mouseout)};var n=function(){a.removeEvent(b,"mouseover",e.mouseover);a.removeEvent(b,"mouseout",e.mouseout)};q();h.destroy=n;h.followingListCard=d;return h}});STK.register("common.search.action",function(b){var a={eventList:[]};return function(h,g){h=h||document.body;g=b.parseParam(a,g);g.eventList=[].concat(g.eventList);var e=b.core.evt.delegatedEvent(h);var j;for(var d=0,c=g.eventList.length;d<c;d++){j=g.eventList[d];if(j.name){j.eventType=j.eventType||"click";j.action=j.action||b.core.func.empty;e.add(j.name,j.eventType,j.action)}}var f={add:function(m,n,o){e.add(m,n,o);g.eventList.push({name:m,eventType:n,action:o});return f},remove:function(n,p,q){for(var o=0,m=g.eventList.length;o<m;o++){j=g.eventList[o];if(j.name==n&&j.eventType==p&&j.action==q){e.remove(j.name,j.eventType,j.action);delete g.eventList[o]}}g.eventList=b.core.arr.clear(g.eventList);return f},destroy:function(){for(var n=0,m=g.eventList.length;n<m;n++){j=g.eventList[n];f.remove(j.name,j.eventType,j.action)}e.destroy()}};return f}});STK.register("kit.extra.storageObject",function(b){var a=function(c){return typeof(c)=="object"&&Object.prototype.toString.call(c).toLowerCase()=="[object object]"&&!c.length};return{get:function(e){var f=b.core.util.storage.get(e);var c=[];if(!f||f=="null"){return null}if((c=f.match(/^array\[(.*?)\]$/))){f=c[1].split(",");var d=[];b.core.arr.foreach(f,function(g,h){d.push(decodeURIComponent(g))});f=d}else{if((c=f.match(/^json\[(.*?)\]$/))){f=b.strToJson(c[1])}}return f},set:function(c,d,f){if(b.isArray(d)){var e=[];b.core.arr.foreach(d,function(g,h){e.push(encodeURIComponent(g))});d="array["+e.join(",")+"]"}else{if(a(d)){d="json["+b.core.json.jsonToStr(d)+"]"}}b.core.util.storage.set(c,d,f)},del:function(c){b.core.util.storage.del(c)}}});STK.register("ui.tipsBubble",function(b){var a='<div node-type="outer" class="layer_tips" style="position:absolute"><div class=""><a href="javascript:;" node-type="closeBtn" class="W_close_color"></a><div class="layer_tips_cont" node-type="inner"></div><span node-type="arrow" class="arrow_up"></span></div></div>';return function(c){var g,f,j,m,h,p,q;var o=function(s){f.style.top=s.t+"px";f.style.left=s.l+"px";return h};var n=function(){var s=b.core.util.winSize();var t=g.getSize(true);f.style.top=b.core.util.scrollPos()["top"]+(s.height-t.h)/2+"px";f.style.left=(s.width-t.w)/2+"px";return h};var d=function(s,u,t){if(typeof s==="string"){j.innerHTML=s}else{j.appendChild(s)}m.style.display=u?"":"none";t&&m.setAttribute("suda-data",t);return h};var e=function(s){if(p){p.className=s.className||"";p.style.cssText=s.style||""}return h};var r=function(){g=b.module.layer(a);f=g.getOuter();j=g.getDom("inner");p=g.getDom("arrow");m=g.getDom("closeBtn");h=g;c&&d(c);document.body.appendChild(f)};r();h.setPosition=o;h.setMiddle=n;h.setContent=d;h.setArrow=e;return h}});STK.register("comp.common.action",function(a){var b="tipStorage"+$CONFIG.uid;return function(h){var g={},d;var j={share:function(o){var n=o.el.getAttribute("param");if(n){if(d){return}d=true;n=a.queryToJson(n);a.common.trans.global.getTrans("share",{onSuccess:function(p){a.common.dialog.publish().show(p.data);d=false},onError:function(p){a.ui.alert(p.msg);d=false},onFail:function(){a.ui.alert("");d=false}}).request(n)}else{a.common.dialog.publish().show(o.data)}},close:function(o){var n=a.kit.dom.parents(o.el,{expr:"[tipcontainer]"});if(n&&n.length>0){n[0].style.display="none";if(n[0].getAttribute("tipcontainer")){var p=a.kit.extra.storageObject.get(b)||{};p[n[0].getAttribute("tipcontainer")]=1;a.kit.extra.storageObject.set(b,p)}}}};var f=a.common.search.action(document.body,{eventList:[{name:"baseShare",action:j.share},{name:"baseClose",action:j.close}]});var c=function(){var r=a.kit.extra.storageObject.get(b)||{};var q=a.sizzle("[tipcontainer]");for(var o=0,n=q.length;o<n;o++){var p=q[o].getAttribute("tipcontainer");if(r[p]==1){q[o].style.display="none"}else{q[o].style.display=""}}};var m=function(){c()}();var e=function(){f.destroy()};g.destroy=e;return g}});STK.register("comp.content.base",function(b){var a=false;return function(){var m={};var d=b.E("base_scrollToTop"),t=b.sizzle("div[ucardconf]"),v=b.sizzle("div[smartconf]"),e=[],f=[],h=[],o=b.kit.extra.require,u,r,s,g,q,p,n,x,j;if(b.pageletView&&b.pageletView.onload){b.pageletView.onload(function(){o.activeLoad()})}else{x=function(){o.activeLoad()};b.addEvent(window,"load",x)}var c=function(){j=b.comp.common.action();u=b.comp.content.scrollToTop(d);for(var A=t.length;A--;){s=t[A];r=s.getAttribute("ucardconf");r=b.queryToJson(r);e.push(b.comp.content.asynUserCard(s,{order:r.order,type:r.type,arrowPos:r.arrowPos}))}for(var y=v.length;y--;){q=v[y];g=q.getAttribute("smartconf");g=b.queryToJson(g);f.push(b.comp.content.asynSmartSort(q,{order:g.order,type:g.type,arrowPos:g.arrowPos}));h.push(b.comp.content.asynFollowingListCard(q,{order:g.order,type:g.type,arrowPos:g.arrowPos}))}var z=function(){!a&&b.comp.content.suda();!a&&b.comp.content.webim();a=true;b.comp.content.wbad()};if(b.pageletView){if(!a){if(b.pageletView.originalPagePlRendReady()){z()}b.custEvent.add(b.pageletView,"allPlRendReady",function(){z()})}}else{z()}};var w=function(){window.WBAD&&window.WBAD.destroy();for(var z=e.length;z--;){p=e[z];typeof p.destroy==="function"&&p.destroy()}for(var y=f.length;y--;){n=f[y];typeof n.destroy==="function"&&n.destroy();followingListCard=h[y];typeof followingListCard.destroy==="function"&&h.destroy()}x&&b.removeEvent(window,"load",x);u.destroy()};c();m.destroy=w;return m}});STK.pageletM.register("pl.common.base",function(b){var a=b.comp.content.base();return a});STK.register("comp.index.content",function(a){return function(f){var e,g=a.core.dom.builder(f).list;var d=function(){};var c={change:function(j){var m=j.data,n=j.el;a.common.trans.index.getTrans("change",{onSuccess:function(p){var o;if(p.code!="100000"){return false}o=p.data.html;if(o.length!=0){n.setAttribute("action-data",p.data["action-data"]);g.change_content[0].innerHTML=o}},onError:function(o){alert("Data error.")},onFail:function(){alert("Data fail.")}}).request(m)},in_recommend_click:function(n){var m=n.evt;var j=m.target||m.srcElement;if(/(DIV)/gi.test(j.nodeName)){if(n.data&&n.data.url){window.location=decodeURIComponent(n.data.url)}}}};var b=function(){e=a.core.evt.delegatedEvent(f);e.add("in_recommend","click",c.in_recommend_click);e.add("change","click",c.change)};var h=function(){d();b()};h()}});STK.pageletM.register("pl.index.content",function(b){var a=b.E("pl_index_content");if(a){return b.comp.index.content(a)}});STK.pageletM.start();